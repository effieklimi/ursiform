"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/ask";
exports.ids = ["pages/api/ask"];
exports.modules = {

/***/ "@google/generative-ai":
/*!****************************************!*\
  !*** external "@google/generative-ai" ***!
  \****************************************/
/***/ ((module) => {

module.exports = import("@google/generative-ai");;

/***/ }),

/***/ "@qdrant/js-client-rest":
/*!*****************************************!*\
  !*** external "@qdrant/js-client-rest" ***!
  \*****************************************/
/***/ ((module) => {

module.exports = import("@qdrant/js-client-rest");;

/***/ }),

/***/ "openai":
/*!*************************!*\
  !*** external "openai" ***!
  \*************************/
/***/ ((module) => {

module.exports = import("openai");;

/***/ }),

/***/ "(api)/./lib/qdrant/db.ts":
/*!**************************!*\
  !*** ./lib/qdrant/db.ts ***!
  \**************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"client\": () => (/* binding */ client),\n/* harmony export */   \"createCollection\": () => (/* binding */ createCollection),\n/* harmony export */   \"testConnection\": () => (/* binding */ testConnection)\n/* harmony export */ });\n/* harmony import */ var _qdrant_js_client_rest__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @qdrant/js-client-rest */ \"@qdrant/js-client-rest\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_qdrant_js_client_rest__WEBPACK_IMPORTED_MODULE_0__]);\n_qdrant_js_client_rest__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n// Initialize client with support for both local and cloud instances\nconst qdrantUrl = \"https://1555b3af-2ea7-409c-83a3-3a49207ac217.us-east4-0.gcp.cloud.qdrant.io:6333\" || 0;\nconst qdrantApiKey = process.env.QDRANT_API_KEY;\nlet clientConfig;\n// For cloud instances, use the recommended format from documentation\nif (qdrantApiKey) {\n    // Parse the URL to extract host\n    const url = new URL(qdrantUrl);\n    const host = url.hostname;\n    const isHttps = url.protocol === \"https:\";\n    clientConfig = {\n        host: host,\n        port: null,\n        https: isHttps,\n        apiKey: qdrantApiKey\n    };\n    console.log(`Connecting to Qdrant Cloud at ${host} (HTTPS: ${isHttps})`);\n} else {\n    // For local instances without API key\n    clientConfig = {\n        url: qdrantUrl\n    };\n    console.log(`Connecting to local Qdrant at ${qdrantUrl}`);\n}\nconst client = new _qdrant_js_client_rest__WEBPACK_IMPORTED_MODULE_0__.QdrantClient(clientConfig);\n\n// Test Qdrant connection\nasync function testConnection() {\n    try {\n        // Use getCollections as a simple health check\n        await client.getCollections();\n        console.log(\"Qdrant connection successful\");\n        return true;\n    } catch (error) {\n        console.error(\"Qdrant connection failed:\", error);\n        return false;\n    }\n}\nasync function createCollection(name = \"my_collection\", dimension = 768) {\n    try {\n        // First test the connection\n        const isConnected = await testConnection();\n        if (!isConnected) {\n            throw new Error(\"Cannot connect to Qdrant database. Please check your configuration.\");\n        }\n        // Check if collection already exists\n        try {\n            await client.getCollection(name);\n            console.log(`Collection \"${name}\" already exists`);\n            return;\n        } catch (error) {\n            // Collection doesn't exist, create it\n            console.log(`Collection \"${name}\" does not exist, creating...`);\n            // Check if it's a different error than \"not found\"\n            if (error.status && error.status !== 404) {\n                console.error(\"Unexpected error checking collection:\", error);\n                throw error;\n            }\n        }\n        await client.createCollection(name, {\n            vectors: {\n                size: dimension,\n                distance: \"Cosine\"\n            }\n        });\n        console.log(`Collection \"${name}\" created successfully with dimension ${dimension}`);\n    } catch (error1) {\n        console.error(`Error creating collection \"${name}\":`, error1);\n        // Provide more specific error messages\n        if (error1.message?.includes(\"authentication\") || error1.status === 401 || error1.status === 403) {\n            throw new Error(\"Authentication failed. Please check your QDRANT_API_KEY and QDRANT_URL.\");\n        } else if (error1.message?.includes(\"connection\") || error1.code === \"ECONNREFUSED\") {\n            throw new Error(\"Cannot connect to Qdrant. Please check your QDRANT_URL.\");\n        } else {\n            throw error1;\n        }\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q2xDTSxPQUFPLEVBQUU7Z0JBQ1BDLElBQUksRUFBRU4sU0FBUztnQkFDZk8sUUFBUSxFQUFFLFFBQVE7YUFDbkI7U0FDRixDQUFDLENBQUM7UUFFSGYsT0FBTyxDQUFDQyxHQUFHLENBQ1QsQ0FBQyxZQUFZLEVBQUVNLElBQUksQ0FBQyxzQ0FBc0MsRUFBRUMsU0FBUyxDQUFDLENBQUMsQ0FDeEUsQ0FBQztJQUNKLEVBQUUsT0FBT0gsTUFBSyxFQUFPO1FBQ25CTCxPQUFPLENBQUNLLEtBQUssQ0FBQyxDQUFDLDJCQUEyQixFQUFFRSxJQUFJLENBQUMsRUFBRSxDQUFDLEVBQUVGLE1BQUssQ0FBQyxDQUFDO1FBRTdELHVDQUF1QztRQUN2QyxJQUNFQSxNQUFLLENBQUNXLE9BQU8sRUFBRUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLElBQ3pDWixNQUFLLENBQUNPLE1BQU0sS0FBSyxHQUFHLElBQ3BCUCxNQUFLLENBQUNPLE1BQU0sS0FBSyxHQUFHLEVBQ3BCO1lBQ0EsTUFBTSxJQUFJRixLQUFLLENBQ2IseUVBQXlFLENBQzFFLENBQUM7UUFDSixPQUFPLElBQ0xMLE1BQUssQ0FBQ1csT0FBTyxFQUFFQyxRQUFRLENBQUMsWUFBWSxDQUFDLElBQ3JDWixNQUFLLENBQUNhLElBQUksS0FBSyxjQUFjLEVBQzdCO1lBQ0EsTUFBTSxJQUFJUixLQUFLLENBQ2IseURBQXlELENBQzFELENBQUM7UUFDSixPQUFPO1lBQ0wsTUFBTUwsTUFBSyxDQUFDO1FBQ2QsQ0FBQztJQUNILENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veWVhcm4vLi9saWIvcWRyYW50L2RiLnRzPzM5NjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUWRyYW50Q2xpZW50IH0gZnJvbSBcIkBxZHJhbnQvanMtY2xpZW50LXJlc3RcIjtcblxuLy8gSW5pdGlhbGl6ZSBjbGllbnQgd2l0aCBzdXBwb3J0IGZvciBib3RoIGxvY2FsIGFuZCBjbG91ZCBpbnN0YW5jZXNcbmNvbnN0IHFkcmFudFVybCA9IHByb2Nlc3MuZW52LlFEUkFOVF9VUkwgfHwgXCJodHRwOi8vbG9jYWxob3N0OjYzMzNcIjtcbmNvbnN0IHFkcmFudEFwaUtleSA9IHByb2Nlc3MuZW52LlFEUkFOVF9BUElfS0VZO1xuXG5sZXQgY2xpZW50Q29uZmlnOiBhbnk7XG5cbi8vIEZvciBjbG91ZCBpbnN0YW5jZXMsIHVzZSB0aGUgcmVjb21tZW5kZWQgZm9ybWF0IGZyb20gZG9jdW1lbnRhdGlvblxuaWYgKHFkcmFudEFwaUtleSkge1xuICAvLyBQYXJzZSB0aGUgVVJMIHRvIGV4dHJhY3QgaG9zdFxuICBjb25zdCB1cmwgPSBuZXcgVVJMKHFkcmFudFVybCk7XG4gIGNvbnN0IGhvc3QgPSB1cmwuaG9zdG5hbWU7XG4gIGNvbnN0IGlzSHR0cHMgPSB1cmwucHJvdG9jb2wgPT09IFwiaHR0cHM6XCI7XG5cbiAgY2xpZW50Q29uZmlnID0ge1xuICAgIGhvc3Q6IGhvc3QsXG4gICAgcG9ydDogbnVsbCwgLy8gVGhpcyBpcyBjcml0aWNhbCBmb3IgY2xvdWQgaW5zdGFuY2VzIC0gcHJldmVudHMgOjYzMzMgYmVpbmcgYXBwZW5kZWRcbiAgICBodHRwczogaXNIdHRwcyxcbiAgICBhcGlLZXk6IHFkcmFudEFwaUtleSxcbiAgfTtcblxuICBjb25zb2xlLmxvZyhgQ29ubmVjdGluZyB0byBRZHJhbnQgQ2xvdWQgYXQgJHtob3N0fSAoSFRUUFM6ICR7aXNIdHRwc30pYCk7XG59IGVsc2Uge1xuICAvLyBGb3IgbG9jYWwgaW5zdGFuY2VzIHdpdGhvdXQgQVBJIGtleVxuICBjbGllbnRDb25maWcgPSB7XG4gICAgdXJsOiBxZHJhbnRVcmwsXG4gIH07XG5cbiAgY29uc29sZS5sb2coYENvbm5lY3RpbmcgdG8gbG9jYWwgUWRyYW50IGF0ICR7cWRyYW50VXJsfWApO1xufVxuXG5jb25zdCBjbGllbnQgPSBuZXcgUWRyYW50Q2xpZW50KGNsaWVudENvbmZpZyk7XG5cbmV4cG9ydCB7IGNsaWVudCB9O1xuXG4vLyBUZXN0IFFkcmFudCBjb25uZWN0aW9uXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGVzdENvbm5lY3Rpb24oKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIHRyeSB7XG4gICAgLy8gVXNlIGdldENvbGxlY3Rpb25zIGFzIGEgc2ltcGxlIGhlYWx0aCBjaGVja1xuICAgIGF3YWl0IGNsaWVudC5nZXRDb2xsZWN0aW9ucygpO1xuICAgIGNvbnNvbGUubG9nKFwiUWRyYW50IGNvbm5lY3Rpb24gc3VjY2Vzc2Z1bFwiKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiUWRyYW50IGNvbm5lY3Rpb24gZmFpbGVkOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVDb2xsZWN0aW9uKFxuICBuYW1lOiBzdHJpbmcgPSBcIm15X2NvbGxlY3Rpb25cIixcbiAgZGltZW5zaW9uOiBudW1iZXIgPSA3Njhcbik6IFByb21pc2U8dm9pZD4ge1xuICB0cnkge1xuICAgIC8vIEZpcnN0IHRlc3QgdGhlIGNvbm5lY3Rpb25cbiAgICBjb25zdCBpc0Nvbm5lY3RlZCA9IGF3YWl0IHRlc3RDb25uZWN0aW9uKCk7XG4gICAgaWYgKCFpc0Nvbm5lY3RlZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBcIkNhbm5vdCBjb25uZWN0IHRvIFFkcmFudCBkYXRhYmFzZS4gUGxlYXNlIGNoZWNrIHlvdXIgY29uZmlndXJhdGlvbi5cIlxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiBjb2xsZWN0aW9uIGFscmVhZHkgZXhpc3RzXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGNsaWVudC5nZXRDb2xsZWN0aW9uKG5hbWUpO1xuICAgICAgY29uc29sZS5sb2coYENvbGxlY3Rpb24gXCIke25hbWV9XCIgYWxyZWFkeSBleGlzdHNgKTtcbiAgICAgIHJldHVybjtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAvLyBDb2xsZWN0aW9uIGRvZXNuJ3QgZXhpc3QsIGNyZWF0ZSBpdFxuICAgICAgY29uc29sZS5sb2coYENvbGxlY3Rpb24gXCIke25hbWV9XCIgZG9lcyBub3QgZXhpc3QsIGNyZWF0aW5nLi4uYCk7XG5cbiAgICAgIC8vIENoZWNrIGlmIGl0J3MgYSBkaWZmZXJlbnQgZXJyb3IgdGhhbiBcIm5vdCBmb3VuZFwiXG4gICAgICBpZiAoZXJyb3Iuc3RhdHVzICYmIGVycm9yLnN0YXR1cyAhPT0gNDA0KSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJVbmV4cGVjdGVkIGVycm9yIGNoZWNraW5nIGNvbGxlY3Rpb246XCIsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgfVxuXG4gICAgYXdhaXQgY2xpZW50LmNyZWF0ZUNvbGxlY3Rpb24obmFtZSwge1xuICAgICAgdmVjdG9yczoge1xuICAgICAgICBzaXplOiBkaW1lbnNpb24sXG4gICAgICAgIGRpc3RhbmNlOiBcIkNvc2luZVwiLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKFxuICAgICAgYENvbGxlY3Rpb24gXCIke25hbWV9XCIgY3JlYXRlZCBzdWNjZXNzZnVsbHkgd2l0aCBkaW1lbnNpb24gJHtkaW1lbnNpb259YFxuICAgICk7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciBjcmVhdGluZyBjb2xsZWN0aW9uIFwiJHtuYW1lfVwiOmAsIGVycm9yKTtcblxuICAgIC8vIFByb3ZpZGUgbW9yZSBzcGVjaWZpYyBlcnJvciBtZXNzYWdlc1xuICAgIGlmIChcbiAgICAgIGVycm9yLm1lc3NhZ2U/LmluY2x1ZGVzKFwiYXV0aGVudGljYXRpb25cIikgfHxcbiAgICAgIGVycm9yLnN0YXR1cyA9PT0gNDAxIHx8XG4gICAgICBlcnJvci5zdGF0dXMgPT09IDQwM1xuICAgICkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBcIkF1dGhlbnRpY2F0aW9uIGZhaWxlZC4gUGxlYXNlIGNoZWNrIHlvdXIgUURSQU5UX0FQSV9LRVkgYW5kIFFEUkFOVF9VUkwuXCJcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmIChcbiAgICAgIGVycm9yLm1lc3NhZ2U/LmluY2x1ZGVzKFwiY29ubmVjdGlvblwiKSB8fFxuICAgICAgZXJyb3IuY29kZSA9PT0gXCJFQ09OTlJFRlVTRURcIlxuICAgICkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBcIkNhbm5vdCBjb25uZWN0IHRvIFFkcmFudC4gUGxlYXNlIGNoZWNrIHlvdXIgUURSQU5UX1VSTC5cIlxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG59XG4iXSwibmFtZXMiOlsiUWRyYW50Q2xpZW50IiwicWRyYW50VXJsIiwicHJvY2VzcyIsImVudiIsIlFEUkFOVF9VUkwiLCJxZHJhbnRBcGlLZXkiLCJRRFJBTlRfQVBJX0tFWSIsImNsaWVudENvbmZpZyIsInVybCIsIlVSTCIsImhvc3QiLCJob3N0bmFtZSIsImlzSHR0cHMiLCJwcm90b2NvbCIsInBvcnQiLCJodHRwcyIsImFwaUtleSIsImNvbnNvbGUiLCJsb2ciLCJjbGllbnQiLCJ0ZXN0Q29ubmVjdGlvbiIsImdldENvbGxlY3Rpb25zIiwiZXJyb3IiLCJjcmVhdGVDb2xsZWN0aW9uIiwibmFtZSIsImRpbWVuc2lvbiIsImlzQ29ubmVjdGVkIiwiRXJyb3IiLCJnZXRDb2xsZWN0aW9uIiwic3RhdHVzIiwidmVjdG9ycyIsInNpemUiLCJkaXN0YW5jZSIsIm1lc3NhZ2UiLCJpbmNsdWRlcyIsImNvZGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./lib/qdrant/db.ts\n");

/***/ }),

/***/ "(api)/./lib/qdrant/nlp-query.ts":
/*!*********************************!*\
  !*** ./lib/qdrant/nlp-query.ts ***!
  \*********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"processNaturalQuery\": () => (/* binding */ processNaturalQuery)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! openai */ \"openai\");\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @google/generative-ai */ \"@google/generative-ai\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./db */ \"(api)/./lib/qdrant/db.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([openai__WEBPACK_IMPORTED_MODULE_0__, _google_generative_ai__WEBPACK_IMPORTED_MODULE_1__, _db__WEBPACK_IMPORTED_MODULE_2__]);\n([openai__WEBPACK_IMPORTED_MODULE_0__, _google_generative_ai__WEBPACK_IMPORTED_MODULE_1__, _db__WEBPACK_IMPORTED_MODULE_2__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\nconst genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_1__.GoogleGenerativeAI(process.env.GEMINI_API_KEY || \"\");\nasync function processNaturalQuery(collection, question, provider = \"openai\", model, context // Add conversation context\n) {\n    const startTime = Date.now();\n    try {\n        // Step 1: Resolve context and enrich the question\n        const { enrichedQuestion , resolvedCollection , updatedContext  } = await resolveContext(question, collection, context);\n        // Step 2: Parse intent with context awareness\n        const intent = await parseQueryIntent(enrichedQuestion, provider, model, updatedContext);\n        // Step 3: Use resolved collection or extracted collection\n        const finalCollection = resolvedCollection || intent.extractedCollection || null;\n        // Step 4: Execute the appropriate operation\n        const result = await executeQuery(finalCollection, intent);\n        // Step 5: Generate natural language response\n        const answer = await generateResponse(enrichedQuestion, intent, result, provider, model);\n        // Step 6: Update conversation context\n        const finalContext = updateConversationContext(updatedContext, question, intent, result, finalCollection);\n        const execution_time_ms = Date.now() - startTime;\n        return {\n            answer,\n            query_type: intent.type,\n            data: result,\n            execution_time_ms,\n            context: finalContext\n        };\n    } catch (error) {\n        console.error(\"Error processing natural query:\", error);\n        // Create fallback response\n        const fallbackAnswer = \"I encountered an issue processing your query, but I'm using pattern matching to help. \" + generateFallbackResponse(question, inferIntentFromQuestion(question, context), {\n            count: 0\n        });\n        return {\n            answer: fallbackAnswer,\n            query_type: \"fallback\",\n            data: null,\n            execution_time_ms: Date.now() - startTime,\n            context: context || {\n                conversationHistory: []\n            }\n        };\n    }\n}\nasync function resolveContext(question, collection, context) {\n    // Initialize context if not provided\n    const currentContext = context || {\n        conversationHistory: []\n    };\n    let enrichedQuestion = question;\n    let resolvedCollection = collection;\n    console.log(\"\\uD83E\\uDDE0 CONTEXT RESOLUTION:\");\n    console.log(\"Original question:\", question);\n    console.log(\"Current context:\", JSON.stringify(currentContext, null, 2));\n    // Detect contextual references\n    const lowercaseQuestion = question.toLowerCase();\n    // Handle pronoun references to entities\n    if ((lowercaseQuestion.includes(\"their\") || lowercaseQuestion.includes(\"his\") || lowercaseQuestion.includes(\"her\") || lowercaseQuestion.includes(\"its\")) && currentContext.lastEntity) {\n        console.log(\"\\uD83D\\uDD04 Resolving possessive pronoun to:\", currentContext.lastEntity);\n        enrichedQuestion = enrichedQuestion.replace(/\\b(their|his|her|its)\\b/gi, currentContext.lastEntity + \"'s\");\n    }\n    // Handle \"he\" and \"him\" references\n    if ((lowercaseQuestion.includes(\"he \") || lowercaseQuestion.includes(\"him \") || lowercaseQuestion.includes(\" he\") || lowercaseQuestion.includes(\" him\")) && currentContext.lastEntity) {\n        console.log(\"\\uD83D\\uDD04 Resolving 'he/him' to:\", currentContext.lastEntity);\n        enrichedQuestion = enrichedQuestion.replace(/\\b(he|him)\\b/gi, currentContext.lastEntity);\n    }\n    // Handle \"also\" references\n    if (lowercaseQuestion.includes(\"also\") && currentContext.lastEntity) {\n        if (!enrichedQuestion.includes(currentContext.lastEntity)) {\n            console.log(\"\\uD83D\\uDD04 Resolving 'also' reference to:\", currentContext.lastEntity);\n            enrichedQuestion = enrichedQuestion.replace(/also/i, `also for ${currentContext.lastEntity}`);\n        }\n    }\n    // Handle \"them\" references\n    if (lowercaseQuestion.includes(\"them\") && currentContext.lastEntity) {\n        console.log(\"\\uD83D\\uDD04 Resolving 'them' to:\", currentContext.lastEntity);\n        enrichedQuestion = enrichedQuestion.replace(/\\bthem\\b/gi, currentContext.lastEntity);\n    }\n    // Handle \"they\" references\n    if (lowercaseQuestion.includes(\"they\") && currentContext.lastEntity) {\n        console.log(\"\\uD83D\\uDD04 Resolving 'they' to:\", currentContext.lastEntity);\n        enrichedQuestion = enrichedQuestion.replace(/\\bthey\\b/gi, currentContext.lastEntity);\n    }\n    // Handle \"it\" references to collections\n    if (lowercaseQuestion.includes(\"it\") && currentContext.lastCollection) {\n        console.log(\"\\uD83D\\uDD04 Resolving 'it' to collection:\", currentContext.lastCollection);\n        enrichedQuestion = enrichedQuestion.replace(/\\bit\\b/gi, currentContext.lastCollection);\n    }\n    // Handle continuation phrases\n    if ((lowercaseQuestion.includes(\"what about\") || lowercaseQuestion.includes(\"how about\") || lowercaseQuestion.includes(\"and\")) && currentContext.lastQueryType && currentContext.lastTarget) {\n        // If question is like \"what about John Doe?\", expand to full context\n        const entityMatch = question.match(/(?:what about|how about|and)\\s+([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*)/i);\n        if (entityMatch) {\n            const newEntity = entityMatch[1];\n            const lastQueryType = currentContext.lastQueryType;\n            console.log(\"\\uD83D\\uDD04 Resolving continuation to:\", `${lastQueryType} ${currentContext.lastTarget} by ${newEntity}`);\n            enrichedQuestion = `${lastQueryType} ${currentContext.lastTarget} by ${newEntity}`;\n        }\n    }\n    // Resolve collection context\n    if (!resolvedCollection && currentContext.lastCollection) {\n        // If no collection specified but we have context, check if query seems collection-specific\n        if (lowercaseQuestion.includes(\"this collection\") || lowercaseQuestion.includes(\"same collection\") || !lowercaseQuestion.includes(\"all collections\") && !lowercaseQuestion.includes(\"database\")) {\n            console.log(\"\\uD83D\\uDD04 Resolving collection context to:\", currentContext.lastCollection);\n            resolvedCollection = currentContext.lastCollection;\n        }\n    }\n    console.log(\"✅ Enriched question:\", enrichedQuestion);\n    console.log(\"✅ Resolved collection:\", resolvedCollection);\n    return {\n        enrichedQuestion,\n        resolvedCollection,\n        updatedContext: currentContext\n    };\n}\nfunction updateConversationContext(context, question, intent, result, collection) {\n    console.log(\"\\uD83D\\uDCBE UPDATING CONVERSATION CONTEXT:\");\n    console.log(\"Previous context:\", JSON.stringify(context, null, 2));\n    console.log(\"Intent:\", JSON.stringify(intent, null, 2));\n    console.log(\"Collection:\", collection);\n    // Create new conversation turn\n    const turn = {\n        id: Date.now().toString(),\n        question,\n        intent: {\n            type: intent.type,\n            target: intent.target,\n            filter: intent.filter,\n            scope: intent.scope,\n            extractedCollection: intent.extractedCollection\n        },\n        result,\n        timestamp: new Date()\n    };\n    // Update context\n    const updatedContext = {\n        ...context,\n        conversationHistory: [\n            ...context.conversationHistory,\n            turn\n        ].slice(-10)\n    };\n    // Update last entity if filter contains a name\n    if (intent.filter?.name) {\n        updatedContext.lastEntity = intent.filter.name;\n        console.log(\"\\uD83D\\uDCDD Updated lastEntity to:\", intent.filter.name);\n    }\n    // Update last collection\n    if (collection) {\n        updatedContext.lastCollection = collection;\n        console.log(\"\\uD83D\\uDCDD Updated lastCollection to:\", collection);\n    }\n    // Update last query type and target\n    updatedContext.lastQueryType = intent.type;\n    updatedContext.lastTarget = intent.target;\n    console.log(\"\\uD83D\\uDCDD Updated lastQueryType to:\", intent.type);\n    console.log(\"\\uD83D\\uDCDD Updated lastTarget to:\", intent.target);\n    // Update current topic based on query content\n    if (intent.filter?.name) {\n        updatedContext.currentTopic = `${intent.filter.name} ${intent.target}`;\n        console.log(\"\\uD83D\\uDCDD Updated currentTopic to:\", updatedContext.currentTopic);\n    }\n    console.log(\"✅ Final updated context:\", JSON.stringify(updatedContext, null, 2));\n    return updatedContext;\n}\nasync function parseQueryIntent(question, provider, model, context) {\n    // First try simple pattern matching as fallback\n    const fallbackIntent = inferIntentFromQuestion(question, context);\n    // Build context-aware system prompt\n    let systemPrompt = `You are a query intent parser for a vector database system. Parse the user's question to determine:\n1. Query type (count, search, list, filter, describe, summarize, analyze, collections, database)\n2. What to target (items, entities, collections, etc.)\n3. Any filters to apply (especially entity names)\n4. Query scope (collection-specific or database-wide)\n5. Collection name if mentioned\n\nAvailable scopes:\n- \"collection\": query operates on a specific collection\n- \"database\": query operates on the entire database\n\nIMPORTANT: Extract entity names from natural language variations:\n- \"by [Name]\", \"from [Name]\", \"of [Name]\"\n- \"done by [Name]\", \"created by [Name]\", \"made by [Name]\"\n- \"pieces by [Name]\", \"work by [Name]\", \"items by [Name]\"\n- \"[Name] items\", \"[Name] work\", \"[Name] pieces\"\n- Look for proper nouns (capitalized names) that could be entities\n\nWhen you find an entity name, put it in the filter with a generic field name \"name\".`;\n    // Add conversation context if available\n    if (context && context.conversationHistory.length > 0) {\n        systemPrompt += `\n\nCONVERSATION CONTEXT:\nRecent conversation history (use this to resolve references and continuations):\n`;\n        // Add last few turns for context\n        const recentTurns = context.conversationHistory.slice(-3);\n        recentTurns.forEach((turn, index)=>{\n            systemPrompt += `\n${index + 1}. User asked: \"${turn.question}\"\n   Intent: ${turn.intent.type} ${turn.intent.target}${turn.intent.filter ? ` (filter: ${JSON.stringify(turn.intent.filter)})` : \"\"}\n   Collection: ${turn.intent.extractedCollection || \"database-wide\"}`;\n        });\n        if (context.lastEntity) {\n            systemPrompt += `\nLast mentioned entity: ${context.lastEntity}`;\n        }\n        if (context.lastCollection) {\n            systemPrompt += `\nLast used collection: ${context.lastCollection}`;\n        }\n        if (context.currentTopic) {\n            systemPrompt += `\nCurrent conversation topic: ${context.currentTopic}`;\n        }\n        systemPrompt += `\n\nUse this context to resolve pronouns (they, them, their, it), continuations (also, what about), and implied references.\nFor example:\n- \"their work\" when last entity was \"John Doe\" should become filter: {\"name\": \"John Doe\"}\n- \"what about Alice?\" after asking about \"John Doe's paintings\" should become \"search paintings by Alice\"\n- \"also show me Bob\" after \"count items by Alice\" should become \"search items by Bob\"`;\n    }\n    systemPrompt += `\n\nReturn ONLY a JSON object in this format:\n{\n  \"type\": \"count|search|list|filter|describe|summarize|analyze|collections|database\",\n  \"target\": \"what to count/search/list (e.g., 'items', 'entities', 'collections')\",\n  \"filter\": {\"name\": \"extracted_entity_name\"} or null,\n  \"limit\": number or null,\n  \"scope\": \"collection|database\",\n  \"extractedCollection\": \"collection_name_if_mentioned_in_query\" or null\n}\n\nExamples:\n- \"How many items by John Doe?\" → {\"type\": \"count\", \"target\": \"items\", \"filter\": {\"name\": \"John Doe\"}, \"limit\": null, \"scope\": \"database\", \"extractedCollection\": null}\n- \"Summarize Alice Smith's work in mycollection\" → {\"type\": \"summarize\", \"target\": \"items\", \"filter\": {\"name\": \"Alice Smith\"}, \"limit\": 10, \"scope\": \"collection\", \"extractedCollection\": \"mycollection\"}\n- \"Can you summarise the pieces done by Bob Johnson?\" → {\"type\": \"summarize\", \"target\": \"items\", \"filter\": {\"name\": \"Bob Johnson\"}, \"limit\": 10, \"scope\": \"database\", \"extractedCollection\": null}\n- \"Find all Maria Garcia artwork\" → {\"type\": \"search\", \"target\": \"items\", \"filter\": {\"name\": \"Maria Garcia\"}, \"limit\": 20, \"scope\": \"database\", \"extractedCollection\": null}\n- \"Show me data created by AI Assistant\" → {\"type\": \"search\", \"target\": \"items\", \"filter\": {\"name\": \"AI Assistant\"}, \"limit\": 10, \"scope\": \"database\", \"extractedCollection\": null}`;\n    try {\n        let response;\n        if (provider === \"gemini\" && process.env.GEMINI_API_KEY) {\n            const geminiModel = genAI.getGenerativeModel({\n                model: model || \"gemini-2.0-flash\"\n            });\n            const result = await geminiModel.generateContent([\n                {\n                    text: systemPrompt\n                },\n                {\n                    text: `Question: \"${question}\"`\n                }, \n            ]);\n            response = result.response.text();\n        } else if (provider === \"openai\" && process.env.OPENAI_API_KEY) {\n            try {\n                const completion = await openai.chat.completions.create({\n                    model: model || \"gpt-3.5-turbo\",\n                    messages: [\n                        {\n                            role: \"system\",\n                            content: systemPrompt\n                        },\n                        {\n                            role: \"user\",\n                            content: `Question: \"${question}\"`\n                        }, \n                    ],\n                    temperature: 0\n                });\n                response = completion.choices[0].message.content || \"{}\";\n            } catch (openaiError) {\n                console.warn(\"OpenAI failed, trying Gemini fallback:\", openaiError.message);\n                // Auto-fallback to Gemini if OpenAI fails\n                if (process.env.GEMINI_API_KEY) {\n                    const geminiModel1 = genAI.getGenerativeModel({\n                        model: \"gemini-2.0-flash\"\n                    });\n                    const result1 = await geminiModel1.generateContent([\n                        {\n                            text: systemPrompt\n                        },\n                        {\n                            text: `Question: \"${question}\"`\n                        }, \n                    ]);\n                    response = result1.response.text();\n                } else {\n                    throw openaiError; // Re-throw if no Gemini fallback available\n                }\n            }\n        } else {\n            throw new Error(\"No valid API key for the specified provider\");\n        }\n        // Extract JSON from response (in case there's extra text)\n        const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\n        const jsonStr = jsonMatch ? jsonMatch[0] : response;\n        return JSON.parse(jsonStr);\n    } catch (e) {\n        // Fallback parsing with context awareness\n        console.warn(\"Failed to parse LLM response, using context-aware fallback:\", e);\n        return fallbackIntent;\n    }\n}\nfunction inferIntentFromQuestion(question, context) {\n    const q = question.toLowerCase();\n    // Try to extract collection name from the question\n    const extractedCollection = extractCollectionFromQuestion(question);\n    // Handle pronouns in fallback if context is available\n    let processedQuestion = question;\n    if (context?.lastEntity) {\n        // Handle pronouns using context\n        if (q.includes(\" he \") || q.includes(\" him \") || q.includes(\"he \") || q.includes(\"him \")) {\n            console.log(\"\\uD83D\\uDD04 FALLBACK: Resolving 'he/him' to:\", context.lastEntity);\n            processedQuestion = processedQuestion.replace(/\\b(he|him)\\b/gi, context.lastEntity);\n        }\n        if (q.includes(\" they \") || q.includes(\" them \") || q.includes(\"they \") || q.includes(\"them \")) {\n            console.log(\"\\uD83D\\uDD04 FALLBACK: Resolving 'they/them' to:\", context.lastEntity);\n            processedQuestion = processedQuestion.replace(/\\b(they|them)\\b/gi, context.lastEntity);\n        }\n        if (q.includes(\" their \") || q.includes(\" his \") || q.includes(\" her \")) {\n            console.log(\"\\uD83D\\uDD04 FALLBACK: Resolving possessive to:\", context.lastEntity);\n            processedQuestion = processedQuestion.replace(/\\b(their|his|her)\\b/gi, context.lastEntity + \"'s\");\n        }\n    }\n    // Check for entity-specific queries with generic patterns (use processed question)\n    const entityMatch = processedQuestion.match(/(?:by|from|of)\\s+([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*?)(?=\\s+(?:in|from|of|at|with|for)\\b|$)/i) || processedQuestion.match(/(?:done\\s+by|created\\s+by|made\\s+by|work\\s+by|items\\s+by|pieces\\s+by)\\s+([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*?)(?=\\s+(?:in|from|of|at|with|for)\\b|$)/i) || processedQuestion.match(/([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)+)(?:\\s+(?:work|items|pieces|data|content))/i);\n    const entityName = entityMatch ? entityMatch[1].trim() : null;\n    // Database-level queries\n    if (q.includes(\"collections\") || q.includes(\"database\")) {\n        if (q.includes(\"how many\") || q.includes(\"count\")) {\n            return {\n                type: \"count\",\n                target: \"collections\",\n                scope: \"database\"\n            };\n        }\n        if (q.includes(\"list\") || q.includes(\"what\") || q.includes(\"show\")) {\n            return {\n                type: \"collections\",\n                target: \"list\",\n                scope: \"database\"\n            };\n        }\n        if (q.includes(\"describe\")) {\n            return {\n                type: \"database\",\n                target: \"overview\",\n                scope: \"database\"\n            };\n        }\n    }\n    // Entity-specific queries (high priority)\n    if (entityName) {\n        const filter = {\n            name: entityName\n        };\n        const scope = extractedCollection ? \"collection\" : \"database\";\n        if (q.includes(\"summary\") || q.includes(\"summarize\") || q.includes(\"summarise\") || q.includes(\"give me\") && q.includes(\"summary\")) {\n            return {\n                type: \"summarize\",\n                target: \"items\",\n                filter,\n                limit: 20,\n                scope,\n                ...extractedCollection && {\n                    extractedCollection\n                }\n            };\n        }\n        if (q.includes(\"how many\") || q.includes(\"count\")) {\n            return {\n                type: \"count\",\n                target: \"items\",\n                filter,\n                scope,\n                ...extractedCollection && {\n                    extractedCollection\n                }\n            };\n        }\n        if (q.includes(\"find\") || q.includes(\"search\") || q.includes(\"show\")) {\n            return {\n                type: \"search\",\n                target: \"items\",\n                filter,\n                limit: 10,\n                scope,\n                ...extractedCollection && {\n                    extractedCollection\n                }\n            };\n        }\n        if (q.includes(\"analyze\") || q.includes(\"analysis\")) {\n            return {\n                type: \"analyze\",\n                target: \"items\",\n                filter,\n                limit: 50,\n                scope,\n                ...extractedCollection && {\n                    extractedCollection\n                }\n            };\n        }\n    }\n    // Collection-level queries (existing logic)\n    if (q.includes(\"how many\") || q.includes(\"count\")) {\n        if (q.includes(\"entities\") || q.includes(\"names\") || q.includes(\"creators\")) {\n            return {\n                type: \"count\",\n                target: \"entities\",\n                scope: extractedCollection ? \"collection\" : \"database\",\n                ...extractedCollection && {\n                    extractedCollection\n                }\n            };\n        }\n        if (q.includes(\"vector\") || q.includes(\"item\") || q.includes(\"record\")) {\n            return {\n                type: \"count\",\n                target: \"total\",\n                scope: extractedCollection ? \"collection\" : \"database\",\n                ...extractedCollection && {\n                    extractedCollection\n                }\n            };\n        }\n        return {\n            type: \"count\",\n            target: \"total\",\n            scope: extractedCollection ? \"collection\" : \"database\",\n            ...extractedCollection && {\n                extractedCollection\n            }\n        };\n    }\n    if (q.includes(\"find\") || q.includes(\"search\")) {\n        // Check if it's across all collections\n        const scope1 = q.includes(\"all collections\") || q.includes(\"across\") ? \"database\" : extractedCollection ? \"collection\" : \"database\";\n        // Try to extract entity name (fallback pattern) - generic patterns\n        const fallbackEntityMatch = question.match(/(?:by|from|of)\\s+([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*?)(?=\\s+(?:in|from|of|at|with|for)\\b|$)/i) || question.match(/(?:done\\s+by|created\\s+by|made\\s+by)\\s+([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*?)(?=\\s+(?:in|from|of|at|with|for)\\b|$)/i);\n        if (fallbackEntityMatch) {\n            return {\n                type: \"search\",\n                target: \"items\",\n                filter: {\n                    name: fallbackEntityMatch[1]\n                },\n                limit: 10,\n                scope: scope1,\n                ...extractedCollection && {\n                    extractedCollection\n                }\n            };\n        }\n        return {\n            type: \"search\",\n            target: \"items\",\n            limit: 10,\n            scope: scope1,\n            ...extractedCollection && {\n                extractedCollection\n            }\n        };\n    }\n    if (q.includes(\"list\") || q.includes(\"show\")) {\n        if (q.includes(\"entities\") || q.includes(\"names\") || q.includes(\"creators\")) {\n            return {\n                type: \"list\",\n                target: \"entities\",\n                scope: extractedCollection ? \"collection\" : \"database\",\n                ...extractedCollection && {\n                    extractedCollection\n                }\n            };\n        }\n        return {\n            type: \"list\",\n            target: \"items\",\n            limit: 20,\n            scope: extractedCollection ? \"collection\" : \"database\",\n            ...extractedCollection && {\n                extractedCollection\n            }\n        };\n    }\n    if (q.includes(\"describe\")) {\n        return {\n            type: \"describe\",\n            target: extractedCollection ? \"collection\" : \"database\",\n            scope: extractedCollection ? \"collection\" : \"database\",\n            ...extractedCollection && {\n                extractedCollection\n            }\n        };\n    }\n    return {\n        type: \"describe\",\n        target: \"collection\",\n        scope: extractedCollection ? \"collection\" : \"database\",\n        ...extractedCollection && {\n            extractedCollection\n        }\n    };\n}\n// New function to extract collection names from natural language\nfunction extractCollectionFromQuestion(question) {\n    const q = question.toLowerCase();\n    // Common patterns for mentioning collections\n    const patterns = [\n        // \"in [collection]\" or \"from [collection]\"\n        /(?:in|from)\\s+([a-zA-Z][a-zA-Z0-9_-]*)/g,\n        // \"[collection] collection\"\n        /([a-zA-Z][a-zA-Z0-9_-]*)\\s+collection/g,\n        // \"collection [collection]\"\n        /collection\\s+([a-zA-Z][a-zA-Z0-9_-]*)/g, \n    ];\n    for (const pattern of patterns){\n        const matches = [\n            ...q.matchAll(pattern)\n        ];\n        for (const match of matches){\n            const candidate = match[1];\n            // Filter out common words that aren't collection names\n            if (![\n                \"the\",\n                \"this\",\n                \"that\",\n                \"my\",\n                \"your\",\n                \"our\",\n                \"their\",\n                \"all\",\n                \"some\",\n                \"any\",\n                \"each\",\n                \"every\", \n            ].includes(candidate)) {\n                return candidate;\n            }\n        }\n    }\n    // Look for specific common collection names that might appear without prepositions\n    const commonCollectionNames = [\n        \"midjourneysample\",\n        \"test_collection\",\n        \"my_docs\",\n        \"test_small\",\n        \"new_test_yearn\",\n        \"docs_openai\",\n        \"docs_gemini\", \n    ];\n    for (const name of commonCollectionNames){\n        if (q.includes(name)) {\n            return name;\n        }\n    }\n    return undefined;\n}\nasync function executeQuery(collection, intent) {\n    if (intent.scope === \"database\") {\n        return await executeDatabaseQuery(intent);\n    } else {\n        // Collection-level query - require collection name\n        if (!collection) {\n            throw new Error(\"Collection name is required for collection-level queries\");\n        }\n        return await executeCollectionQuery(collection, intent);\n    }\n}\nasync function executeDatabaseQuery(intent) {\n    switch(intent.type){\n        case \"count\":\n            if (intent.target === \"collections\") {\n                return await countCollections();\n            }\n            if (intent.target === \"artists\") {\n                return await countArtistsAcrossDatabase();\n            }\n            if ((intent.target === \"images\" || intent.target === \"items\") && intent.filter) {\n                return await countImagesByArtistAcrossDatabase(intent.filter);\n            }\n            if (intent.target === \"total\") {\n                return await countTotalVectorsAcrossDatabase();\n            }\n            // Fallback for count operations\n            return await countTotalVectorsAcrossDatabase();\n        case \"collections\":\n            return await listCollections();\n        case \"database\":\n            return await describeDatabaseInfo();\n        case \"search\":\n            if (intent.filter) {\n                return await searchAcrossCollections(intent.filter, intent.limit || 10);\n            }\n            break;\n        case \"summarize\":\n            if (intent.filter) {\n                return await summarizeArtistAcrossDatabase(intent.filter, intent.limit || 20);\n            }\n            break;\n        case \"list\":\n            if (intent.target === \"artists\") {\n                return await listArtistsAcrossDatabase(intent.limit || 50);\n            }\n            break;\n        default:\n            throw new Error(`Database-level query type '${intent.type}' not implemented yet`);\n    }\n    throw new Error(`Database-level query could not be executed: ${intent.type} ${intent.target}`);\n}\nasync function executeCollectionQuery(collection, intent) {\n    switch(intent.type){\n        case \"count\":\n            if (intent.target === \"artists\") {\n                return await countUniqueArtists(collection);\n            } else if ((intent.target === \"images\" || intent.target === \"items\") && intent.filter) {\n                return await countImagesByArtist(collection, intent.filter);\n            } else {\n                return await countTotal(collection);\n            }\n        case \"search\":\n            return await searchImages(collection, intent.filter, intent.limit || 10);\n        case \"summarize\":\n            return await summarizeArtistWork(collection, intent.filter, intent.limit || 20);\n        case \"analyze\":\n            return await analyzeArtistWork(collection, intent.filter, intent.limit || 50);\n        case \"list\":\n            if (intent.target === \"artists\") {\n                return await listUniqueArtists(collection, intent.limit || 50);\n            } else {\n                return await listImages(collection, intent.limit || 20);\n            }\n        case \"filter\":\n            return await filterImages(collection, intent.filter, intent.limit || 20);\n        case \"describe\":\n            return await describeCollection(collection);\n        default:\n            throw new Error(`Unknown collection-level query type: ${intent.type}`);\n    }\n}\n// New database-level functions\nasync function countCollections() {\n    const collectionsInfo = await _db__WEBPACK_IMPORTED_MODULE_2__.client.getCollections();\n    const collections = collectionsInfo.collections.map((c)=>c.name);\n    return {\n        count: collections.length,\n        collections: collections\n    };\n}\nasync function listCollections() {\n    const collectionsInfo = await _db__WEBPACK_IMPORTED_MODULE_2__.client.getCollections();\n    const collections = collectionsInfo.collections;\n    // Get detailed info for each collection using actual count\n    const detailedCollections = await Promise.all(collections.map(async (collection)=>{\n        try {\n            // Use the same count method that works for individual queries\n            const countResult = await _db__WEBPACK_IMPORTED_MODULE_2__.client.count(collection.name, {});\n            return {\n                name: collection.name,\n                vectors_count: countResult.count || 0\n            };\n        } catch (error) {\n            console.warn(`Failed to count vectors in collection ${collection.name}:`, error);\n            return {\n                name: collection.name,\n                vectors_count: 0\n            };\n        }\n    }));\n    return {\n        collections: detailedCollections\n    };\n}\nasync function describeDatabaseInfo() {\n    const collectionsData = await listCollections();\n    const totalVectors = collectionsData.collections.reduce((sum, col)=>sum + (col.vectors_count || 0), 0);\n    return {\n        total_collections: collectionsData.collections.length,\n        total_vectors: totalVectors,\n        collections: collectionsData.collections\n    };\n}\nasync function searchAcrossCollections(filter, limit) {\n    const collectionsData = await listCollections();\n    const allResults = [];\n    // Search each collection\n    for (const collection of collectionsData.collections){\n        try {\n            const results = await searchImages(collection.name, filter, limit);\n            if (results.images && results.images.length > 0) {\n                allResults.push({\n                    collection: collection.name,\n                    count: results.count,\n                    images: results.images\n                });\n            }\n        } catch (error) {\n            console.warn(`Failed to search collection ${collection.name}:`, error);\n        }\n    }\n    const totalCount = allResults.reduce((sum, result)=>sum + result.count, 0);\n    return {\n        total_count: totalCount,\n        collections_searched: collectionsData.collections.length,\n        results_by_collection: allResults\n    };\n}\n// Existing collection-level functions remain the same\nasync function countTotal(collection) {\n    const response = await _db__WEBPACK_IMPORTED_MODULE_2__.client.count(collection, {});\n    return {\n        count: response.count\n    };\n}\nasync function countUniqueArtists(collection) {\n    const response = await _db__WEBPACK_IMPORTED_MODULE_2__.client.scroll(collection, {\n        limit: 1000,\n        with_payload: true,\n        with_vector: false\n    });\n    const artists = new Set(response.points.map((point)=>point.payload?.name).filter(Boolean));\n    return {\n        count: artists.size,\n        artists: Array.from(artists).slice(0, 20)\n    };\n}\nasync function searchImages(collection, filter, limit) {\n    const response = await _db__WEBPACK_IMPORTED_MODULE_2__.client.scroll(collection, {\n        limit: 1000,\n        with_payload: true,\n        with_vector: false\n    });\n    let filteredPoints = response.points;\n    if (filter) {\n        filteredPoints = response.points.filter((point)=>{\n            return Object.entries(filter).every(([key, value])=>{\n                return point.payload?.[key] === value;\n            });\n        });\n    }\n    const limitedPoints = filteredPoints.slice(0, limit);\n    return {\n        count: limitedPoints.length,\n        images: limitedPoints\n    };\n}\nasync function listUniqueArtists(collection, limit) {\n    const response = await _db__WEBPACK_IMPORTED_MODULE_2__.client.scroll(collection, {\n        limit,\n        with_payload: true,\n        with_vector: false\n    });\n    const artists = new Set(response.points.map((point)=>point.payload?.name).filter(Boolean));\n    return {\n        artists: Array.from(artists)\n    };\n}\nasync function listImages(collection, limit) {\n    const response = await _db__WEBPACK_IMPORTED_MODULE_2__.client.scroll(collection, {\n        limit,\n        with_payload: true,\n        with_vector: false\n    });\n    return {\n        count: response.points.length,\n        images: response.points.map((point)=>({\n                id: point.id,\n                artist: point.payload?.name,\n                filename: point.payload?.file_name\n            }))\n    };\n}\nasync function filterImages(collection, filter, limit) {\n    return await searchImages(collection, filter, limit);\n}\nasync function describeCollection(collection) {\n    const totalCount = await countTotal(collection);\n    const artistsData = await countUniqueArtists(collection);\n    const sampleImages = await listImages(collection, 5);\n    return {\n        total_images: totalCount.count,\n        unique_artists: artistsData.count,\n        sample_artists: artistsData.artists.slice(0, 10),\n        sample_images: sampleImages.images\n    };\n}\nasync function generateResponse(question, intent, data, provider, model) {\n    const fallbackResponse = generateFallbackResponse(question, intent, data);\n    if (!process.env.OPENAI_API_KEY && !process.env.GEMINI_API_KEY) {\n        return fallbackResponse;\n    }\n    const systemPrompt = `You are a helpful assistant that explains vector database query results in natural language.\n  \nThe user asked: \"${question}\"\nThe query type was: ${intent.type}\nThe query scope was: ${intent.scope}\nThe data returned is: ${JSON.stringify(data, null, 2)}\n\nProvide a concise, natural language response that directly answers the user's question. Be specific with numbers and names when available.`;\n    try {\n        let response;\n        if (provider === \"gemini\" && process.env.GEMINI_API_KEY) {\n            const geminiModel = genAI.getGenerativeModel({\n                model: model || \"gemini-2.0-flash\"\n            });\n            const result = await geminiModel.generateContent(systemPrompt);\n            response = result.response.text();\n        } else if (provider === \"openai\" && process.env.OPENAI_API_KEY) {\n            try {\n                const completion = await openai.chat.completions.create({\n                    model: model || \"gpt-3.5-turbo\",\n                    messages: [\n                        {\n                            role: \"system\",\n                            content: systemPrompt\n                        }\n                    ],\n                    temperature: 0.3,\n                    max_tokens: 200\n                });\n                response = completion.choices[0].message.content || fallbackResponse;\n            } catch (openaiError) {\n                console.warn(\"OpenAI failed in generateResponse, trying Gemini fallback:\", openaiError.message);\n                // Auto-fallback to Gemini if OpenAI fails\n                if (process.env.GEMINI_API_KEY) {\n                    const geminiModel1 = genAI.getGenerativeModel({\n                        model: \"gemini-2.0-flash\"\n                    });\n                    const result1 = await geminiModel1.generateContent(systemPrompt);\n                    response = result1.response.text();\n                } else {\n                    throw openaiError; // Re-throw if no Gemini fallback available\n                }\n            }\n        } else {\n            return fallbackResponse;\n        }\n        return response.trim();\n    } catch (error) {\n        console.warn(\"Failed to generate LLM response, using fallback:\", error);\n        return fallbackResponse;\n    }\n}\nfunction generateFallbackResponse(question, intent, data) {\n    // Safely handle null/undefined data\n    const safeData = data || {};\n    if (intent.scope === \"database\") {\n        switch(intent.type){\n            case \"count\":\n                if (intent.target === \"collections\") {\n                    return `I found ${safeData.count || 0} collections in the database: ${safeData.collections?.join(\", \") || \"None found\"}.`;\n                }\n                if (intent.target === \"artists\") {\n                    return `I found ${safeData.count || 0} unique artists across all collections. Some of them include: ${safeData.artists?.slice(0, 5).join(\", \") || \"No artists found\"}.`;\n                }\n                if (intent.target === \"images\" && intent.filter?.name) {\n                    return `I found ${safeData.count || 0} images by ${safeData.artist || intent.filter.name} across all collections. ${safeData.by_collection?.length > 0 ? `Found in: ${safeData.by_collection.map((c)=>`${c.collection} (${c.count})`).join(\", \")}.` : \"\"}`;\n                }\n                if (intent.target === \"total\") {\n                    return `The database contains ${safeData.count || 0} total vectors across all collections.`;\n                }\n                break;\n            case \"collections\":\n                return `The database contains ${safeData.collections?.length || 0} collections: ${safeData.collections?.map((c)=>`${c.name} (${c.vectors_count || 0} vectors)`).join(\", \") || \"None found\"}.`;\n            case \"database\":\n                return `The database contains ${safeData.total_collections || 0} collections with a total of ${safeData.total_vectors || 0} vectors.`;\n            case \"search\":\n                return `I searched across ${safeData.collections_searched || 0} collections and found ${safeData.total_count || 0} matching items.`;\n            case \"summarize\":\n                if (intent.filter?.name) {\n                    return `Summary of ${safeData.artist || intent.filter.name}'s work across the database:\\n\\n` + `Total Images: ${safeData.total_images || 0}\\n` + `Collections: Found in ${safeData.collections_found || 0} collections\\n` + `File Types: ${safeData.file_types?.join(\", \") || \"Various\"}\\n\\n` + `Breakdown by collection:\\n${safeData.by_collection?.map((c)=>`• ${c.collection}: ${c.image_count} images`).join(\"\\n\") || \"No collections found\"}\\n\\n` + `Sample Images: ${safeData.sample_images?.slice(0, 3).map((img)=>`${img.filename} (${img.collection})`).join(\", \") || \"None found\"}`;\n                }\n                break;\n            case \"list\":\n                if (intent.target === \"artists\") {\n                    return `I found ${safeData.artists?.length || 0} unique artists across all collections: ${safeData.artists?.slice(0, 10).join(\", \") || \"No artists found\"}.`;\n                }\n                break;\n        }\n    }\n    // Collection-level responses\n    switch(intent.type){\n        case \"count\":\n            if (intent.target === \"artists\") {\n                return `I found ${safeData.count || 0} unique artists in the collection. Some of them include: ${safeData.artists?.slice(0, 5).join(\", \") || \"No artists found\"}.`;\n            } else if (intent.target === \"images\" && intent.filter?.name) {\n                return `I found ${safeData.count || 0} images by ${safeData.artist || intent.filter.name} in this collection.${safeData.sample_images?.length > 0 ? ` Sample files: ${safeData.sample_images.slice(0, 3).map((img)=>img.filename).join(\", \")}.` : \"\"}`;\n            } else {\n                return `The collection contains ${safeData.count || 0} total images.`;\n            }\n        case \"search\":\n        case \"filter\":\n            return `I found ${safeData.count || 0} images matching your criteria.`;\n        case \"summarize\":\n            if (intent.filter?.name) {\n                return `Summary of ${safeData.artist || intent.filter.name}'s work in this collection:\\n\\n` + `Total Images: ${safeData.total_images || 0}\\n` + `File Types: ${safeData.file_types?.join(\", \") || \"Various\"}\\n` + `Sample Files: ${safeData.sample_filenames?.slice(0, 5).join(\", \") || \"None\"}\\n\\n` + `Image Details:\\n${safeData.images?.slice(0, 5).map((img, i)=>`${i + 1}. ${img.filename || \"Unknown file\"}`).join(\"\\n\") || \"No images found\"}`;\n            }\n            break;\n        case \"analyze\":\n            if (intent.filter?.name) {\n                return `Analysis of ${safeData.artist || intent.filter.name}'s work patterns:\\n\\n` + `Total Images: ${safeData.total_images || 0}\\n` + `File Types: ${Object.entries(safeData.file_type_distribution || {}).map(([type, count])=>`${type} (${count})`).join(\", \") || \"Various\"}\\n` + `Common Patterns: ${Object.entries(safeData.common_naming_patterns || {}).slice(0, 3).map(([pattern, count])=>`\"${pattern}\" (${count} files)`).join(\", \") || \"No patterns found\"}\\n` + `Source Domains: ${Object.keys(safeData.source_domains || {}).join(\", \") || \"Various\"}`;\n            }\n            break;\n        case \"list\":\n            if (intent.target === \"artists\") {\n                return `Here are the artists in the collection: ${safeData.artists?.slice(0, 10).join(\", \") || \"No artists found\"}${safeData.artists?.length > 10 ? \"...\" : \"\"}.`;\n            } else {\n                return `I found ${safeData.count || 0} items in the collection.`;\n            }\n        case \"describe\":\n            return `This collection contains ${safeData.total_images || 0} images from ${safeData.unique_artists || 0} unique artists. Some featured artists include: ${safeData.sample_artists?.slice(0, 5).join(\", \") || \"No artists found\"}.`;\n        default:\n            return \"I processed your query successfully using pattern matching.\";\n    }\n    return \"I processed your query successfully.\";\n}\n// New database-level functions for artists and total counts\nasync function countArtistsAcrossDatabase() {\n    const collectionsData = await listCollections();\n    const allArtists = new Set();\n    // Collect artists from each collection\n    for (const collection of collectionsData.collections){\n        try {\n            if (collection.vectors_count && collection.vectors_count > 0) {\n                const artistsData = await countUniqueArtists(collection.name);\n                artistsData.artists.forEach((artist)=>allArtists.add(artist));\n            }\n        } catch (error) {\n            console.warn(`Failed to get artists from collection ${collection.name}:`, error);\n        }\n    }\n    return {\n        count: allArtists.size,\n        artists: Array.from(allArtists).slice(0, 20)\n    };\n}\nasync function countTotalVectorsAcrossDatabase() {\n    const collectionsData = await listCollections();\n    const totalVectors = collectionsData.collections.reduce((sum, col)=>sum + (col.vectors_count || 0), 0);\n    return {\n        count: totalVectors,\n        by_collection: collectionsData.collections.map((col)=>({\n                name: col.name,\n                count: col.vectors_count || 0\n            }))\n    };\n}\nasync function listArtistsAcrossDatabase(limit) {\n    const collectionsData = await listCollections();\n    const allArtists = new Set();\n    const byCollection = [];\n    // Collect artists from each collection\n    for (const collection of collectionsData.collections){\n        try {\n            if (collection.vectors_count && collection.vectors_count > 0) {\n                const artistsData = await listUniqueArtists(collection.name, Math.min(limit, 20));\n                artistsData.artists.forEach((artist)=>allArtists.add(artist));\n                byCollection.push({\n                    collection: collection.name,\n                    artists: artistsData.artists\n                });\n            }\n        } catch (error) {\n            console.warn(`Failed to get artists from collection ${collection.name}:`, error);\n        }\n    }\n    return {\n        artists: Array.from(allArtists).slice(0, limit),\n        by_collection: byCollection\n    };\n}\n// New function to count images by specific artist\nasync function countImagesByArtist(collection, filter) {\n    const response = await _db__WEBPACK_IMPORTED_MODULE_2__.client.scroll(collection, {\n        limit: 1000,\n        with_payload: true,\n        with_vector: false\n    });\n    let filteredPoints = response.points;\n    if (filter) {\n        filteredPoints = response.points.filter((point)=>{\n            return Object.entries(filter).every(([key, value])=>{\n                return point.payload?.[key] === value;\n            });\n        });\n    }\n    return {\n        count: filteredPoints.length,\n        artist: filter?.name || \"unknown\",\n        sample_images: filteredPoints.slice(0, 5).map((point)=>({\n                id: point.id,\n                filename: point.payload?.file_name,\n                url: point.payload?.image_url\n            }))\n    };\n}\n// New function to provide detailed summary of artist's work\nasync function summarizeArtistWork(collection, filter, limit) {\n    const response = await _db__WEBPACK_IMPORTED_MODULE_2__.client.scroll(collection, {\n        limit: 1000,\n        with_payload: true,\n        with_vector: false\n    });\n    let filteredPoints = response.points;\n    if (filter) {\n        filteredPoints = response.points.filter((point)=>{\n            return Object.entries(filter).every(([key, value])=>{\n                return point.payload?.[key] === value;\n            });\n        });\n    }\n    const limitedPoints = filteredPoints.slice(0, limit);\n    // Analyze file types and patterns\n    const fileExtensions = new Set();\n    const fileNames = [];\n    const imageUrls = [];\n    limitedPoints.forEach((point)=>{\n        if (point.payload?.file_name) {\n            const ext = point.payload.file_name.split(\".\").pop()?.toLowerCase();\n            if (ext) fileExtensions.add(ext);\n            fileNames.push(point.payload.file_name);\n        }\n        if (point.payload?.image_url) {\n            imageUrls.push(point.payload.image_url);\n        }\n    });\n    return {\n        artist: filter?.name || \"unknown\",\n        total_images: filteredPoints.length,\n        displayed_images: limitedPoints.length,\n        file_types: Array.from(fileExtensions),\n        sample_filenames: fileNames.slice(0, 8),\n        sample_urls: imageUrls.slice(0, 5),\n        images: limitedPoints.map((point)=>({\n                id: point.id,\n                filename: point.payload?.file_name,\n                image_url: point.payload?.image_url,\n                style_url: point.payload?.url\n            }))\n    };\n}\n// New function to analyze artist's work patterns\nasync function analyzeArtistWork(collection, filter, limit) {\n    const response = await _db__WEBPACK_IMPORTED_MODULE_2__.client.scroll(collection, {\n        limit: 1000,\n        with_payload: true,\n        with_vector: false\n    });\n    let filteredPoints = response.points;\n    if (filter) {\n        filteredPoints = response.points.filter((point)=>{\n            return Object.entries(filter).every(([key, value])=>{\n                return point.payload?.[key] === value;\n            });\n        });\n    }\n    // Analyze patterns in the artist's work\n    const fileTypes = new Map();\n    const namingPatterns = new Map();\n    const urlPatterns = new Map();\n    filteredPoints.forEach((point)=>{\n        // File type analysis\n        if (point.payload?.file_name) {\n            const ext = point.payload.file_name.split(\".\").pop()?.toLowerCase();\n            if (ext) {\n                fileTypes.set(ext, (fileTypes.get(ext) || 0) + 1);\n            }\n            // Naming pattern analysis\n            const namePattern = point.payload.file_name.replace(/\\d+/g, \"#\").replace(/\\.(jpg|jpeg|png|gif|webp)$/i, \"\");\n            namingPatterns.set(namePattern, (namingPatterns.get(namePattern) || 0) + 1);\n        }\n        // URL pattern analysis\n        if (point.payload?.url) {\n            const domain = point.payload.url.split(\"/\")[2];\n            if (domain) {\n                urlPatterns.set(domain, (urlPatterns.get(domain) || 0) + 1);\n            }\n        }\n    });\n    return {\n        artist: filter?.name || \"unknown\",\n        total_images: filteredPoints.length,\n        file_type_distribution: Object.fromEntries(fileTypes),\n        common_naming_patterns: Object.fromEntries(Array.from(namingPatterns.entries()).filter(([_, count])=>count > 1).sort((a, b)=>b[1] - a[1]).slice(0, 5)),\n        source_domains: Object.fromEntries(urlPatterns),\n        sample_images: filteredPoints.slice(0, 10).map((point)=>({\n                id: point.id,\n                filename: point.payload?.file_name,\n                image_url: point.payload?.image_url\n            }))\n    };\n}\n// New function to count specific artist images across all collections\nasync function countImagesByArtistAcrossDatabase(filter) {\n    const collectionsData = await listCollections();\n    const resultsByCollection = [];\n    let totalCount = 0;\n    for (const collection of collectionsData.collections){\n        try {\n            if (collection.vectors_count && collection.vectors_count > 0) {\n                const result = await countImagesByArtist(collection.name, filter);\n                if (result.count > 0) {\n                    resultsByCollection.push({\n                        collection: collection.name,\n                        count: result.count\n                    });\n                    totalCount += result.count;\n                }\n            }\n        } catch (error) {\n            console.warn(`Failed to count images in collection ${collection.name}:`, error);\n        }\n    }\n    return {\n        count: totalCount,\n        artist: filter?.name || \"unknown\",\n        by_collection: resultsByCollection\n    };\n}\n// New function to summarize artist work across all collections\nasync function summarizeArtistAcrossDatabase(filter, limit) {\n    const collectionsData = await listCollections();\n    const allImages = [];\n    const collectionSummaries = [];\n    const fileTypes = new Set();\n    for (const collection of collectionsData.collections){\n        try {\n            if (collection.vectors_count && collection.vectors_count > 0) {\n                const summary = await summarizeArtistWork(collection.name, filter, 50);\n                if (summary.total_images > 0) {\n                    collectionSummaries.push({\n                        collection: collection.name,\n                        ...summary\n                    });\n                    allImages.push(...summary.images);\n                    summary.file_types?.forEach((type)=>fileTypes.add(type));\n                }\n            }\n        } catch (error) {\n            console.warn(`Failed to summarize artist work in collection ${collection.name}:`, error);\n        }\n    }\n    const totalImages = allImages.length;\n    const displayedImages = allImages.slice(0, limit);\n    return {\n        artist: filter?.name || \"unknown\",\n        total_images: totalImages,\n        displayed_images: displayedImages.length,\n        collections_found: collectionSummaries.length,\n        file_types: Array.from(fileTypes),\n        by_collection: collectionSummaries.map((summary)=>({\n                collection: summary.collection,\n                image_count: summary.total_images,\n                sample_filenames: summary.sample_filenames?.slice(0, 3)\n            })),\n        sample_images: displayedImages.map((image)=>({\n                id: image.id,\n                filename: image.filename,\n                image_url: image.image_url,\n                collection: collectionSummaries.find((c)=>c.images?.some((img)=>img.id === image.id))?.collection\n            }))\n    };\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNKLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly95ZWFybi8uL2xpYi9xZHJhbnQvbmxwLXF1ZXJ5LnRzPzQ3NGIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE9wZW5BSSBmcm9tIFwib3BlbmFpXCI7XG5pbXBvcnQgeyBHb29nbGVHZW5lcmF0aXZlQUkgfSBmcm9tIFwiQGdvb2dsZS9nZW5lcmF0aXZlLWFpXCI7XG5pbXBvcnQgeyBjbGllbnQgfSBmcm9tIFwiLi9kYlwiO1xuaW1wb3J0IHsgRW1iZWRkaW5nUHJvdmlkZXIgfSBmcm9tIFwiLi4vc2NoZW1hc1wiO1xuaW1wb3J0IHsgQ29udmVyc2F0aW9uQ29udGV4dCwgQ29udmVyc2F0aW9uVHVybiB9IGZyb20gXCIuLi90eXBlc1wiO1xuXG5jb25zdCBvcGVuYWkgPSBuZXcgT3BlbkFJKHtcbiAgYXBpS2V5OiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSxcbn0pO1xuXG5jb25zdCBnZW5BSSA9IG5ldyBHb29nbGVHZW5lcmF0aXZlQUkocHJvY2Vzcy5lbnYuR0VNSU5JX0FQSV9LRVkgfHwgXCJcIik7XG5cbmludGVyZmFjZSBRdWVyeUludGVudCB7XG4gIHR5cGU6XG4gICAgfCBcImNvdW50XCJcbiAgICB8IFwic2VhcmNoXCJcbiAgICB8IFwibGlzdFwiXG4gICAgfCBcImZpbHRlclwiXG4gICAgfCBcImRlc2NyaWJlXCJcbiAgICB8IFwiY29sbGVjdGlvbnNcIlxuICAgIHwgXCJkYXRhYmFzZVwiXG4gICAgfCBcInN1bW1hcml6ZVwiXG4gICAgfCBcImFuYWx5emVcIjtcbiAgdGFyZ2V0OiBzdHJpbmc7IC8vIHdoYXQgdG8gY291bnQvc2VhcmNoL2xpc3RcbiAgZmlsdGVyPzogYW55OyAvLyBhbnkgZmlsdGVycyB0byBhcHBseVxuICBsaW1pdD86IG51bWJlcjtcbiAgc2NvcGU6IFwiY29sbGVjdGlvblwiIHwgXCJkYXRhYmFzZVwiOyAvLyBuZXc6IHNjb3BlIG9mIHRoZSBxdWVyeVxuICBleHRyYWN0ZWRDb2xsZWN0aW9uPzogc3RyaW5nOyAvLyBuZXc6IGNvbGxlY3Rpb24gbmFtZSBleHRyYWN0ZWQgZnJvbSBxdWVyeSB0ZXh0XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzTmF0dXJhbFF1ZXJ5KFxuICBjb2xsZWN0aW9uOiBzdHJpbmcgfCBudWxsLCAvLyBNYWtlIGNvbGxlY3Rpb24gb3B0aW9uYWxcbiAgcXVlc3Rpb246IHN0cmluZyxcbiAgcHJvdmlkZXI6IEVtYmVkZGluZ1Byb3ZpZGVyID0gXCJvcGVuYWlcIixcbiAgbW9kZWw/OiBzdHJpbmcsIC8vIEFkZCBzcGVjaWZpYyBtb2RlbCBwYXJhbWV0ZXJcbiAgY29udGV4dD86IENvbnZlcnNhdGlvbkNvbnRleHQgLy8gQWRkIGNvbnZlcnNhdGlvbiBjb250ZXh0XG4pOiBQcm9taXNlPHtcbiAgYW5zd2VyOiBzdHJpbmc7XG4gIHF1ZXJ5X3R5cGU6IHN0cmluZztcbiAgZGF0YT86IGFueTtcbiAgZXhlY3V0aW9uX3RpbWVfbXM6IG51bWJlcjtcbiAgY29udGV4dDogQ29udmVyc2F0aW9uQ29udGV4dDsgLy8gUmV0dXJuIHVwZGF0ZWQgY29udGV4dFxufT4ge1xuICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gIHRyeSB7XG4gICAgLy8gU3RlcCAxOiBSZXNvbHZlIGNvbnRleHQgYW5kIGVucmljaCB0aGUgcXVlc3Rpb25cbiAgICBjb25zdCB7IGVucmljaGVkUXVlc3Rpb24sIHJlc29sdmVkQ29sbGVjdGlvbiwgdXBkYXRlZENvbnRleHQgfSA9XG4gICAgICBhd2FpdCByZXNvbHZlQ29udGV4dChxdWVzdGlvbiwgY29sbGVjdGlvbiwgY29udGV4dCk7XG5cbiAgICAvLyBTdGVwIDI6IFBhcnNlIGludGVudCB3aXRoIGNvbnRleHQgYXdhcmVuZXNzXG4gICAgY29uc3QgaW50ZW50ID0gYXdhaXQgcGFyc2VRdWVyeUludGVudChcbiAgICAgIGVucmljaGVkUXVlc3Rpb24sXG4gICAgICBwcm92aWRlcixcbiAgICAgIG1vZGVsLFxuICAgICAgdXBkYXRlZENvbnRleHRcbiAgICApO1xuXG4gICAgLy8gU3RlcCAzOiBVc2UgcmVzb2x2ZWQgY29sbGVjdGlvbiBvciBleHRyYWN0ZWQgY29sbGVjdGlvblxuICAgIGNvbnN0IGZpbmFsQ29sbGVjdGlvbiA9XG4gICAgICByZXNvbHZlZENvbGxlY3Rpb24gfHwgaW50ZW50LmV4dHJhY3RlZENvbGxlY3Rpb24gfHwgbnVsbDtcblxuICAgIC8vIFN0ZXAgNDogRXhlY3V0ZSB0aGUgYXBwcm9wcmlhdGUgb3BlcmF0aW9uXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZXhlY3V0ZVF1ZXJ5KGZpbmFsQ29sbGVjdGlvbiwgaW50ZW50KTtcblxuICAgIC8vIFN0ZXAgNTogR2VuZXJhdGUgbmF0dXJhbCBsYW5ndWFnZSByZXNwb25zZVxuICAgIGNvbnN0IGFuc3dlciA9IGF3YWl0IGdlbmVyYXRlUmVzcG9uc2UoXG4gICAgICBlbnJpY2hlZFF1ZXN0aW9uLFxuICAgICAgaW50ZW50LFxuICAgICAgcmVzdWx0LFxuICAgICAgcHJvdmlkZXIsXG4gICAgICBtb2RlbFxuICAgICk7XG5cbiAgICAvLyBTdGVwIDY6IFVwZGF0ZSBjb252ZXJzYXRpb24gY29udGV4dFxuICAgIGNvbnN0IGZpbmFsQ29udGV4dCA9IHVwZGF0ZUNvbnZlcnNhdGlvbkNvbnRleHQoXG4gICAgICB1cGRhdGVkQ29udGV4dCxcbiAgICAgIHF1ZXN0aW9uLFxuICAgICAgaW50ZW50LFxuICAgICAgcmVzdWx0LFxuICAgICAgZmluYWxDb2xsZWN0aW9uXG4gICAgKTtcblxuICAgIGNvbnN0IGV4ZWN1dGlvbl90aW1lX21zID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgIHJldHVybiB7XG4gICAgICBhbnN3ZXIsXG4gICAgICBxdWVyeV90eXBlOiBpbnRlbnQudHlwZSxcbiAgICAgIGRhdGE6IHJlc3VsdCxcbiAgICAgIGV4ZWN1dGlvbl90aW1lX21zLFxuICAgICAgY29udGV4dDogZmluYWxDb250ZXh0LFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIHByb2Nlc3NpbmcgbmF0dXJhbCBxdWVyeTpcIiwgZXJyb3IpO1xuXG4gICAgLy8gQ3JlYXRlIGZhbGxiYWNrIHJlc3BvbnNlXG4gICAgY29uc3QgZmFsbGJhY2tBbnN3ZXIgPVxuICAgICAgXCJJIGVuY291bnRlcmVkIGFuIGlzc3VlIHByb2Nlc3NpbmcgeW91ciBxdWVyeSwgYnV0IEknbSB1c2luZyBwYXR0ZXJuIG1hdGNoaW5nIHRvIGhlbHAuIFwiICtcbiAgICAgIGdlbmVyYXRlRmFsbGJhY2tSZXNwb25zZShcbiAgICAgICAgcXVlc3Rpb24sXG4gICAgICAgIGluZmVySW50ZW50RnJvbVF1ZXN0aW9uKHF1ZXN0aW9uLCBjb250ZXh0KSxcbiAgICAgICAge1xuICAgICAgICAgIGNvdW50OiAwLFxuICAgICAgICB9XG4gICAgICApO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGFuc3dlcjogZmFsbGJhY2tBbnN3ZXIsXG4gICAgICBxdWVyeV90eXBlOiBcImZhbGxiYWNrXCIsXG4gICAgICBkYXRhOiBudWxsLFxuICAgICAgZXhlY3V0aW9uX3RpbWVfbXM6IERhdGUubm93KCkgLSBzdGFydFRpbWUsXG4gICAgICBjb250ZXh0OiBjb250ZXh0IHx8IHsgY29udmVyc2F0aW9uSGlzdG9yeTogW10gfSxcbiAgICB9O1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlc29sdmVDb250ZXh0KFxuICBxdWVzdGlvbjogc3RyaW5nLFxuICBjb2xsZWN0aW9uOiBzdHJpbmcgfCBudWxsLFxuICBjb250ZXh0PzogQ29udmVyc2F0aW9uQ29udGV4dFxuKTogUHJvbWlzZTx7XG4gIGVucmljaGVkUXVlc3Rpb246IHN0cmluZztcbiAgcmVzb2x2ZWRDb2xsZWN0aW9uOiBzdHJpbmcgfCBudWxsO1xuICB1cGRhdGVkQ29udGV4dDogQ29udmVyc2F0aW9uQ29udGV4dDtcbn0+IHtcbiAgLy8gSW5pdGlhbGl6ZSBjb250ZXh0IGlmIG5vdCBwcm92aWRlZFxuICBjb25zdCBjdXJyZW50Q29udGV4dDogQ29udmVyc2F0aW9uQ29udGV4dCA9IGNvbnRleHQgfHwge1xuICAgIGNvbnZlcnNhdGlvbkhpc3Rvcnk6IFtdLFxuICB9O1xuXG4gIGxldCBlbnJpY2hlZFF1ZXN0aW9uID0gcXVlc3Rpb247XG4gIGxldCByZXNvbHZlZENvbGxlY3Rpb24gPSBjb2xsZWN0aW9uO1xuXG4gIGNvbnNvbGUubG9nKFwi8J+noCBDT05URVhUIFJFU09MVVRJT046XCIpO1xuICBjb25zb2xlLmxvZyhcIk9yaWdpbmFsIHF1ZXN0aW9uOlwiLCBxdWVzdGlvbik7XG4gIGNvbnNvbGUubG9nKFwiQ3VycmVudCBjb250ZXh0OlwiLCBKU09OLnN0cmluZ2lmeShjdXJyZW50Q29udGV4dCwgbnVsbCwgMikpO1xuXG4gIC8vIERldGVjdCBjb250ZXh0dWFsIHJlZmVyZW5jZXNcbiAgY29uc3QgbG93ZXJjYXNlUXVlc3Rpb24gPSBxdWVzdGlvbi50b0xvd2VyQ2FzZSgpO1xuXG4gIC8vIEhhbmRsZSBwcm9ub3VuIHJlZmVyZW5jZXMgdG8gZW50aXRpZXNcbiAgaWYgKFxuICAgIChsb3dlcmNhc2VRdWVzdGlvbi5pbmNsdWRlcyhcInRoZWlyXCIpIHx8XG4gICAgICBsb3dlcmNhc2VRdWVzdGlvbi5pbmNsdWRlcyhcImhpc1wiKSB8fFxuICAgICAgbG93ZXJjYXNlUXVlc3Rpb24uaW5jbHVkZXMoXCJoZXJcIikgfHxcbiAgICAgIGxvd2VyY2FzZVF1ZXN0aW9uLmluY2x1ZGVzKFwiaXRzXCIpKSAmJlxuICAgIGN1cnJlbnRDb250ZXh0Lmxhc3RFbnRpdHlcbiAgKSB7XG4gICAgY29uc29sZS5sb2coXG4gICAgICBcIvCflIQgUmVzb2x2aW5nIHBvc3Nlc3NpdmUgcHJvbm91biB0bzpcIixcbiAgICAgIGN1cnJlbnRDb250ZXh0Lmxhc3RFbnRpdHlcbiAgICApO1xuICAgIGVucmljaGVkUXVlc3Rpb24gPSBlbnJpY2hlZFF1ZXN0aW9uLnJlcGxhY2UoXG4gICAgICAvXFxiKHRoZWlyfGhpc3xoZXJ8aXRzKVxcYi9naSxcbiAgICAgIGN1cnJlbnRDb250ZXh0Lmxhc3RFbnRpdHkgKyBcIidzXCJcbiAgICApO1xuICB9XG5cbiAgLy8gSGFuZGxlIFwiaGVcIiBhbmQgXCJoaW1cIiByZWZlcmVuY2VzXG4gIGlmIChcbiAgICAobG93ZXJjYXNlUXVlc3Rpb24uaW5jbHVkZXMoXCJoZSBcIikgfHxcbiAgICAgIGxvd2VyY2FzZVF1ZXN0aW9uLmluY2x1ZGVzKFwiaGltIFwiKSB8fFxuICAgICAgbG93ZXJjYXNlUXVlc3Rpb24uaW5jbHVkZXMoXCIgaGVcIikgfHxcbiAgICAgIGxvd2VyY2FzZVF1ZXN0aW9uLmluY2x1ZGVzKFwiIGhpbVwiKSkgJiZcbiAgICBjdXJyZW50Q29udGV4dC5sYXN0RW50aXR5XG4gICkge1xuICAgIGNvbnNvbGUubG9nKFwi8J+UhCBSZXNvbHZpbmcgJ2hlL2hpbScgdG86XCIsIGN1cnJlbnRDb250ZXh0Lmxhc3RFbnRpdHkpO1xuICAgIGVucmljaGVkUXVlc3Rpb24gPSBlbnJpY2hlZFF1ZXN0aW9uLnJlcGxhY2UoXG4gICAgICAvXFxiKGhlfGhpbSlcXGIvZ2ksXG4gICAgICBjdXJyZW50Q29udGV4dC5sYXN0RW50aXR5XG4gICAgKTtcbiAgfVxuXG4gIC8vIEhhbmRsZSBcImFsc29cIiByZWZlcmVuY2VzXG4gIGlmIChsb3dlcmNhc2VRdWVzdGlvbi5pbmNsdWRlcyhcImFsc29cIikgJiYgY3VycmVudENvbnRleHQubGFzdEVudGl0eSkge1xuICAgIGlmICghZW5yaWNoZWRRdWVzdGlvbi5pbmNsdWRlcyhjdXJyZW50Q29udGV4dC5sYXN0RW50aXR5KSkge1xuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIFwi8J+UhCBSZXNvbHZpbmcgJ2Fsc28nIHJlZmVyZW5jZSB0bzpcIixcbiAgICAgICAgY3VycmVudENvbnRleHQubGFzdEVudGl0eVxuICAgICAgKTtcbiAgICAgIGVucmljaGVkUXVlc3Rpb24gPSBlbnJpY2hlZFF1ZXN0aW9uLnJlcGxhY2UoXG4gICAgICAgIC9hbHNvL2ksXG4gICAgICAgIGBhbHNvIGZvciAke2N1cnJlbnRDb250ZXh0Lmxhc3RFbnRpdHl9YFxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvLyBIYW5kbGUgXCJ0aGVtXCIgcmVmZXJlbmNlc1xuICBpZiAobG93ZXJjYXNlUXVlc3Rpb24uaW5jbHVkZXMoXCJ0aGVtXCIpICYmIGN1cnJlbnRDb250ZXh0Lmxhc3RFbnRpdHkpIHtcbiAgICBjb25zb2xlLmxvZyhcIvCflIQgUmVzb2x2aW5nICd0aGVtJyB0bzpcIiwgY3VycmVudENvbnRleHQubGFzdEVudGl0eSk7XG4gICAgZW5yaWNoZWRRdWVzdGlvbiA9IGVucmljaGVkUXVlc3Rpb24ucmVwbGFjZShcbiAgICAgIC9cXGJ0aGVtXFxiL2dpLFxuICAgICAgY3VycmVudENvbnRleHQubGFzdEVudGl0eVxuICAgICk7XG4gIH1cblxuICAvLyBIYW5kbGUgXCJ0aGV5XCIgcmVmZXJlbmNlc1xuICBpZiAobG93ZXJjYXNlUXVlc3Rpb24uaW5jbHVkZXMoXCJ0aGV5XCIpICYmIGN1cnJlbnRDb250ZXh0Lmxhc3RFbnRpdHkpIHtcbiAgICBjb25zb2xlLmxvZyhcIvCflIQgUmVzb2x2aW5nICd0aGV5JyB0bzpcIiwgY3VycmVudENvbnRleHQubGFzdEVudGl0eSk7XG4gICAgZW5yaWNoZWRRdWVzdGlvbiA9IGVucmljaGVkUXVlc3Rpb24ucmVwbGFjZShcbiAgICAgIC9cXGJ0aGV5XFxiL2dpLFxuICAgICAgY3VycmVudENvbnRleHQubGFzdEVudGl0eVxuICAgICk7XG4gIH1cblxuICAvLyBIYW5kbGUgXCJpdFwiIHJlZmVyZW5jZXMgdG8gY29sbGVjdGlvbnNcbiAgaWYgKGxvd2VyY2FzZVF1ZXN0aW9uLmluY2x1ZGVzKFwiaXRcIikgJiYgY3VycmVudENvbnRleHQubGFzdENvbGxlY3Rpb24pIHtcbiAgICBjb25zb2xlLmxvZyhcbiAgICAgIFwi8J+UhCBSZXNvbHZpbmcgJ2l0JyB0byBjb2xsZWN0aW9uOlwiLFxuICAgICAgY3VycmVudENvbnRleHQubGFzdENvbGxlY3Rpb25cbiAgICApO1xuICAgIGVucmljaGVkUXVlc3Rpb24gPSBlbnJpY2hlZFF1ZXN0aW9uLnJlcGxhY2UoXG4gICAgICAvXFxiaXRcXGIvZ2ksXG4gICAgICBjdXJyZW50Q29udGV4dC5sYXN0Q29sbGVjdGlvblxuICAgICk7XG4gIH1cblxuICAvLyBIYW5kbGUgY29udGludWF0aW9uIHBocmFzZXNcbiAgaWYgKFxuICAgIChsb3dlcmNhc2VRdWVzdGlvbi5pbmNsdWRlcyhcIndoYXQgYWJvdXRcIikgfHxcbiAgICAgIGxvd2VyY2FzZVF1ZXN0aW9uLmluY2x1ZGVzKFwiaG93IGFib3V0XCIpIHx8XG4gICAgICBsb3dlcmNhc2VRdWVzdGlvbi5pbmNsdWRlcyhcImFuZFwiKSkgJiZcbiAgICBjdXJyZW50Q29udGV4dC5sYXN0UXVlcnlUeXBlICYmXG4gICAgY3VycmVudENvbnRleHQubGFzdFRhcmdldFxuICApIHtcbiAgICAvLyBJZiBxdWVzdGlvbiBpcyBsaWtlIFwid2hhdCBhYm91dCBKb2huIERvZT9cIiwgZXhwYW5kIHRvIGZ1bGwgY29udGV4dFxuICAgIGNvbnN0IGVudGl0eU1hdGNoID0gcXVlc3Rpb24ubWF0Y2goXG4gICAgICAvKD86d2hhdCBhYm91dHxob3cgYWJvdXR8YW5kKVxccysoW0EtWl1bYS16XSsoPzpcXHMrW0EtWl1bYS16XSspKikvaVxuICAgICk7XG4gICAgaWYgKGVudGl0eU1hdGNoKSB7XG4gICAgICBjb25zdCBuZXdFbnRpdHkgPSBlbnRpdHlNYXRjaFsxXTtcbiAgICAgIGNvbnN0IGxhc3RRdWVyeVR5cGUgPSBjdXJyZW50Q29udGV4dC5sYXN0UXVlcnlUeXBlO1xuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIFwi8J+UhCBSZXNvbHZpbmcgY29udGludWF0aW9uIHRvOlwiLFxuICAgICAgICBgJHtsYXN0UXVlcnlUeXBlfSAke2N1cnJlbnRDb250ZXh0Lmxhc3RUYXJnZXR9IGJ5ICR7bmV3RW50aXR5fWBcbiAgICAgICk7XG4gICAgICBlbnJpY2hlZFF1ZXN0aW9uID0gYCR7bGFzdFF1ZXJ5VHlwZX0gJHtjdXJyZW50Q29udGV4dC5sYXN0VGFyZ2V0fSBieSAke25ld0VudGl0eX1gO1xuICAgIH1cbiAgfVxuXG4gIC8vIFJlc29sdmUgY29sbGVjdGlvbiBjb250ZXh0XG4gIGlmICghcmVzb2x2ZWRDb2xsZWN0aW9uICYmIGN1cnJlbnRDb250ZXh0Lmxhc3RDb2xsZWN0aW9uKSB7XG4gICAgLy8gSWYgbm8gY29sbGVjdGlvbiBzcGVjaWZpZWQgYnV0IHdlIGhhdmUgY29udGV4dCwgY2hlY2sgaWYgcXVlcnkgc2VlbXMgY29sbGVjdGlvbi1zcGVjaWZpY1xuICAgIGlmIChcbiAgICAgIGxvd2VyY2FzZVF1ZXN0aW9uLmluY2x1ZGVzKFwidGhpcyBjb2xsZWN0aW9uXCIpIHx8XG4gICAgICBsb3dlcmNhc2VRdWVzdGlvbi5pbmNsdWRlcyhcInNhbWUgY29sbGVjdGlvblwiKSB8fFxuICAgICAgKCFsb3dlcmNhc2VRdWVzdGlvbi5pbmNsdWRlcyhcImFsbCBjb2xsZWN0aW9uc1wiKSAmJlxuICAgICAgICAhbG93ZXJjYXNlUXVlc3Rpb24uaW5jbHVkZXMoXCJkYXRhYmFzZVwiKSlcbiAgICApIHtcbiAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICBcIvCflIQgUmVzb2x2aW5nIGNvbGxlY3Rpb24gY29udGV4dCB0bzpcIixcbiAgICAgICAgY3VycmVudENvbnRleHQubGFzdENvbGxlY3Rpb25cbiAgICAgICk7XG4gICAgICByZXNvbHZlZENvbGxlY3Rpb24gPSBjdXJyZW50Q29udGV4dC5sYXN0Q29sbGVjdGlvbjtcbiAgICB9XG4gIH1cblxuICBjb25zb2xlLmxvZyhcIuKchSBFbnJpY2hlZCBxdWVzdGlvbjpcIiwgZW5yaWNoZWRRdWVzdGlvbik7XG4gIGNvbnNvbGUubG9nKFwi4pyFIFJlc29sdmVkIGNvbGxlY3Rpb246XCIsIHJlc29sdmVkQ29sbGVjdGlvbik7XG5cbiAgcmV0dXJuIHtcbiAgICBlbnJpY2hlZFF1ZXN0aW9uLFxuICAgIHJlc29sdmVkQ29sbGVjdGlvbixcbiAgICB1cGRhdGVkQ29udGV4dDogY3VycmVudENvbnRleHQsXG4gIH07XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUNvbnZlcnNhdGlvbkNvbnRleHQoXG4gIGNvbnRleHQ6IENvbnZlcnNhdGlvbkNvbnRleHQsXG4gIHF1ZXN0aW9uOiBzdHJpbmcsXG4gIGludGVudDogUXVlcnlJbnRlbnQsXG4gIHJlc3VsdDogYW55LFxuICBjb2xsZWN0aW9uOiBzdHJpbmcgfCBudWxsXG4pOiBDb252ZXJzYXRpb25Db250ZXh0IHtcbiAgY29uc29sZS5sb2coXCLwn5K+IFVQREFUSU5HIENPTlZFUlNBVElPTiBDT05URVhUOlwiKTtcbiAgY29uc29sZS5sb2coXCJQcmV2aW91cyBjb250ZXh0OlwiLCBKU09OLnN0cmluZ2lmeShjb250ZXh0LCBudWxsLCAyKSk7XG4gIGNvbnNvbGUubG9nKFwiSW50ZW50OlwiLCBKU09OLnN0cmluZ2lmeShpbnRlbnQsIG51bGwsIDIpKTtcbiAgY29uc29sZS5sb2coXCJDb2xsZWN0aW9uOlwiLCBjb2xsZWN0aW9uKTtcblxuICAvLyBDcmVhdGUgbmV3IGNvbnZlcnNhdGlvbiB0dXJuXG4gIGNvbnN0IHR1cm46IENvbnZlcnNhdGlvblR1cm4gPSB7XG4gICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSxcbiAgICBxdWVzdGlvbixcbiAgICBpbnRlbnQ6IHtcbiAgICAgIHR5cGU6IGludGVudC50eXBlLFxuICAgICAgdGFyZ2V0OiBpbnRlbnQudGFyZ2V0LFxuICAgICAgZmlsdGVyOiBpbnRlbnQuZmlsdGVyLFxuICAgICAgc2NvcGU6IGludGVudC5zY29wZSxcbiAgICAgIGV4dHJhY3RlZENvbGxlY3Rpb246IGludGVudC5leHRyYWN0ZWRDb2xsZWN0aW9uLFxuICAgIH0sXG4gICAgcmVzdWx0LFxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgfTtcblxuICAvLyBVcGRhdGUgY29udGV4dFxuICBjb25zdCB1cGRhdGVkQ29udGV4dDogQ29udmVyc2F0aW9uQ29udGV4dCA9IHtcbiAgICAuLi5jb250ZXh0LFxuICAgIGNvbnZlcnNhdGlvbkhpc3Rvcnk6IFsuLi5jb250ZXh0LmNvbnZlcnNhdGlvbkhpc3RvcnksIHR1cm5dLnNsaWNlKC0xMCksIC8vIEtlZXAgbGFzdCAxMCB0dXJuc1xuICB9O1xuXG4gIC8vIFVwZGF0ZSBsYXN0IGVudGl0eSBpZiBmaWx0ZXIgY29udGFpbnMgYSBuYW1lXG4gIGlmIChpbnRlbnQuZmlsdGVyPy5uYW1lKSB7XG4gICAgdXBkYXRlZENvbnRleHQubGFzdEVudGl0eSA9IGludGVudC5maWx0ZXIubmFtZTtcbiAgICBjb25zb2xlLmxvZyhcIvCfk50gVXBkYXRlZCBsYXN0RW50aXR5IHRvOlwiLCBpbnRlbnQuZmlsdGVyLm5hbWUpO1xuICB9XG5cbiAgLy8gVXBkYXRlIGxhc3QgY29sbGVjdGlvblxuICBpZiAoY29sbGVjdGlvbikge1xuICAgIHVwZGF0ZWRDb250ZXh0Lmxhc3RDb2xsZWN0aW9uID0gY29sbGVjdGlvbjtcbiAgICBjb25zb2xlLmxvZyhcIvCfk50gVXBkYXRlZCBsYXN0Q29sbGVjdGlvbiB0bzpcIiwgY29sbGVjdGlvbik7XG4gIH1cblxuICAvLyBVcGRhdGUgbGFzdCBxdWVyeSB0eXBlIGFuZCB0YXJnZXRcbiAgdXBkYXRlZENvbnRleHQubGFzdFF1ZXJ5VHlwZSA9IGludGVudC50eXBlO1xuICB1cGRhdGVkQ29udGV4dC5sYXN0VGFyZ2V0ID0gaW50ZW50LnRhcmdldDtcbiAgY29uc29sZS5sb2coXCLwn5OdIFVwZGF0ZWQgbGFzdFF1ZXJ5VHlwZSB0bzpcIiwgaW50ZW50LnR5cGUpO1xuICBjb25zb2xlLmxvZyhcIvCfk50gVXBkYXRlZCBsYXN0VGFyZ2V0IHRvOlwiLCBpbnRlbnQudGFyZ2V0KTtcblxuICAvLyBVcGRhdGUgY3VycmVudCB0b3BpYyBiYXNlZCBvbiBxdWVyeSBjb250ZW50XG4gIGlmIChpbnRlbnQuZmlsdGVyPy5uYW1lKSB7XG4gICAgdXBkYXRlZENvbnRleHQuY3VycmVudFRvcGljID0gYCR7aW50ZW50LmZpbHRlci5uYW1lfSAke2ludGVudC50YXJnZXR9YDtcbiAgICBjb25zb2xlLmxvZyhcIvCfk50gVXBkYXRlZCBjdXJyZW50VG9waWMgdG86XCIsIHVwZGF0ZWRDb250ZXh0LmN1cnJlbnRUb3BpYyk7XG4gIH1cblxuICBjb25zb2xlLmxvZyhcbiAgICBcIuKchSBGaW5hbCB1cGRhdGVkIGNvbnRleHQ6XCIsXG4gICAgSlNPTi5zdHJpbmdpZnkodXBkYXRlZENvbnRleHQsIG51bGwsIDIpXG4gICk7XG5cbiAgcmV0dXJuIHVwZGF0ZWRDb250ZXh0O1xufVxuXG5hc3luYyBmdW5jdGlvbiBwYXJzZVF1ZXJ5SW50ZW50KFxuICBxdWVzdGlvbjogc3RyaW5nLFxuICBwcm92aWRlcjogRW1iZWRkaW5nUHJvdmlkZXIsXG4gIG1vZGVsPzogc3RyaW5nLFxuICBjb250ZXh0PzogQ29udmVyc2F0aW9uQ29udGV4dFxuKTogUHJvbWlzZTxRdWVyeUludGVudD4ge1xuICAvLyBGaXJzdCB0cnkgc2ltcGxlIHBhdHRlcm4gbWF0Y2hpbmcgYXMgZmFsbGJhY2tcbiAgY29uc3QgZmFsbGJhY2tJbnRlbnQgPSBpbmZlckludGVudEZyb21RdWVzdGlvbihxdWVzdGlvbiwgY29udGV4dCk7XG5cbiAgLy8gQnVpbGQgY29udGV4dC1hd2FyZSBzeXN0ZW0gcHJvbXB0XG4gIGxldCBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBhIHF1ZXJ5IGludGVudCBwYXJzZXIgZm9yIGEgdmVjdG9yIGRhdGFiYXNlIHN5c3RlbS4gUGFyc2UgdGhlIHVzZXIncyBxdWVzdGlvbiB0byBkZXRlcm1pbmU6XG4xLiBRdWVyeSB0eXBlIChjb3VudCwgc2VhcmNoLCBsaXN0LCBmaWx0ZXIsIGRlc2NyaWJlLCBzdW1tYXJpemUsIGFuYWx5emUsIGNvbGxlY3Rpb25zLCBkYXRhYmFzZSlcbjIuIFdoYXQgdG8gdGFyZ2V0IChpdGVtcywgZW50aXRpZXMsIGNvbGxlY3Rpb25zLCBldGMuKVxuMy4gQW55IGZpbHRlcnMgdG8gYXBwbHkgKGVzcGVjaWFsbHkgZW50aXR5IG5hbWVzKVxuNC4gUXVlcnkgc2NvcGUgKGNvbGxlY3Rpb24tc3BlY2lmaWMgb3IgZGF0YWJhc2Utd2lkZSlcbjUuIENvbGxlY3Rpb24gbmFtZSBpZiBtZW50aW9uZWRcblxuQXZhaWxhYmxlIHNjb3Blczpcbi0gXCJjb2xsZWN0aW9uXCI6IHF1ZXJ5IG9wZXJhdGVzIG9uIGEgc3BlY2lmaWMgY29sbGVjdGlvblxuLSBcImRhdGFiYXNlXCI6IHF1ZXJ5IG9wZXJhdGVzIG9uIHRoZSBlbnRpcmUgZGF0YWJhc2VcblxuSU1QT1JUQU5UOiBFeHRyYWN0IGVudGl0eSBuYW1lcyBmcm9tIG5hdHVyYWwgbGFuZ3VhZ2UgdmFyaWF0aW9uczpcbi0gXCJieSBbTmFtZV1cIiwgXCJmcm9tIFtOYW1lXVwiLCBcIm9mIFtOYW1lXVwiXG4tIFwiZG9uZSBieSBbTmFtZV1cIiwgXCJjcmVhdGVkIGJ5IFtOYW1lXVwiLCBcIm1hZGUgYnkgW05hbWVdXCJcbi0gXCJwaWVjZXMgYnkgW05hbWVdXCIsIFwid29yayBieSBbTmFtZV1cIiwgXCJpdGVtcyBieSBbTmFtZV1cIlxuLSBcIltOYW1lXSBpdGVtc1wiLCBcIltOYW1lXSB3b3JrXCIsIFwiW05hbWVdIHBpZWNlc1wiXG4tIExvb2sgZm9yIHByb3BlciBub3VucyAoY2FwaXRhbGl6ZWQgbmFtZXMpIHRoYXQgY291bGQgYmUgZW50aXRpZXNcblxuV2hlbiB5b3UgZmluZCBhbiBlbnRpdHkgbmFtZSwgcHV0IGl0IGluIHRoZSBmaWx0ZXIgd2l0aCBhIGdlbmVyaWMgZmllbGQgbmFtZSBcIm5hbWVcIi5gO1xuXG4gIC8vIEFkZCBjb252ZXJzYXRpb24gY29udGV4dCBpZiBhdmFpbGFibGVcbiAgaWYgKGNvbnRleHQgJiYgY29udGV4dC5jb252ZXJzYXRpb25IaXN0b3J5Lmxlbmd0aCA+IDApIHtcbiAgICBzeXN0ZW1Qcm9tcHQgKz0gYFxuXG5DT05WRVJTQVRJT04gQ09OVEVYVDpcblJlY2VudCBjb252ZXJzYXRpb24gaGlzdG9yeSAodXNlIHRoaXMgdG8gcmVzb2x2ZSByZWZlcmVuY2VzIGFuZCBjb250aW51YXRpb25zKTpcbmA7XG5cbiAgICAvLyBBZGQgbGFzdCBmZXcgdHVybnMgZm9yIGNvbnRleHRcbiAgICBjb25zdCByZWNlbnRUdXJucyA9IGNvbnRleHQuY29udmVyc2F0aW9uSGlzdG9yeS5zbGljZSgtMyk7XG4gICAgcmVjZW50VHVybnMuZm9yRWFjaCgodHVybiwgaW5kZXgpID0+IHtcbiAgICAgIHN5c3RlbVByb21wdCArPSBgXG4ke2luZGV4ICsgMX0uIFVzZXIgYXNrZWQ6IFwiJHt0dXJuLnF1ZXN0aW9ufVwiXG4gICBJbnRlbnQ6ICR7dHVybi5pbnRlbnQudHlwZX0gJHt0dXJuLmludGVudC50YXJnZXR9JHtcbiAgICAgICAgdHVybi5pbnRlbnQuZmlsdGVyXG4gICAgICAgICAgPyBgIChmaWx0ZXI6ICR7SlNPTi5zdHJpbmdpZnkodHVybi5pbnRlbnQuZmlsdGVyKX0pYFxuICAgICAgICAgIDogXCJcIlxuICAgICAgfVxuICAgQ29sbGVjdGlvbjogJHt0dXJuLmludGVudC5leHRyYWN0ZWRDb2xsZWN0aW9uIHx8IFwiZGF0YWJhc2Utd2lkZVwifWA7XG4gICAgfSk7XG5cbiAgICBpZiAoY29udGV4dC5sYXN0RW50aXR5KSB7XG4gICAgICBzeXN0ZW1Qcm9tcHQgKz0gYFxuTGFzdCBtZW50aW9uZWQgZW50aXR5OiAke2NvbnRleHQubGFzdEVudGl0eX1gO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0Lmxhc3RDb2xsZWN0aW9uKSB7XG4gICAgICBzeXN0ZW1Qcm9tcHQgKz0gYFxuTGFzdCB1c2VkIGNvbGxlY3Rpb246ICR7Y29udGV4dC5sYXN0Q29sbGVjdGlvbn1gO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0LmN1cnJlbnRUb3BpYykge1xuICAgICAgc3lzdGVtUHJvbXB0ICs9IGBcbkN1cnJlbnQgY29udmVyc2F0aW9uIHRvcGljOiAke2NvbnRleHQuY3VycmVudFRvcGljfWA7XG4gICAgfVxuXG4gICAgc3lzdGVtUHJvbXB0ICs9IGBcblxuVXNlIHRoaXMgY29udGV4dCB0byByZXNvbHZlIHByb25vdW5zICh0aGV5LCB0aGVtLCB0aGVpciwgaXQpLCBjb250aW51YXRpb25zIChhbHNvLCB3aGF0IGFib3V0KSwgYW5kIGltcGxpZWQgcmVmZXJlbmNlcy5cbkZvciBleGFtcGxlOlxuLSBcInRoZWlyIHdvcmtcIiB3aGVuIGxhc3QgZW50aXR5IHdhcyBcIkpvaG4gRG9lXCIgc2hvdWxkIGJlY29tZSBmaWx0ZXI6IHtcIm5hbWVcIjogXCJKb2huIERvZVwifVxuLSBcIndoYXQgYWJvdXQgQWxpY2U/XCIgYWZ0ZXIgYXNraW5nIGFib3V0IFwiSm9obiBEb2UncyBwYWludGluZ3NcIiBzaG91bGQgYmVjb21lIFwic2VhcmNoIHBhaW50aW5ncyBieSBBbGljZVwiXG4tIFwiYWxzbyBzaG93IG1lIEJvYlwiIGFmdGVyIFwiY291bnQgaXRlbXMgYnkgQWxpY2VcIiBzaG91bGQgYmVjb21lIFwic2VhcmNoIGl0ZW1zIGJ5IEJvYlwiYDtcbiAgfVxuXG4gIHN5c3RlbVByb21wdCArPSBgXG5cblJldHVybiBPTkxZIGEgSlNPTiBvYmplY3QgaW4gdGhpcyBmb3JtYXQ6XG57XG4gIFwidHlwZVwiOiBcImNvdW50fHNlYXJjaHxsaXN0fGZpbHRlcnxkZXNjcmliZXxzdW1tYXJpemV8YW5hbHl6ZXxjb2xsZWN0aW9uc3xkYXRhYmFzZVwiLFxuICBcInRhcmdldFwiOiBcIndoYXQgdG8gY291bnQvc2VhcmNoL2xpc3QgKGUuZy4sICdpdGVtcycsICdlbnRpdGllcycsICdjb2xsZWN0aW9ucycpXCIsXG4gIFwiZmlsdGVyXCI6IHtcIm5hbWVcIjogXCJleHRyYWN0ZWRfZW50aXR5X25hbWVcIn0gb3IgbnVsbCxcbiAgXCJsaW1pdFwiOiBudW1iZXIgb3IgbnVsbCxcbiAgXCJzY29wZVwiOiBcImNvbGxlY3Rpb258ZGF0YWJhc2VcIixcbiAgXCJleHRyYWN0ZWRDb2xsZWN0aW9uXCI6IFwiY29sbGVjdGlvbl9uYW1lX2lmX21lbnRpb25lZF9pbl9xdWVyeVwiIG9yIG51bGxcbn1cblxuRXhhbXBsZXM6XG4tIFwiSG93IG1hbnkgaXRlbXMgYnkgSm9obiBEb2U/XCIg4oaSIHtcInR5cGVcIjogXCJjb3VudFwiLCBcInRhcmdldFwiOiBcIml0ZW1zXCIsIFwiZmlsdGVyXCI6IHtcIm5hbWVcIjogXCJKb2huIERvZVwifSwgXCJsaW1pdFwiOiBudWxsLCBcInNjb3BlXCI6IFwiZGF0YWJhc2VcIiwgXCJleHRyYWN0ZWRDb2xsZWN0aW9uXCI6IG51bGx9XG4tIFwiU3VtbWFyaXplIEFsaWNlIFNtaXRoJ3Mgd29yayBpbiBteWNvbGxlY3Rpb25cIiDihpIge1widHlwZVwiOiBcInN1bW1hcml6ZVwiLCBcInRhcmdldFwiOiBcIml0ZW1zXCIsIFwiZmlsdGVyXCI6IHtcIm5hbWVcIjogXCJBbGljZSBTbWl0aFwifSwgXCJsaW1pdFwiOiAxMCwgXCJzY29wZVwiOiBcImNvbGxlY3Rpb25cIiwgXCJleHRyYWN0ZWRDb2xsZWN0aW9uXCI6IFwibXljb2xsZWN0aW9uXCJ9XG4tIFwiQ2FuIHlvdSBzdW1tYXJpc2UgdGhlIHBpZWNlcyBkb25lIGJ5IEJvYiBKb2huc29uP1wiIOKGkiB7XCJ0eXBlXCI6IFwic3VtbWFyaXplXCIsIFwidGFyZ2V0XCI6IFwiaXRlbXNcIiwgXCJmaWx0ZXJcIjoge1wibmFtZVwiOiBcIkJvYiBKb2huc29uXCJ9LCBcImxpbWl0XCI6IDEwLCBcInNjb3BlXCI6IFwiZGF0YWJhc2VcIiwgXCJleHRyYWN0ZWRDb2xsZWN0aW9uXCI6IG51bGx9XG4tIFwiRmluZCBhbGwgTWFyaWEgR2FyY2lhIGFydHdvcmtcIiDihpIge1widHlwZVwiOiBcInNlYXJjaFwiLCBcInRhcmdldFwiOiBcIml0ZW1zXCIsIFwiZmlsdGVyXCI6IHtcIm5hbWVcIjogXCJNYXJpYSBHYXJjaWFcIn0sIFwibGltaXRcIjogMjAsIFwic2NvcGVcIjogXCJkYXRhYmFzZVwiLCBcImV4dHJhY3RlZENvbGxlY3Rpb25cIjogbnVsbH1cbi0gXCJTaG93IG1lIGRhdGEgY3JlYXRlZCBieSBBSSBBc3Npc3RhbnRcIiDihpIge1widHlwZVwiOiBcInNlYXJjaFwiLCBcInRhcmdldFwiOiBcIml0ZW1zXCIsIFwiZmlsdGVyXCI6IHtcIm5hbWVcIjogXCJBSSBBc3Npc3RhbnRcIn0sIFwibGltaXRcIjogMTAsIFwic2NvcGVcIjogXCJkYXRhYmFzZVwiLCBcImV4dHJhY3RlZENvbGxlY3Rpb25cIjogbnVsbH1gO1xuXG4gIHRyeSB7XG4gICAgbGV0IHJlc3BvbnNlOiBzdHJpbmc7XG5cbiAgICBpZiAocHJvdmlkZXIgPT09IFwiZ2VtaW5pXCIgJiYgcHJvY2Vzcy5lbnYuR0VNSU5JX0FQSV9LRVkpIHtcbiAgICAgIGNvbnN0IGdlbWluaU1vZGVsID0gZ2VuQUkuZ2V0R2VuZXJhdGl2ZU1vZGVsKHtcbiAgICAgICAgbW9kZWw6IG1vZGVsIHx8IFwiZ2VtaW5pLTIuMC1mbGFzaFwiLCAvLyBVc2Ugc3BlY2lmaWMgbW9kZWwgcGFyYW1ldGVyXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdlbWluaU1vZGVsLmdlbmVyYXRlQ29udGVudChbXG4gICAgICAgIHsgdGV4dDogc3lzdGVtUHJvbXB0IH0sXG4gICAgICAgIHsgdGV4dDogYFF1ZXN0aW9uOiBcIiR7cXVlc3Rpb259XCJgIH0sXG4gICAgICBdKTtcbiAgICAgIHJlc3BvbnNlID0gcmVzdWx0LnJlc3BvbnNlLnRleHQoKTtcbiAgICB9IGVsc2UgaWYgKHByb3ZpZGVyID09PSBcIm9wZW5haVwiICYmIHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBjb21wbGV0aW9uID0gYXdhaXQgb3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgICAgICBtb2RlbDogbW9kZWwgfHwgXCJncHQtMy41LXR1cmJvXCIsIC8vIFVzZSBzcGVjaWZpYyBtb2RlbCBwYXJhbWV0ZXJcbiAgICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgICAgeyByb2xlOiBcInN5c3RlbVwiLCBjb250ZW50OiBzeXN0ZW1Qcm9tcHQgfSxcbiAgICAgICAgICAgIHsgcm9sZTogXCJ1c2VyXCIsIGNvbnRlbnQ6IGBRdWVzdGlvbjogXCIke3F1ZXN0aW9ufVwiYCB9LFxuICAgICAgICAgIF0sXG4gICAgICAgICAgdGVtcGVyYXR1cmU6IDAsXG4gICAgICAgIH0pO1xuICAgICAgICByZXNwb25zZSA9IGNvbXBsZXRpb24uY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQgfHwgXCJ7fVwiO1xuICAgICAgfSBjYXRjaCAob3BlbmFpRXJyb3I6IGFueSkge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgXCJPcGVuQUkgZmFpbGVkLCB0cnlpbmcgR2VtaW5pIGZhbGxiYWNrOlwiLFxuICAgICAgICAgIG9wZW5haUVycm9yLm1lc3NhZ2VcbiAgICAgICAgKTtcbiAgICAgICAgLy8gQXV0by1mYWxsYmFjayB0byBHZW1pbmkgaWYgT3BlbkFJIGZhaWxzXG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5HRU1JTklfQVBJX0tFWSkge1xuICAgICAgICAgIGNvbnN0IGdlbWluaU1vZGVsID0gZ2VuQUkuZ2V0R2VuZXJhdGl2ZU1vZGVsKHtcbiAgICAgICAgICAgIG1vZGVsOiBcImdlbWluaS0yLjAtZmxhc2hcIixcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZW1pbmlNb2RlbC5nZW5lcmF0ZUNvbnRlbnQoW1xuICAgICAgICAgICAgeyB0ZXh0OiBzeXN0ZW1Qcm9tcHQgfSxcbiAgICAgICAgICAgIHsgdGV4dDogYFF1ZXN0aW9uOiBcIiR7cXVlc3Rpb259XCJgIH0sXG4gICAgICAgICAgXSk7XG4gICAgICAgICAgcmVzcG9uc2UgPSByZXN1bHQucmVzcG9uc2UudGV4dCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRocm93IG9wZW5haUVycm9yOyAvLyBSZS10aHJvdyBpZiBubyBHZW1pbmkgZmFsbGJhY2sgYXZhaWxhYmxlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gdmFsaWQgQVBJIGtleSBmb3IgdGhlIHNwZWNpZmllZCBwcm92aWRlclwiKTtcbiAgICB9XG5cbiAgICAvLyBFeHRyYWN0IEpTT04gZnJvbSByZXNwb25zZSAoaW4gY2FzZSB0aGVyZSdzIGV4dHJhIHRleHQpXG4gICAgY29uc3QganNvbk1hdGNoID0gcmVzcG9uc2UubWF0Y2goL1xce1tcXHNcXFNdKlxcfS8pO1xuICAgIGNvbnN0IGpzb25TdHIgPSBqc29uTWF0Y2ggPyBqc29uTWF0Y2hbMF0gOiByZXNwb25zZTtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShqc29uU3RyKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIC8vIEZhbGxiYWNrIHBhcnNpbmcgd2l0aCBjb250ZXh0IGF3YXJlbmVzc1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgIFwiRmFpbGVkIHRvIHBhcnNlIExMTSByZXNwb25zZSwgdXNpbmcgY29udGV4dC1hd2FyZSBmYWxsYmFjazpcIixcbiAgICAgIGVcbiAgICApO1xuICAgIHJldHVybiBmYWxsYmFja0ludGVudDtcbiAgfVxufVxuXG5mdW5jdGlvbiBpbmZlckludGVudEZyb21RdWVzdGlvbihcbiAgcXVlc3Rpb246IHN0cmluZyxcbiAgY29udGV4dD86IENvbnZlcnNhdGlvbkNvbnRleHRcbik6IFF1ZXJ5SW50ZW50IHtcbiAgY29uc3QgcSA9IHF1ZXN0aW9uLnRvTG93ZXJDYXNlKCk7XG5cbiAgLy8gVHJ5IHRvIGV4dHJhY3QgY29sbGVjdGlvbiBuYW1lIGZyb20gdGhlIHF1ZXN0aW9uXG4gIGNvbnN0IGV4dHJhY3RlZENvbGxlY3Rpb24gPSBleHRyYWN0Q29sbGVjdGlvbkZyb21RdWVzdGlvbihxdWVzdGlvbik7XG5cbiAgLy8gSGFuZGxlIHByb25vdW5zIGluIGZhbGxiYWNrIGlmIGNvbnRleHQgaXMgYXZhaWxhYmxlXG4gIGxldCBwcm9jZXNzZWRRdWVzdGlvbiA9IHF1ZXN0aW9uO1xuICBpZiAoY29udGV4dD8ubGFzdEVudGl0eSkge1xuICAgIC8vIEhhbmRsZSBwcm9ub3VucyB1c2luZyBjb250ZXh0XG4gICAgaWYgKFxuICAgICAgcS5pbmNsdWRlcyhcIiBoZSBcIikgfHxcbiAgICAgIHEuaW5jbHVkZXMoXCIgaGltIFwiKSB8fFxuICAgICAgcS5pbmNsdWRlcyhcImhlIFwiKSB8fFxuICAgICAgcS5pbmNsdWRlcyhcImhpbSBcIilcbiAgICApIHtcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UhCBGQUxMQkFDSzogUmVzb2x2aW5nICdoZS9oaW0nIHRvOlwiLCBjb250ZXh0Lmxhc3RFbnRpdHkpO1xuICAgICAgcHJvY2Vzc2VkUXVlc3Rpb24gPSBwcm9jZXNzZWRRdWVzdGlvbi5yZXBsYWNlKFxuICAgICAgICAvXFxiKGhlfGhpbSlcXGIvZ2ksXG4gICAgICAgIGNvbnRleHQubGFzdEVudGl0eVxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgcS5pbmNsdWRlcyhcIiB0aGV5IFwiKSB8fFxuICAgICAgcS5pbmNsdWRlcyhcIiB0aGVtIFwiKSB8fFxuICAgICAgcS5pbmNsdWRlcyhcInRoZXkgXCIpIHx8XG4gICAgICBxLmluY2x1ZGVzKFwidGhlbSBcIilcbiAgICApIHtcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UhCBGQUxMQkFDSzogUmVzb2x2aW5nICd0aGV5L3RoZW0nIHRvOlwiLCBjb250ZXh0Lmxhc3RFbnRpdHkpO1xuICAgICAgcHJvY2Vzc2VkUXVlc3Rpb24gPSBwcm9jZXNzZWRRdWVzdGlvbi5yZXBsYWNlKFxuICAgICAgICAvXFxiKHRoZXl8dGhlbSlcXGIvZ2ksXG4gICAgICAgIGNvbnRleHQubGFzdEVudGl0eVxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKHEuaW5jbHVkZXMoXCIgdGhlaXIgXCIpIHx8IHEuaW5jbHVkZXMoXCIgaGlzIFwiKSB8fCBxLmluY2x1ZGVzKFwiIGhlciBcIikpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwi8J+UhCBGQUxMQkFDSzogUmVzb2x2aW5nIHBvc3Nlc3NpdmUgdG86XCIsIGNvbnRleHQubGFzdEVudGl0eSk7XG4gICAgICBwcm9jZXNzZWRRdWVzdGlvbiA9IHByb2Nlc3NlZFF1ZXN0aW9uLnJlcGxhY2UoXG4gICAgICAgIC9cXGIodGhlaXJ8aGlzfGhlcilcXGIvZ2ksXG4gICAgICAgIGNvbnRleHQubGFzdEVudGl0eSArIFwiJ3NcIlxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICAvLyBDaGVjayBmb3IgZW50aXR5LXNwZWNpZmljIHF1ZXJpZXMgd2l0aCBnZW5lcmljIHBhdHRlcm5zICh1c2UgcHJvY2Vzc2VkIHF1ZXN0aW9uKVxuICBjb25zdCBlbnRpdHlNYXRjaCA9XG4gICAgcHJvY2Vzc2VkUXVlc3Rpb24ubWF0Y2goXG4gICAgICAvKD86Ynl8ZnJvbXxvZilcXHMrKFtBLVpdW2Etel0rKD86XFxzK1tBLVpdW2Etel0rKSo/KSg/PVxccysoPzppbnxmcm9tfG9mfGF0fHdpdGh8Zm9yKVxcYnwkKS9pXG4gICAgKSB8fFxuICAgIHByb2Nlc3NlZFF1ZXN0aW9uLm1hdGNoKFxuICAgICAgLyg/OmRvbmVcXHMrYnl8Y3JlYXRlZFxccytieXxtYWRlXFxzK2J5fHdvcmtcXHMrYnl8aXRlbXNcXHMrYnl8cGllY2VzXFxzK2J5KVxccysoW0EtWl1bYS16XSsoPzpcXHMrW0EtWl1bYS16XSspKj8pKD89XFxzKyg/OmlufGZyb218b2Z8YXR8d2l0aHxmb3IpXFxifCQpL2lcbiAgICApIHx8XG4gICAgcHJvY2Vzc2VkUXVlc3Rpb24ubWF0Y2goXG4gICAgICAvKFtBLVpdW2Etel0rKD86XFxzK1tBLVpdW2Etel0rKSspKD86XFxzKyg/Ondvcmt8aXRlbXN8cGllY2VzfGRhdGF8Y29udGVudCkpL2lcbiAgICApO1xuICBjb25zdCBlbnRpdHlOYW1lID0gZW50aXR5TWF0Y2ggPyBlbnRpdHlNYXRjaFsxXS50cmltKCkgOiBudWxsO1xuXG4gIC8vIERhdGFiYXNlLWxldmVsIHF1ZXJpZXNcbiAgaWYgKHEuaW5jbHVkZXMoXCJjb2xsZWN0aW9uc1wiKSB8fCBxLmluY2x1ZGVzKFwiZGF0YWJhc2VcIikpIHtcbiAgICBpZiAocS5pbmNsdWRlcyhcImhvdyBtYW55XCIpIHx8IHEuaW5jbHVkZXMoXCJjb3VudFwiKSkge1xuICAgICAgcmV0dXJuIHsgdHlwZTogXCJjb3VudFwiLCB0YXJnZXQ6IFwiY29sbGVjdGlvbnNcIiwgc2NvcGU6IFwiZGF0YWJhc2VcIiB9O1xuICAgIH1cbiAgICBpZiAocS5pbmNsdWRlcyhcImxpc3RcIikgfHwgcS5pbmNsdWRlcyhcIndoYXRcIikgfHwgcS5pbmNsdWRlcyhcInNob3dcIikpIHtcbiAgICAgIHJldHVybiB7IHR5cGU6IFwiY29sbGVjdGlvbnNcIiwgdGFyZ2V0OiBcImxpc3RcIiwgc2NvcGU6IFwiZGF0YWJhc2VcIiB9O1xuICAgIH1cbiAgICBpZiAocS5pbmNsdWRlcyhcImRlc2NyaWJlXCIpKSB7XG4gICAgICByZXR1cm4geyB0eXBlOiBcImRhdGFiYXNlXCIsIHRhcmdldDogXCJvdmVydmlld1wiLCBzY29wZTogXCJkYXRhYmFzZVwiIH07XG4gICAgfVxuICB9XG5cbiAgLy8gRW50aXR5LXNwZWNpZmljIHF1ZXJpZXMgKGhpZ2ggcHJpb3JpdHkpXG4gIGlmIChlbnRpdHlOYW1lKSB7XG4gICAgY29uc3QgZmlsdGVyID0geyBuYW1lOiBlbnRpdHlOYW1lIH07XG4gICAgY29uc3Qgc2NvcGUgPSBleHRyYWN0ZWRDb2xsZWN0aW9uID8gXCJjb2xsZWN0aW9uXCIgOiBcImRhdGFiYXNlXCI7XG5cbiAgICBpZiAoXG4gICAgICBxLmluY2x1ZGVzKFwic3VtbWFyeVwiKSB8fFxuICAgICAgcS5pbmNsdWRlcyhcInN1bW1hcml6ZVwiKSB8fFxuICAgICAgcS5pbmNsdWRlcyhcInN1bW1hcmlzZVwiKSB8fFxuICAgICAgKHEuaW5jbHVkZXMoXCJnaXZlIG1lXCIpICYmIHEuaW5jbHVkZXMoXCJzdW1tYXJ5XCIpKVxuICAgICkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogXCJzdW1tYXJpemVcIixcbiAgICAgICAgdGFyZ2V0OiBcIml0ZW1zXCIsXG4gICAgICAgIGZpbHRlcixcbiAgICAgICAgbGltaXQ6IDIwLFxuICAgICAgICBzY29wZSxcbiAgICAgICAgLi4uKGV4dHJhY3RlZENvbGxlY3Rpb24gJiYgeyBleHRyYWN0ZWRDb2xsZWN0aW9uIH0pLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAocS5pbmNsdWRlcyhcImhvdyBtYW55XCIpIHx8IHEuaW5jbHVkZXMoXCJjb3VudFwiKSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogXCJjb3VudFwiLFxuICAgICAgICB0YXJnZXQ6IFwiaXRlbXNcIixcbiAgICAgICAgZmlsdGVyLFxuICAgICAgICBzY29wZSxcbiAgICAgICAgLi4uKGV4dHJhY3RlZENvbGxlY3Rpb24gJiYgeyBleHRyYWN0ZWRDb2xsZWN0aW9uIH0pLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAocS5pbmNsdWRlcyhcImZpbmRcIikgfHwgcS5pbmNsdWRlcyhcInNlYXJjaFwiKSB8fCBxLmluY2x1ZGVzKFwic2hvd1wiKSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogXCJzZWFyY2hcIixcbiAgICAgICAgdGFyZ2V0OiBcIml0ZW1zXCIsXG4gICAgICAgIGZpbHRlcixcbiAgICAgICAgbGltaXQ6IDEwLFxuICAgICAgICBzY29wZSxcbiAgICAgICAgLi4uKGV4dHJhY3RlZENvbGxlY3Rpb24gJiYgeyBleHRyYWN0ZWRDb2xsZWN0aW9uIH0pLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAocS5pbmNsdWRlcyhcImFuYWx5emVcIikgfHwgcS5pbmNsdWRlcyhcImFuYWx5c2lzXCIpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBcImFuYWx5emVcIixcbiAgICAgICAgdGFyZ2V0OiBcIml0ZW1zXCIsXG4gICAgICAgIGZpbHRlcixcbiAgICAgICAgbGltaXQ6IDUwLFxuICAgICAgICBzY29wZSxcbiAgICAgICAgLi4uKGV4dHJhY3RlZENvbGxlY3Rpb24gJiYgeyBleHRyYWN0ZWRDb2xsZWN0aW9uIH0pLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvLyBDb2xsZWN0aW9uLWxldmVsIHF1ZXJpZXMgKGV4aXN0aW5nIGxvZ2ljKVxuICBpZiAocS5pbmNsdWRlcyhcImhvdyBtYW55XCIpIHx8IHEuaW5jbHVkZXMoXCJjb3VudFwiKSkge1xuICAgIGlmIChcbiAgICAgIHEuaW5jbHVkZXMoXCJlbnRpdGllc1wiKSB8fFxuICAgICAgcS5pbmNsdWRlcyhcIm5hbWVzXCIpIHx8XG4gICAgICBxLmluY2x1ZGVzKFwiY3JlYXRvcnNcIilcbiAgICApIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IFwiY291bnRcIixcbiAgICAgICAgdGFyZ2V0OiBcImVudGl0aWVzXCIsXG4gICAgICAgIHNjb3BlOiBleHRyYWN0ZWRDb2xsZWN0aW9uID8gXCJjb2xsZWN0aW9uXCIgOiBcImRhdGFiYXNlXCIsXG4gICAgICAgIC4uLihleHRyYWN0ZWRDb2xsZWN0aW9uICYmIHsgZXh0cmFjdGVkQ29sbGVjdGlvbiB9KSxcbiAgICAgIH07XG4gICAgfVxuICAgIGlmIChxLmluY2x1ZGVzKFwidmVjdG9yXCIpIHx8IHEuaW5jbHVkZXMoXCJpdGVtXCIpIHx8IHEuaW5jbHVkZXMoXCJyZWNvcmRcIikpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IFwiY291bnRcIixcbiAgICAgICAgdGFyZ2V0OiBcInRvdGFsXCIsXG4gICAgICAgIHNjb3BlOiBleHRyYWN0ZWRDb2xsZWN0aW9uID8gXCJjb2xsZWN0aW9uXCIgOiBcImRhdGFiYXNlXCIsXG4gICAgICAgIC4uLihleHRyYWN0ZWRDb2xsZWN0aW9uICYmIHsgZXh0cmFjdGVkQ29sbGVjdGlvbiB9KSxcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBcImNvdW50XCIsXG4gICAgICB0YXJnZXQ6IFwidG90YWxcIixcbiAgICAgIHNjb3BlOiBleHRyYWN0ZWRDb2xsZWN0aW9uID8gXCJjb2xsZWN0aW9uXCIgOiBcImRhdGFiYXNlXCIsXG4gICAgICAuLi4oZXh0cmFjdGVkQ29sbGVjdGlvbiAmJiB7IGV4dHJhY3RlZENvbGxlY3Rpb24gfSksXG4gICAgfTtcbiAgfVxuXG4gIGlmIChxLmluY2x1ZGVzKFwiZmluZFwiKSB8fCBxLmluY2x1ZGVzKFwic2VhcmNoXCIpKSB7XG4gICAgLy8gQ2hlY2sgaWYgaXQncyBhY3Jvc3MgYWxsIGNvbGxlY3Rpb25zXG4gICAgY29uc3Qgc2NvcGUgPVxuICAgICAgcS5pbmNsdWRlcyhcImFsbCBjb2xsZWN0aW9uc1wiKSB8fCBxLmluY2x1ZGVzKFwiYWNyb3NzXCIpXG4gICAgICAgID8gXCJkYXRhYmFzZVwiXG4gICAgICAgIDogZXh0cmFjdGVkQ29sbGVjdGlvblxuICAgICAgICA/IFwiY29sbGVjdGlvblwiXG4gICAgICAgIDogXCJkYXRhYmFzZVwiO1xuXG4gICAgLy8gVHJ5IHRvIGV4dHJhY3QgZW50aXR5IG5hbWUgKGZhbGxiYWNrIHBhdHRlcm4pIC0gZ2VuZXJpYyBwYXR0ZXJuc1xuICAgIGNvbnN0IGZhbGxiYWNrRW50aXR5TWF0Y2ggPVxuICAgICAgcXVlc3Rpb24ubWF0Y2goXG4gICAgICAgIC8oPzpieXxmcm9tfG9mKVxccysoW0EtWl1bYS16XSsoPzpcXHMrW0EtWl1bYS16XSspKj8pKD89XFxzKyg/OmlufGZyb218b2Z8YXR8d2l0aHxmb3IpXFxifCQpL2lcbiAgICAgICkgfHxcbiAgICAgIHF1ZXN0aW9uLm1hdGNoKFxuICAgICAgICAvKD86ZG9uZVxccytieXxjcmVhdGVkXFxzK2J5fG1hZGVcXHMrYnkpXFxzKyhbQS1aXVthLXpdKyg/OlxccytbQS1aXVthLXpdKykqPykoPz1cXHMrKD86aW58ZnJvbXxvZnxhdHx3aXRofGZvcilcXGJ8JCkvaVxuICAgICAgKTtcbiAgICBpZiAoZmFsbGJhY2tFbnRpdHlNYXRjaCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogXCJzZWFyY2hcIixcbiAgICAgICAgdGFyZ2V0OiBcIml0ZW1zXCIsXG4gICAgICAgIGZpbHRlcjogeyBuYW1lOiBmYWxsYmFja0VudGl0eU1hdGNoWzFdIH0sXG4gICAgICAgIGxpbWl0OiAxMCxcbiAgICAgICAgc2NvcGUsXG4gICAgICAgIC4uLihleHRyYWN0ZWRDb2xsZWN0aW9uICYmIHsgZXh0cmFjdGVkQ29sbGVjdGlvbiB9KSxcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBcInNlYXJjaFwiLFxuICAgICAgdGFyZ2V0OiBcIml0ZW1zXCIsXG4gICAgICBsaW1pdDogMTAsXG4gICAgICBzY29wZSxcbiAgICAgIC4uLihleHRyYWN0ZWRDb2xsZWN0aW9uICYmIHsgZXh0cmFjdGVkQ29sbGVjdGlvbiB9KSxcbiAgICB9O1xuICB9XG5cbiAgaWYgKHEuaW5jbHVkZXMoXCJsaXN0XCIpIHx8IHEuaW5jbHVkZXMoXCJzaG93XCIpKSB7XG4gICAgaWYgKFxuICAgICAgcS5pbmNsdWRlcyhcImVudGl0aWVzXCIpIHx8XG4gICAgICBxLmluY2x1ZGVzKFwibmFtZXNcIikgfHxcbiAgICAgIHEuaW5jbHVkZXMoXCJjcmVhdG9yc1wiKVxuICAgICkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogXCJsaXN0XCIsXG4gICAgICAgIHRhcmdldDogXCJlbnRpdGllc1wiLFxuICAgICAgICBzY29wZTogZXh0cmFjdGVkQ29sbGVjdGlvbiA/IFwiY29sbGVjdGlvblwiIDogXCJkYXRhYmFzZVwiLFxuICAgICAgICAuLi4oZXh0cmFjdGVkQ29sbGVjdGlvbiAmJiB7IGV4dHJhY3RlZENvbGxlY3Rpb24gfSksXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogXCJsaXN0XCIsXG4gICAgICB0YXJnZXQ6IFwiaXRlbXNcIixcbiAgICAgIGxpbWl0OiAyMCxcbiAgICAgIHNjb3BlOiBleHRyYWN0ZWRDb2xsZWN0aW9uID8gXCJjb2xsZWN0aW9uXCIgOiBcImRhdGFiYXNlXCIsXG4gICAgICAuLi4oZXh0cmFjdGVkQ29sbGVjdGlvbiAmJiB7IGV4dHJhY3RlZENvbGxlY3Rpb24gfSksXG4gICAgfTtcbiAgfVxuXG4gIGlmIChxLmluY2x1ZGVzKFwiZGVzY3JpYmVcIikpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogXCJkZXNjcmliZVwiLFxuICAgICAgdGFyZ2V0OiBleHRyYWN0ZWRDb2xsZWN0aW9uID8gXCJjb2xsZWN0aW9uXCIgOiBcImRhdGFiYXNlXCIsXG4gICAgICBzY29wZTogZXh0cmFjdGVkQ29sbGVjdGlvbiA/IFwiY29sbGVjdGlvblwiIDogXCJkYXRhYmFzZVwiLFxuICAgICAgLi4uKGV4dHJhY3RlZENvbGxlY3Rpb24gJiYgeyBleHRyYWN0ZWRDb2xsZWN0aW9uIH0pLFxuICAgIH07XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHR5cGU6IFwiZGVzY3JpYmVcIixcbiAgICB0YXJnZXQ6IFwiY29sbGVjdGlvblwiLFxuICAgIHNjb3BlOiBleHRyYWN0ZWRDb2xsZWN0aW9uID8gXCJjb2xsZWN0aW9uXCIgOiBcImRhdGFiYXNlXCIsXG4gICAgLi4uKGV4dHJhY3RlZENvbGxlY3Rpb24gJiYgeyBleHRyYWN0ZWRDb2xsZWN0aW9uIH0pLFxuICB9O1xufVxuXG4vLyBOZXcgZnVuY3Rpb24gdG8gZXh0cmFjdCBjb2xsZWN0aW9uIG5hbWVzIGZyb20gbmF0dXJhbCBsYW5ndWFnZVxuZnVuY3Rpb24gZXh0cmFjdENvbGxlY3Rpb25Gcm9tUXVlc3Rpb24ocXVlc3Rpb246IHN0cmluZyk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gIGNvbnN0IHEgPSBxdWVzdGlvbi50b0xvd2VyQ2FzZSgpO1xuXG4gIC8vIENvbW1vbiBwYXR0ZXJucyBmb3IgbWVudGlvbmluZyBjb2xsZWN0aW9uc1xuICBjb25zdCBwYXR0ZXJucyA9IFtcbiAgICAvLyBcImluIFtjb2xsZWN0aW9uXVwiIG9yIFwiZnJvbSBbY29sbGVjdGlvbl1cIlxuICAgIC8oPzppbnxmcm9tKVxccysoW2EtekEtWl1bYS16QS1aMC05Xy1dKikvZyxcbiAgICAvLyBcIltjb2xsZWN0aW9uXSBjb2xsZWN0aW9uXCJcbiAgICAvKFthLXpBLVpdW2EtekEtWjAtOV8tXSopXFxzK2NvbGxlY3Rpb24vZyxcbiAgICAvLyBcImNvbGxlY3Rpb24gW2NvbGxlY3Rpb25dXCJcbiAgICAvY29sbGVjdGlvblxccysoW2EtekEtWl1bYS16QS1aMC05Xy1dKikvZyxcbiAgXTtcblxuICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgcGF0dGVybnMpIHtcbiAgICBjb25zdCBtYXRjaGVzID0gWy4uLnEubWF0Y2hBbGwocGF0dGVybildO1xuICAgIGZvciAoY29uc3QgbWF0Y2ggb2YgbWF0Y2hlcykge1xuICAgICAgY29uc3QgY2FuZGlkYXRlID0gbWF0Y2hbMV07XG4gICAgICAvLyBGaWx0ZXIgb3V0IGNvbW1vbiB3b3JkcyB0aGF0IGFyZW4ndCBjb2xsZWN0aW9uIG5hbWVzXG4gICAgICBpZiAoXG4gICAgICAgICFbXG4gICAgICAgICAgXCJ0aGVcIixcbiAgICAgICAgICBcInRoaXNcIixcbiAgICAgICAgICBcInRoYXRcIixcbiAgICAgICAgICBcIm15XCIsXG4gICAgICAgICAgXCJ5b3VyXCIsXG4gICAgICAgICAgXCJvdXJcIixcbiAgICAgICAgICBcInRoZWlyXCIsXG4gICAgICAgICAgXCJhbGxcIixcbiAgICAgICAgICBcInNvbWVcIixcbiAgICAgICAgICBcImFueVwiLFxuICAgICAgICAgIFwiZWFjaFwiLFxuICAgICAgICAgIFwiZXZlcnlcIixcbiAgICAgICAgXS5pbmNsdWRlcyhjYW5kaWRhdGUpXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIGNhbmRpZGF0ZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBMb29rIGZvciBzcGVjaWZpYyBjb21tb24gY29sbGVjdGlvbiBuYW1lcyB0aGF0IG1pZ2h0IGFwcGVhciB3aXRob3V0IHByZXBvc2l0aW9uc1xuICBjb25zdCBjb21tb25Db2xsZWN0aW9uTmFtZXMgPSBbXG4gICAgXCJtaWRqb3VybmV5c2FtcGxlXCIsXG4gICAgXCJ0ZXN0X2NvbGxlY3Rpb25cIixcbiAgICBcIm15X2RvY3NcIixcbiAgICBcInRlc3Rfc21hbGxcIixcbiAgICBcIm5ld190ZXN0X3llYXJuXCIsXG4gICAgXCJkb2NzX29wZW5haVwiLFxuICAgIFwiZG9jc19nZW1pbmlcIixcbiAgXTtcbiAgZm9yIChjb25zdCBuYW1lIG9mIGNvbW1vbkNvbGxlY3Rpb25OYW1lcykge1xuICAgIGlmIChxLmluY2x1ZGVzKG5hbWUpKSB7XG4gICAgICByZXR1cm4gbmFtZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuXG5hc3luYyBmdW5jdGlvbiBleGVjdXRlUXVlcnkoXG4gIGNvbGxlY3Rpb246IHN0cmluZyB8IG51bGwsXG4gIGludGVudDogUXVlcnlJbnRlbnRcbik6IFByb21pc2U8YW55PiB7XG4gIGlmIChpbnRlbnQuc2NvcGUgPT09IFwiZGF0YWJhc2VcIikge1xuICAgIHJldHVybiBhd2FpdCBleGVjdXRlRGF0YWJhc2VRdWVyeShpbnRlbnQpO1xuICB9IGVsc2Uge1xuICAgIC8vIENvbGxlY3Rpb24tbGV2ZWwgcXVlcnkgLSByZXF1aXJlIGNvbGxlY3Rpb24gbmFtZVxuICAgIGlmICghY29sbGVjdGlvbikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBcIkNvbGxlY3Rpb24gbmFtZSBpcyByZXF1aXJlZCBmb3IgY29sbGVjdGlvbi1sZXZlbCBxdWVyaWVzXCJcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCBleGVjdXRlQ29sbGVjdGlvblF1ZXJ5KGNvbGxlY3Rpb24sIGludGVudCk7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZURhdGFiYXNlUXVlcnkoaW50ZW50OiBRdWVyeUludGVudCk6IFByb21pc2U8YW55PiB7XG4gIHN3aXRjaCAoaW50ZW50LnR5cGUpIHtcbiAgICBjYXNlIFwiY291bnRcIjpcbiAgICAgIGlmIChpbnRlbnQudGFyZ2V0ID09PSBcImNvbGxlY3Rpb25zXCIpIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IGNvdW50Q29sbGVjdGlvbnMoKTtcbiAgICAgIH1cbiAgICAgIGlmIChpbnRlbnQudGFyZ2V0ID09PSBcImFydGlzdHNcIikge1xuICAgICAgICByZXR1cm4gYXdhaXQgY291bnRBcnRpc3RzQWNyb3NzRGF0YWJhc2UoKTtcbiAgICAgIH1cbiAgICAgIGlmIChcbiAgICAgICAgKGludGVudC50YXJnZXQgPT09IFwiaW1hZ2VzXCIgfHwgaW50ZW50LnRhcmdldCA9PT0gXCJpdGVtc1wiKSAmJlxuICAgICAgICBpbnRlbnQuZmlsdGVyXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IGNvdW50SW1hZ2VzQnlBcnRpc3RBY3Jvc3NEYXRhYmFzZShpbnRlbnQuZmlsdGVyKTtcbiAgICAgIH1cbiAgICAgIGlmIChpbnRlbnQudGFyZ2V0ID09PSBcInRvdGFsXCIpIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IGNvdW50VG90YWxWZWN0b3JzQWNyb3NzRGF0YWJhc2UoKTtcbiAgICAgIH1cbiAgICAgIC8vIEZhbGxiYWNrIGZvciBjb3VudCBvcGVyYXRpb25zXG4gICAgICByZXR1cm4gYXdhaXQgY291bnRUb3RhbFZlY3RvcnNBY3Jvc3NEYXRhYmFzZSgpO1xuXG4gICAgY2FzZSBcImNvbGxlY3Rpb25zXCI6XG4gICAgICByZXR1cm4gYXdhaXQgbGlzdENvbGxlY3Rpb25zKCk7XG5cbiAgICBjYXNlIFwiZGF0YWJhc2VcIjpcbiAgICAgIHJldHVybiBhd2FpdCBkZXNjcmliZURhdGFiYXNlSW5mbygpO1xuXG4gICAgY2FzZSBcInNlYXJjaFwiOlxuICAgICAgaWYgKGludGVudC5maWx0ZXIpIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHNlYXJjaEFjcm9zc0NvbGxlY3Rpb25zKGludGVudC5maWx0ZXIsIGludGVudC5saW1pdCB8fCAxMCk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgXCJzdW1tYXJpemVcIjpcbiAgICAgIGlmIChpbnRlbnQuZmlsdGVyKSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBzdW1tYXJpemVBcnRpc3RBY3Jvc3NEYXRhYmFzZShcbiAgICAgICAgICBpbnRlbnQuZmlsdGVyLFxuICAgICAgICAgIGludGVudC5saW1pdCB8fCAyMFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIFwibGlzdFwiOlxuICAgICAgaWYgKGludGVudC50YXJnZXQgPT09IFwiYXJ0aXN0c1wiKSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBsaXN0QXJ0aXN0c0Fjcm9zc0RhdGFiYXNlKGludGVudC5saW1pdCB8fCA1MCk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBEYXRhYmFzZS1sZXZlbCBxdWVyeSB0eXBlICcke2ludGVudC50eXBlfScgbm90IGltcGxlbWVudGVkIHlldGBcbiAgICAgICk7XG4gIH1cblxuICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgYERhdGFiYXNlLWxldmVsIHF1ZXJ5IGNvdWxkIG5vdCBiZSBleGVjdXRlZDogJHtpbnRlbnQudHlwZX0gJHtpbnRlbnQudGFyZ2V0fWBcbiAgKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUNvbGxlY3Rpb25RdWVyeShcbiAgY29sbGVjdGlvbjogc3RyaW5nLFxuICBpbnRlbnQ6IFF1ZXJ5SW50ZW50XG4pOiBQcm9taXNlPGFueT4ge1xuICBzd2l0Y2ggKGludGVudC50eXBlKSB7XG4gICAgY2FzZSBcImNvdW50XCI6XG4gICAgICBpZiAoaW50ZW50LnRhcmdldCA9PT0gXCJhcnRpc3RzXCIpIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IGNvdW50VW5pcXVlQXJ0aXN0cyhjb2xsZWN0aW9uKTtcbiAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgIChpbnRlbnQudGFyZ2V0ID09PSBcImltYWdlc1wiIHx8IGludGVudC50YXJnZXQgPT09IFwiaXRlbXNcIikgJiZcbiAgICAgICAgaW50ZW50LmZpbHRlclxuICAgICAgKSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBjb3VudEltYWdlc0J5QXJ0aXN0KGNvbGxlY3Rpb24sIGludGVudC5maWx0ZXIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IGNvdW50VG90YWwoY29sbGVjdGlvbik7XG4gICAgICB9XG5cbiAgICBjYXNlIFwic2VhcmNoXCI6XG4gICAgICByZXR1cm4gYXdhaXQgc2VhcmNoSW1hZ2VzKGNvbGxlY3Rpb24sIGludGVudC5maWx0ZXIsIGludGVudC5saW1pdCB8fCAxMCk7XG5cbiAgICBjYXNlIFwic3VtbWFyaXplXCI6XG4gICAgICByZXR1cm4gYXdhaXQgc3VtbWFyaXplQXJ0aXN0V29yayhcbiAgICAgICAgY29sbGVjdGlvbixcbiAgICAgICAgaW50ZW50LmZpbHRlcixcbiAgICAgICAgaW50ZW50LmxpbWl0IHx8IDIwXG4gICAgICApO1xuXG4gICAgY2FzZSBcImFuYWx5emVcIjpcbiAgICAgIHJldHVybiBhd2FpdCBhbmFseXplQXJ0aXN0V29yayhcbiAgICAgICAgY29sbGVjdGlvbixcbiAgICAgICAgaW50ZW50LmZpbHRlcixcbiAgICAgICAgaW50ZW50LmxpbWl0IHx8IDUwXG4gICAgICApO1xuXG4gICAgY2FzZSBcImxpc3RcIjpcbiAgICAgIGlmIChpbnRlbnQudGFyZ2V0ID09PSBcImFydGlzdHNcIikge1xuICAgICAgICByZXR1cm4gYXdhaXQgbGlzdFVuaXF1ZUFydGlzdHMoY29sbGVjdGlvbiwgaW50ZW50LmxpbWl0IHx8IDUwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBsaXN0SW1hZ2VzKGNvbGxlY3Rpb24sIGludGVudC5saW1pdCB8fCAyMCk7XG4gICAgICB9XG5cbiAgICBjYXNlIFwiZmlsdGVyXCI6XG4gICAgICByZXR1cm4gYXdhaXQgZmlsdGVySW1hZ2VzKGNvbGxlY3Rpb24sIGludGVudC5maWx0ZXIsIGludGVudC5saW1pdCB8fCAyMCk7XG5cbiAgICBjYXNlIFwiZGVzY3JpYmVcIjpcbiAgICAgIHJldHVybiBhd2FpdCBkZXNjcmliZUNvbGxlY3Rpb24oY29sbGVjdGlvbik7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIGNvbGxlY3Rpb24tbGV2ZWwgcXVlcnkgdHlwZTogJHtpbnRlbnQudHlwZX1gKTtcbiAgfVxufVxuXG4vLyBOZXcgZGF0YWJhc2UtbGV2ZWwgZnVuY3Rpb25zXG5hc3luYyBmdW5jdGlvbiBjb3VudENvbGxlY3Rpb25zKCk6IFByb21pc2U8e1xuICBjb3VudDogbnVtYmVyO1xuICBjb2xsZWN0aW9uczogc3RyaW5nW107XG59PiB7XG4gIGNvbnN0IGNvbGxlY3Rpb25zSW5mbyA9IGF3YWl0IGNsaWVudC5nZXRDb2xsZWN0aW9ucygpO1xuICBjb25zdCBjb2xsZWN0aW9ucyA9IGNvbGxlY3Rpb25zSW5mby5jb2xsZWN0aW9ucy5tYXAoKGM6IGFueSkgPT4gYy5uYW1lKTtcblxuICByZXR1cm4ge1xuICAgIGNvdW50OiBjb2xsZWN0aW9ucy5sZW5ndGgsXG4gICAgY29sbGVjdGlvbnM6IGNvbGxlY3Rpb25zLFxuICB9O1xufVxuXG5hc3luYyBmdW5jdGlvbiBsaXN0Q29sbGVjdGlvbnMoKTogUHJvbWlzZTx7XG4gIGNvbGxlY3Rpb25zOiBBcnJheTx7IG5hbWU6IHN0cmluZzsgdmVjdG9yc19jb3VudD86IG51bWJlciB9Pjtcbn0+IHtcbiAgY29uc3QgY29sbGVjdGlvbnNJbmZvID0gYXdhaXQgY2xpZW50LmdldENvbGxlY3Rpb25zKCk7XG4gIGNvbnN0IGNvbGxlY3Rpb25zID0gY29sbGVjdGlvbnNJbmZvLmNvbGxlY3Rpb25zO1xuXG4gIC8vIEdldCBkZXRhaWxlZCBpbmZvIGZvciBlYWNoIGNvbGxlY3Rpb24gdXNpbmcgYWN0dWFsIGNvdW50XG4gIGNvbnN0IGRldGFpbGVkQ29sbGVjdGlvbnMgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICBjb2xsZWN0aW9ucy5tYXAoYXN5bmMgKGNvbGxlY3Rpb246IGFueSkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gVXNlIHRoZSBzYW1lIGNvdW50IG1ldGhvZCB0aGF0IHdvcmtzIGZvciBpbmRpdmlkdWFsIHF1ZXJpZXNcbiAgICAgICAgY29uc3QgY291bnRSZXN1bHQgPSBhd2FpdCBjbGllbnQuY291bnQoY29sbGVjdGlvbi5uYW1lLCB7fSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbmFtZTogY29sbGVjdGlvbi5uYW1lLFxuICAgICAgICAgIHZlY3RvcnNfY291bnQ6IGNvdW50UmVzdWx0LmNvdW50IHx8IDAsXG4gICAgICAgIH07XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgYEZhaWxlZCB0byBjb3VudCB2ZWN0b3JzIGluIGNvbGxlY3Rpb24gJHtjb2xsZWN0aW9uLm5hbWV9OmAsXG4gICAgICAgICAgZXJyb3JcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBuYW1lOiBjb2xsZWN0aW9uLm5hbWUsXG4gICAgICAgICAgdmVjdG9yc19jb3VudDogMCxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9KVxuICApO1xuXG4gIHJldHVybiB7IGNvbGxlY3Rpb25zOiBkZXRhaWxlZENvbGxlY3Rpb25zIH07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGRlc2NyaWJlRGF0YWJhc2VJbmZvKCk6IFByb21pc2U8YW55PiB7XG4gIGNvbnN0IGNvbGxlY3Rpb25zRGF0YSA9IGF3YWl0IGxpc3RDb2xsZWN0aW9ucygpO1xuICBjb25zdCB0b3RhbFZlY3RvcnMgPSBjb2xsZWN0aW9uc0RhdGEuY29sbGVjdGlvbnMucmVkdWNlKFxuICAgIChzdW0sIGNvbCkgPT4gc3VtICsgKGNvbC52ZWN0b3JzX2NvdW50IHx8IDApLFxuICAgIDBcbiAgKTtcblxuICByZXR1cm4ge1xuICAgIHRvdGFsX2NvbGxlY3Rpb25zOiBjb2xsZWN0aW9uc0RhdGEuY29sbGVjdGlvbnMubGVuZ3RoLFxuICAgIHRvdGFsX3ZlY3RvcnM6IHRvdGFsVmVjdG9ycyxcbiAgICBjb2xsZWN0aW9uczogY29sbGVjdGlvbnNEYXRhLmNvbGxlY3Rpb25zLFxuICB9O1xufVxuXG5hc3luYyBmdW5jdGlvbiBzZWFyY2hBY3Jvc3NDb2xsZWN0aW9ucyhcbiAgZmlsdGVyOiBhbnksXG4gIGxpbWl0OiBudW1iZXJcbik6IFByb21pc2U8YW55PiB7XG4gIGNvbnN0IGNvbGxlY3Rpb25zRGF0YSA9IGF3YWl0IGxpc3RDb2xsZWN0aW9ucygpO1xuICBjb25zdCBhbGxSZXN1bHRzOiBhbnlbXSA9IFtdO1xuXG4gIC8vIFNlYXJjaCBlYWNoIGNvbGxlY3Rpb25cbiAgZm9yIChjb25zdCBjb2xsZWN0aW9uIG9mIGNvbGxlY3Rpb25zRGF0YS5jb2xsZWN0aW9ucykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgc2VhcmNoSW1hZ2VzKGNvbGxlY3Rpb24ubmFtZSwgZmlsdGVyLCBsaW1pdCk7XG4gICAgICBpZiAocmVzdWx0cy5pbWFnZXMgJiYgcmVzdWx0cy5pbWFnZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBhbGxSZXN1bHRzLnB1c2goe1xuICAgICAgICAgIGNvbGxlY3Rpb246IGNvbGxlY3Rpb24ubmFtZSxcbiAgICAgICAgICBjb3VudDogcmVzdWx0cy5jb3VudCxcbiAgICAgICAgICBpbWFnZXM6IHJlc3VsdHMuaW1hZ2VzLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKGBGYWlsZWQgdG8gc2VhcmNoIGNvbGxlY3Rpb24gJHtjb2xsZWN0aW9uLm5hbWV9OmAsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCB0b3RhbENvdW50ID0gYWxsUmVzdWx0cy5yZWR1Y2UoKHN1bSwgcmVzdWx0KSA9PiBzdW0gKyByZXN1bHQuY291bnQsIDApO1xuXG4gIHJldHVybiB7XG4gICAgdG90YWxfY291bnQ6IHRvdGFsQ291bnQsXG4gICAgY29sbGVjdGlvbnNfc2VhcmNoZWQ6IGNvbGxlY3Rpb25zRGF0YS5jb2xsZWN0aW9ucy5sZW5ndGgsXG4gICAgcmVzdWx0c19ieV9jb2xsZWN0aW9uOiBhbGxSZXN1bHRzLFxuICB9O1xufVxuXG4vLyBFeGlzdGluZyBjb2xsZWN0aW9uLWxldmVsIGZ1bmN0aW9ucyByZW1haW4gdGhlIHNhbWVcbmFzeW5jIGZ1bmN0aW9uIGNvdW50VG90YWwoY29sbGVjdGlvbjogc3RyaW5nKTogUHJvbWlzZTx7IGNvdW50OiBudW1iZXIgfT4ge1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNsaWVudC5jb3VudChjb2xsZWN0aW9uLCB7fSk7XG4gIHJldHVybiB7IGNvdW50OiByZXNwb25zZS5jb3VudCB9O1xufVxuXG5hc3luYyBmdW5jdGlvbiBjb3VudFVuaXF1ZUFydGlzdHMoXG4gIGNvbGxlY3Rpb246IHN0cmluZ1xuKTogUHJvbWlzZTx7IGNvdW50OiBudW1iZXI7IGFydGlzdHM6IHN0cmluZ1tdIH0+IHtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuc2Nyb2xsKGNvbGxlY3Rpb24sIHtcbiAgICBsaW1pdDogMTAwMCxcbiAgICB3aXRoX3BheWxvYWQ6IHRydWUsXG4gICAgd2l0aF92ZWN0b3I6IGZhbHNlLFxuICB9KTtcblxuICBjb25zdCBhcnRpc3RzID0gbmV3IFNldChcbiAgICByZXNwb25zZS5wb2ludHMubWFwKChwb2ludDogYW55KSA9PiBwb2ludC5wYXlsb2FkPy5uYW1lKS5maWx0ZXIoQm9vbGVhbilcbiAgKTtcblxuICByZXR1cm4ge1xuICAgIGNvdW50OiBhcnRpc3RzLnNpemUsXG4gICAgYXJ0aXN0czogQXJyYXkuZnJvbShhcnRpc3RzKS5zbGljZSgwLCAyMCksXG4gIH07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHNlYXJjaEltYWdlcyhcbiAgY29sbGVjdGlvbjogc3RyaW5nLFxuICBmaWx0ZXI6IGFueSxcbiAgbGltaXQ6IG51bWJlclxuKTogUHJvbWlzZTxhbnk+IHtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuc2Nyb2xsKGNvbGxlY3Rpb24sIHtcbiAgICBsaW1pdDogMTAwMCxcbiAgICB3aXRoX3BheWxvYWQ6IHRydWUsXG4gICAgd2l0aF92ZWN0b3I6IGZhbHNlLFxuICB9KTtcblxuICBsZXQgZmlsdGVyZWRQb2ludHMgPSByZXNwb25zZS5wb2ludHM7XG5cbiAgaWYgKGZpbHRlcikge1xuICAgIGZpbHRlcmVkUG9pbnRzID0gcmVzcG9uc2UucG9pbnRzLmZpbHRlcigocG9pbnQ6IGFueSkgPT4ge1xuICAgICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKGZpbHRlcikuZXZlcnkoKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICByZXR1cm4gcG9pbnQucGF5bG9hZD8uW2tleV0gPT09IHZhbHVlO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBjb25zdCBsaW1pdGVkUG9pbnRzID0gZmlsdGVyZWRQb2ludHMuc2xpY2UoMCwgbGltaXQpO1xuXG4gIHJldHVybiB7XG4gICAgY291bnQ6IGxpbWl0ZWRQb2ludHMubGVuZ3RoLFxuICAgIGltYWdlczogbGltaXRlZFBvaW50cyxcbiAgfTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gbGlzdFVuaXF1ZUFydGlzdHMoXG4gIGNvbGxlY3Rpb246IHN0cmluZyxcbiAgbGltaXQ6IG51bWJlclxuKTogUHJvbWlzZTx7IGFydGlzdHM6IHN0cmluZ1tdIH0+IHtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuc2Nyb2xsKGNvbGxlY3Rpb24sIHtcbiAgICBsaW1pdCxcbiAgICB3aXRoX3BheWxvYWQ6IHRydWUsXG4gICAgd2l0aF92ZWN0b3I6IGZhbHNlLFxuICB9KTtcblxuICBjb25zdCBhcnRpc3RzID0gbmV3IFNldChcbiAgICByZXNwb25zZS5wb2ludHMubWFwKChwb2ludDogYW55KSA9PiBwb2ludC5wYXlsb2FkPy5uYW1lKS5maWx0ZXIoQm9vbGVhbilcbiAgKTtcblxuICByZXR1cm4geyBhcnRpc3RzOiBBcnJheS5mcm9tKGFydGlzdHMpIH07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGxpc3RJbWFnZXMoY29sbGVjdGlvbjogc3RyaW5nLCBsaW1pdDogbnVtYmVyKTogUHJvbWlzZTxhbnk+IHtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuc2Nyb2xsKGNvbGxlY3Rpb24sIHtcbiAgICBsaW1pdCxcbiAgICB3aXRoX3BheWxvYWQ6IHRydWUsXG4gICAgd2l0aF92ZWN0b3I6IGZhbHNlLFxuICB9KTtcblxuICByZXR1cm4ge1xuICAgIGNvdW50OiByZXNwb25zZS5wb2ludHMubGVuZ3RoLFxuICAgIGltYWdlczogcmVzcG9uc2UucG9pbnRzLm1hcCgocG9pbnQ6IGFueSkgPT4gKHtcbiAgICAgIGlkOiBwb2ludC5pZCxcbiAgICAgIGFydGlzdDogcG9pbnQucGF5bG9hZD8ubmFtZSxcbiAgICAgIGZpbGVuYW1lOiBwb2ludC5wYXlsb2FkPy5maWxlX25hbWUsXG4gICAgfSkpLFxuICB9O1xufVxuXG5hc3luYyBmdW5jdGlvbiBmaWx0ZXJJbWFnZXMoXG4gIGNvbGxlY3Rpb246IHN0cmluZyxcbiAgZmlsdGVyOiBhbnksXG4gIGxpbWl0OiBudW1iZXJcbik6IFByb21pc2U8YW55PiB7XG4gIHJldHVybiBhd2FpdCBzZWFyY2hJbWFnZXMoY29sbGVjdGlvbiwgZmlsdGVyLCBsaW1pdCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGRlc2NyaWJlQ29sbGVjdGlvbihjb2xsZWN0aW9uOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICBjb25zdCB0b3RhbENvdW50ID0gYXdhaXQgY291bnRUb3RhbChjb2xsZWN0aW9uKTtcbiAgY29uc3QgYXJ0aXN0c0RhdGEgPSBhd2FpdCBjb3VudFVuaXF1ZUFydGlzdHMoY29sbGVjdGlvbik7XG4gIGNvbnN0IHNhbXBsZUltYWdlcyA9IGF3YWl0IGxpc3RJbWFnZXMoY29sbGVjdGlvbiwgNSk7XG5cbiAgcmV0dXJuIHtcbiAgICB0b3RhbF9pbWFnZXM6IHRvdGFsQ291bnQuY291bnQsXG4gICAgdW5pcXVlX2FydGlzdHM6IGFydGlzdHNEYXRhLmNvdW50LFxuICAgIHNhbXBsZV9hcnRpc3RzOiBhcnRpc3RzRGF0YS5hcnRpc3RzLnNsaWNlKDAsIDEwKSxcbiAgICBzYW1wbGVfaW1hZ2VzOiBzYW1wbGVJbWFnZXMuaW1hZ2VzLFxuICB9O1xufVxuXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVJlc3BvbnNlKFxuICBxdWVzdGlvbjogc3RyaW5nLFxuICBpbnRlbnQ6IFF1ZXJ5SW50ZW50LFxuICBkYXRhOiBhbnksXG4gIHByb3ZpZGVyOiBFbWJlZGRpbmdQcm92aWRlcixcbiAgbW9kZWw/OiBzdHJpbmdcbik6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IGZhbGxiYWNrUmVzcG9uc2UgPSBnZW5lcmF0ZUZhbGxiYWNrUmVzcG9uc2UocXVlc3Rpb24sIGludGVudCwgZGF0YSk7XG5cbiAgaWYgKCFwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSAmJiAhcHJvY2Vzcy5lbnYuR0VNSU5JX0FQSV9LRVkpIHtcbiAgICByZXR1cm4gZmFsbGJhY2tSZXNwb25zZTtcbiAgfVxuXG4gIGNvbnN0IHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIGEgaGVscGZ1bCBhc3Npc3RhbnQgdGhhdCBleHBsYWlucyB2ZWN0b3IgZGF0YWJhc2UgcXVlcnkgcmVzdWx0cyBpbiBuYXR1cmFsIGxhbmd1YWdlLlxuICBcblRoZSB1c2VyIGFza2VkOiBcIiR7cXVlc3Rpb259XCJcblRoZSBxdWVyeSB0eXBlIHdhczogJHtpbnRlbnQudHlwZX1cblRoZSBxdWVyeSBzY29wZSB3YXM6ICR7aW50ZW50LnNjb3BlfVxuVGhlIGRhdGEgcmV0dXJuZWQgaXM6ICR7SlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMil9XG5cblByb3ZpZGUgYSBjb25jaXNlLCBuYXR1cmFsIGxhbmd1YWdlIHJlc3BvbnNlIHRoYXQgZGlyZWN0bHkgYW5zd2VycyB0aGUgdXNlcidzIHF1ZXN0aW9uLiBCZSBzcGVjaWZpYyB3aXRoIG51bWJlcnMgYW5kIG5hbWVzIHdoZW4gYXZhaWxhYmxlLmA7XG5cbiAgdHJ5IHtcbiAgICBsZXQgcmVzcG9uc2U6IHN0cmluZztcblxuICAgIGlmIChwcm92aWRlciA9PT0gXCJnZW1pbmlcIiAmJiBwcm9jZXNzLmVudi5HRU1JTklfQVBJX0tFWSkge1xuICAgICAgY29uc3QgZ2VtaW5pTW9kZWwgPSBnZW5BSS5nZXRHZW5lcmF0aXZlTW9kZWwoe1xuICAgICAgICBtb2RlbDogbW9kZWwgfHwgXCJnZW1pbmktMi4wLWZsYXNoXCIsIC8vIFVzZSBzcGVjaWZpYyBtb2RlbCBwYXJhbWV0ZXJcbiAgICAgIH0pO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2VtaW5pTW9kZWwuZ2VuZXJhdGVDb250ZW50KHN5c3RlbVByb21wdCk7XG4gICAgICByZXNwb25zZSA9IHJlc3VsdC5yZXNwb25zZS50ZXh0KCk7XG4gICAgfSBlbHNlIGlmIChwcm92aWRlciA9PT0gXCJvcGVuYWlcIiAmJiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY29tcGxldGlvbiA9IGF3YWl0IG9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICAgICAgbW9kZWw6IG1vZGVsIHx8IFwiZ3B0LTMuNS10dXJib1wiLCAvLyBVc2Ugc3BlY2lmaWMgbW9kZWwgcGFyYW1ldGVyXG4gICAgICAgICAgbWVzc2FnZXM6IFt7IHJvbGU6IFwic3lzdGVtXCIsIGNvbnRlbnQ6IHN5c3RlbVByb21wdCB9XSxcbiAgICAgICAgICB0ZW1wZXJhdHVyZTogMC4zLFxuICAgICAgICAgIG1heF90b2tlbnM6IDIwMCxcbiAgICAgICAgfSk7XG4gICAgICAgIHJlc3BvbnNlID0gY29tcGxldGlvbi5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudCB8fCBmYWxsYmFja1Jlc3BvbnNlO1xuICAgICAgfSBjYXRjaCAob3BlbmFpRXJyb3I6IGFueSkge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgXCJPcGVuQUkgZmFpbGVkIGluIGdlbmVyYXRlUmVzcG9uc2UsIHRyeWluZyBHZW1pbmkgZmFsbGJhY2s6XCIsXG4gICAgICAgICAgb3BlbmFpRXJyb3IubWVzc2FnZVxuICAgICAgICApO1xuICAgICAgICAvLyBBdXRvLWZhbGxiYWNrIHRvIEdlbWluaSBpZiBPcGVuQUkgZmFpbHNcbiAgICAgICAgaWYgKHByb2Nlc3MuZW52LkdFTUlOSV9BUElfS0VZKSB7XG4gICAgICAgICAgY29uc3QgZ2VtaW5pTW9kZWwgPSBnZW5BSS5nZXRHZW5lcmF0aXZlTW9kZWwoe1xuICAgICAgICAgICAgbW9kZWw6IFwiZ2VtaW5pLTIuMC1mbGFzaFwiLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdlbWluaU1vZGVsLmdlbmVyYXRlQ29udGVudChzeXN0ZW1Qcm9tcHQpO1xuICAgICAgICAgIHJlc3BvbnNlID0gcmVzdWx0LnJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyBvcGVuYWlFcnJvcjsgLy8gUmUtdGhyb3cgaWYgbm8gR2VtaW5pIGZhbGxiYWNrIGF2YWlsYWJsZVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxsYmFja1Jlc3BvbnNlO1xuICAgIH1cblxuICAgIHJldHVybiByZXNwb25zZS50cmltKCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS53YXJuKFwiRmFpbGVkIHRvIGdlbmVyYXRlIExMTSByZXNwb25zZSwgdXNpbmcgZmFsbGJhY2s6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gZmFsbGJhY2tSZXNwb25zZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUZhbGxiYWNrUmVzcG9uc2UoXG4gIHF1ZXN0aW9uOiBzdHJpbmcsXG4gIGludGVudDogUXVlcnlJbnRlbnQsXG4gIGRhdGE6IGFueVxuKTogc3RyaW5nIHtcbiAgLy8gU2FmZWx5IGhhbmRsZSBudWxsL3VuZGVmaW5lZCBkYXRhXG4gIGNvbnN0IHNhZmVEYXRhID0gZGF0YSB8fCB7fTtcblxuICBpZiAoaW50ZW50LnNjb3BlID09PSBcImRhdGFiYXNlXCIpIHtcbiAgICBzd2l0Y2ggKGludGVudC50eXBlKSB7XG4gICAgICBjYXNlIFwiY291bnRcIjpcbiAgICAgICAgaWYgKGludGVudC50YXJnZXQgPT09IFwiY29sbGVjdGlvbnNcIikge1xuICAgICAgICAgIHJldHVybiBgSSBmb3VuZCAke3NhZmVEYXRhLmNvdW50IHx8IDB9IGNvbGxlY3Rpb25zIGluIHRoZSBkYXRhYmFzZTogJHtcbiAgICAgICAgICAgIHNhZmVEYXRhLmNvbGxlY3Rpb25zPy5qb2luKFwiLCBcIikgfHwgXCJOb25lIGZvdW5kXCJcbiAgICAgICAgICB9LmA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGludGVudC50YXJnZXQgPT09IFwiYXJ0aXN0c1wiKSB7XG4gICAgICAgICAgcmV0dXJuIGBJIGZvdW5kICR7XG4gICAgICAgICAgICBzYWZlRGF0YS5jb3VudCB8fCAwXG4gICAgICAgICAgfSB1bmlxdWUgYXJ0aXN0cyBhY3Jvc3MgYWxsIGNvbGxlY3Rpb25zLiBTb21lIG9mIHRoZW0gaW5jbHVkZTogJHtcbiAgICAgICAgICAgIHNhZmVEYXRhLmFydGlzdHM/LnNsaWNlKDAsIDUpLmpvaW4oXCIsIFwiKSB8fCBcIk5vIGFydGlzdHMgZm91bmRcIlxuICAgICAgICAgIH0uYDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW50ZW50LnRhcmdldCA9PT0gXCJpbWFnZXNcIiAmJiBpbnRlbnQuZmlsdGVyPy5uYW1lKSB7XG4gICAgICAgICAgcmV0dXJuIGBJIGZvdW5kICR7c2FmZURhdGEuY291bnQgfHwgMH0gaW1hZ2VzIGJ5ICR7XG4gICAgICAgICAgICBzYWZlRGF0YS5hcnRpc3QgfHwgaW50ZW50LmZpbHRlci5uYW1lXG4gICAgICAgICAgfSBhY3Jvc3MgYWxsIGNvbGxlY3Rpb25zLiAke1xuICAgICAgICAgICAgc2FmZURhdGEuYnlfY29sbGVjdGlvbj8ubGVuZ3RoID4gMFxuICAgICAgICAgICAgICA/IGBGb3VuZCBpbjogJHtzYWZlRGF0YS5ieV9jb2xsZWN0aW9uXG4gICAgICAgICAgICAgICAgICAubWFwKChjOiBhbnkpID0+IGAke2MuY29sbGVjdGlvbn0gKCR7Yy5jb3VudH0pYClcbiAgICAgICAgICAgICAgICAgIC5qb2luKFwiLCBcIil9LmBcbiAgICAgICAgICAgICAgOiBcIlwiXG4gICAgICAgICAgfWA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGludGVudC50YXJnZXQgPT09IFwidG90YWxcIikge1xuICAgICAgICAgIHJldHVybiBgVGhlIGRhdGFiYXNlIGNvbnRhaW5zICR7XG4gICAgICAgICAgICBzYWZlRGF0YS5jb3VudCB8fCAwXG4gICAgICAgICAgfSB0b3RhbCB2ZWN0b3JzIGFjcm9zcyBhbGwgY29sbGVjdGlvbnMuYDtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJjb2xsZWN0aW9uc1wiOlxuICAgICAgICByZXR1cm4gYFRoZSBkYXRhYmFzZSBjb250YWlucyAke1xuICAgICAgICAgIHNhZmVEYXRhLmNvbGxlY3Rpb25zPy5sZW5ndGggfHwgMFxuICAgICAgICB9IGNvbGxlY3Rpb25zOiAke1xuICAgICAgICAgIHNhZmVEYXRhLmNvbGxlY3Rpb25zXG4gICAgICAgICAgICA/Lm1hcCgoYzogYW55KSA9PiBgJHtjLm5hbWV9ICgke2MudmVjdG9yc19jb3VudCB8fCAwfSB2ZWN0b3JzKWApXG4gICAgICAgICAgICAuam9pbihcIiwgXCIpIHx8IFwiTm9uZSBmb3VuZFwiXG4gICAgICAgIH0uYDtcbiAgICAgIGNhc2UgXCJkYXRhYmFzZVwiOlxuICAgICAgICByZXR1cm4gYFRoZSBkYXRhYmFzZSBjb250YWlucyAke1xuICAgICAgICAgIHNhZmVEYXRhLnRvdGFsX2NvbGxlY3Rpb25zIHx8IDBcbiAgICAgICAgfSBjb2xsZWN0aW9ucyB3aXRoIGEgdG90YWwgb2YgJHtzYWZlRGF0YS50b3RhbF92ZWN0b3JzIHx8IDB9IHZlY3RvcnMuYDtcbiAgICAgIGNhc2UgXCJzZWFyY2hcIjpcbiAgICAgICAgcmV0dXJuIGBJIHNlYXJjaGVkIGFjcm9zcyAke1xuICAgICAgICAgIHNhZmVEYXRhLmNvbGxlY3Rpb25zX3NlYXJjaGVkIHx8IDBcbiAgICAgICAgfSBjb2xsZWN0aW9ucyBhbmQgZm91bmQgJHtzYWZlRGF0YS50b3RhbF9jb3VudCB8fCAwfSBtYXRjaGluZyBpdGVtcy5gO1xuICAgICAgY2FzZSBcInN1bW1hcml6ZVwiOlxuICAgICAgICBpZiAoaW50ZW50LmZpbHRlcj8ubmFtZSkge1xuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBgU3VtbWFyeSBvZiAke1xuICAgICAgICAgICAgICBzYWZlRGF0YS5hcnRpc3QgfHwgaW50ZW50LmZpbHRlci5uYW1lXG4gICAgICAgICAgICB9J3Mgd29yayBhY3Jvc3MgdGhlIGRhdGFiYXNlOlxcblxcbmAgK1xuICAgICAgICAgICAgYFRvdGFsIEltYWdlczogJHtzYWZlRGF0YS50b3RhbF9pbWFnZXMgfHwgMH1cXG5gICtcbiAgICAgICAgICAgIGBDb2xsZWN0aW9uczogRm91bmQgaW4gJHtcbiAgICAgICAgICAgICAgc2FmZURhdGEuY29sbGVjdGlvbnNfZm91bmQgfHwgMFxuICAgICAgICAgICAgfSBjb2xsZWN0aW9uc1xcbmAgK1xuICAgICAgICAgICAgYEZpbGUgVHlwZXM6ICR7c2FmZURhdGEuZmlsZV90eXBlcz8uam9pbihcIiwgXCIpIHx8IFwiVmFyaW91c1wifVxcblxcbmAgK1xuICAgICAgICAgICAgYEJyZWFrZG93biBieSBjb2xsZWN0aW9uOlxcbiR7XG4gICAgICAgICAgICAgIHNhZmVEYXRhLmJ5X2NvbGxlY3Rpb25cbiAgICAgICAgICAgICAgICA/Lm1hcCgoYzogYW55KSA9PiBg4oCiICR7Yy5jb2xsZWN0aW9ufTogJHtjLmltYWdlX2NvdW50fSBpbWFnZXNgKVxuICAgICAgICAgICAgICAgIC5qb2luKFwiXFxuXCIpIHx8IFwiTm8gY29sbGVjdGlvbnMgZm91bmRcIlxuICAgICAgICAgICAgfVxcblxcbmAgK1xuICAgICAgICAgICAgYFNhbXBsZSBJbWFnZXM6ICR7XG4gICAgICAgICAgICAgIHNhZmVEYXRhLnNhbXBsZV9pbWFnZXNcbiAgICAgICAgICAgICAgICA/LnNsaWNlKDAsIDMpXG4gICAgICAgICAgICAgICAgLm1hcCgoaW1nOiBhbnkpID0+IGAke2ltZy5maWxlbmFtZX0gKCR7aW1nLmNvbGxlY3Rpb259KWApXG4gICAgICAgICAgICAgICAgLmpvaW4oXCIsIFwiKSB8fCBcIk5vbmUgZm91bmRcIlxuICAgICAgICAgICAgfWBcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcImxpc3RcIjpcbiAgICAgICAgaWYgKGludGVudC50YXJnZXQgPT09IFwiYXJ0aXN0c1wiKSB7XG4gICAgICAgICAgcmV0dXJuIGBJIGZvdW5kICR7XG4gICAgICAgICAgICBzYWZlRGF0YS5hcnRpc3RzPy5sZW5ndGggfHwgMFxuICAgICAgICAgIH0gdW5pcXVlIGFydGlzdHMgYWNyb3NzIGFsbCBjb2xsZWN0aW9uczogJHtcbiAgICAgICAgICAgIHNhZmVEYXRhLmFydGlzdHM/LnNsaWNlKDAsIDEwKS5qb2luKFwiLCBcIikgfHwgXCJObyBhcnRpc3RzIGZvdW5kXCJcbiAgICAgICAgICB9LmA7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgLy8gQ29sbGVjdGlvbi1sZXZlbCByZXNwb25zZXNcbiAgc3dpdGNoIChpbnRlbnQudHlwZSkge1xuICAgIGNhc2UgXCJjb3VudFwiOlxuICAgICAgaWYgKGludGVudC50YXJnZXQgPT09IFwiYXJ0aXN0c1wiKSB7XG4gICAgICAgIHJldHVybiBgSSBmb3VuZCAke1xuICAgICAgICAgIHNhZmVEYXRhLmNvdW50IHx8IDBcbiAgICAgICAgfSB1bmlxdWUgYXJ0aXN0cyBpbiB0aGUgY29sbGVjdGlvbi4gU29tZSBvZiB0aGVtIGluY2x1ZGU6ICR7XG4gICAgICAgICAgc2FmZURhdGEuYXJ0aXN0cz8uc2xpY2UoMCwgNSkuam9pbihcIiwgXCIpIHx8IFwiTm8gYXJ0aXN0cyBmb3VuZFwiXG4gICAgICAgIH0uYDtcbiAgICAgIH0gZWxzZSBpZiAoaW50ZW50LnRhcmdldCA9PT0gXCJpbWFnZXNcIiAmJiBpbnRlbnQuZmlsdGVyPy5uYW1lKSB7XG4gICAgICAgIHJldHVybiBgSSBmb3VuZCAke3NhZmVEYXRhLmNvdW50IHx8IDB9IGltYWdlcyBieSAke1xuICAgICAgICAgIHNhZmVEYXRhLmFydGlzdCB8fCBpbnRlbnQuZmlsdGVyLm5hbWVcbiAgICAgICAgfSBpbiB0aGlzIGNvbGxlY3Rpb24uJHtcbiAgICAgICAgICBzYWZlRGF0YS5zYW1wbGVfaW1hZ2VzPy5sZW5ndGggPiAwXG4gICAgICAgICAgICA/IGAgU2FtcGxlIGZpbGVzOiAke3NhZmVEYXRhLnNhbXBsZV9pbWFnZXNcbiAgICAgICAgICAgICAgICAuc2xpY2UoMCwgMylcbiAgICAgICAgICAgICAgICAubWFwKChpbWc6IGFueSkgPT4gaW1nLmZpbGVuYW1lKVxuICAgICAgICAgICAgICAgIC5qb2luKFwiLCBcIil9LmBcbiAgICAgICAgICAgIDogXCJcIlxuICAgICAgICB9YDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBgVGhlIGNvbGxlY3Rpb24gY29udGFpbnMgJHtzYWZlRGF0YS5jb3VudCB8fCAwfSB0b3RhbCBpbWFnZXMuYDtcbiAgICAgIH1cblxuICAgIGNhc2UgXCJzZWFyY2hcIjpcbiAgICBjYXNlIFwiZmlsdGVyXCI6XG4gICAgICByZXR1cm4gYEkgZm91bmQgJHtzYWZlRGF0YS5jb3VudCB8fCAwfSBpbWFnZXMgbWF0Y2hpbmcgeW91ciBjcml0ZXJpYS5gO1xuXG4gICAgY2FzZSBcInN1bW1hcml6ZVwiOlxuICAgICAgaWYgKGludGVudC5maWx0ZXI/Lm5hbWUpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICBgU3VtbWFyeSBvZiAke1xuICAgICAgICAgICAgc2FmZURhdGEuYXJ0aXN0IHx8IGludGVudC5maWx0ZXIubmFtZVxuICAgICAgICAgIH0ncyB3b3JrIGluIHRoaXMgY29sbGVjdGlvbjpcXG5cXG5gICtcbiAgICAgICAgICBgVG90YWwgSW1hZ2VzOiAke3NhZmVEYXRhLnRvdGFsX2ltYWdlcyB8fCAwfVxcbmAgK1xuICAgICAgICAgIGBGaWxlIFR5cGVzOiAke3NhZmVEYXRhLmZpbGVfdHlwZXM/LmpvaW4oXCIsIFwiKSB8fCBcIlZhcmlvdXNcIn1cXG5gICtcbiAgICAgICAgICBgU2FtcGxlIEZpbGVzOiAke1xuICAgICAgICAgICAgc2FmZURhdGEuc2FtcGxlX2ZpbGVuYW1lcz8uc2xpY2UoMCwgNSkuam9pbihcIiwgXCIpIHx8IFwiTm9uZVwiXG4gICAgICAgICAgfVxcblxcbmAgK1xuICAgICAgICAgIGBJbWFnZSBEZXRhaWxzOlxcbiR7XG4gICAgICAgICAgICBzYWZlRGF0YS5pbWFnZXNcbiAgICAgICAgICAgICAgPy5zbGljZSgwLCA1KVxuICAgICAgICAgICAgICAubWFwKFxuICAgICAgICAgICAgICAgIChpbWc6IGFueSwgaTogbnVtYmVyKSA9PlxuICAgICAgICAgICAgICAgICAgYCR7aSArIDF9LiAke2ltZy5maWxlbmFtZSB8fCBcIlVua25vd24gZmlsZVwifWBcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAuam9pbihcIlxcblwiKSB8fCBcIk5vIGltYWdlcyBmb3VuZFwiXG4gICAgICAgICAgfWBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBcImFuYWx5emVcIjpcbiAgICAgIGlmIChpbnRlbnQuZmlsdGVyPy5uYW1lKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgYEFuYWx5c2lzIG9mICR7XG4gICAgICAgICAgICBzYWZlRGF0YS5hcnRpc3QgfHwgaW50ZW50LmZpbHRlci5uYW1lXG4gICAgICAgICAgfSdzIHdvcmsgcGF0dGVybnM6XFxuXFxuYCArXG4gICAgICAgICAgYFRvdGFsIEltYWdlczogJHtzYWZlRGF0YS50b3RhbF9pbWFnZXMgfHwgMH1cXG5gICtcbiAgICAgICAgICBgRmlsZSBUeXBlczogJHtcbiAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHNhZmVEYXRhLmZpbGVfdHlwZV9kaXN0cmlidXRpb24gfHwge30pXG4gICAgICAgICAgICAgIC5tYXAoKFt0eXBlLCBjb3VudF0pID0+IGAke3R5cGV9ICgke2NvdW50fSlgKVxuICAgICAgICAgICAgICAuam9pbihcIiwgXCIpIHx8IFwiVmFyaW91c1wiXG4gICAgICAgICAgfVxcbmAgK1xuICAgICAgICAgIGBDb21tb24gUGF0dGVybnM6ICR7XG4gICAgICAgICAgICBPYmplY3QuZW50cmllcyhzYWZlRGF0YS5jb21tb25fbmFtaW5nX3BhdHRlcm5zIHx8IHt9KVxuICAgICAgICAgICAgICAuc2xpY2UoMCwgMylcbiAgICAgICAgICAgICAgLm1hcCgoW3BhdHRlcm4sIGNvdW50XSkgPT4gYFwiJHtwYXR0ZXJufVwiICgke2NvdW50fSBmaWxlcylgKVxuICAgICAgICAgICAgICAuam9pbihcIiwgXCIpIHx8IFwiTm8gcGF0dGVybnMgZm91bmRcIlxuICAgICAgICAgIH1cXG5gICtcbiAgICAgICAgICBgU291cmNlIERvbWFpbnM6ICR7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhzYWZlRGF0YS5zb3VyY2VfZG9tYWlucyB8fCB7fSkuam9pbihcIiwgXCIpIHx8IFwiVmFyaW91c1wiXG4gICAgICAgICAgfWBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBcImxpc3RcIjpcbiAgICAgIGlmIChpbnRlbnQudGFyZ2V0ID09PSBcImFydGlzdHNcIikge1xuICAgICAgICByZXR1cm4gYEhlcmUgYXJlIHRoZSBhcnRpc3RzIGluIHRoZSBjb2xsZWN0aW9uOiAke1xuICAgICAgICAgIHNhZmVEYXRhLmFydGlzdHM/LnNsaWNlKDAsIDEwKS5qb2luKFwiLCBcIikgfHwgXCJObyBhcnRpc3RzIGZvdW5kXCJcbiAgICAgICAgfSR7c2FmZURhdGEuYXJ0aXN0cz8ubGVuZ3RoID4gMTAgPyBcIi4uLlwiIDogXCJcIn0uYDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBgSSBmb3VuZCAke3NhZmVEYXRhLmNvdW50IHx8IDB9IGl0ZW1zIGluIHRoZSBjb2xsZWN0aW9uLmA7XG4gICAgICB9XG5cbiAgICBjYXNlIFwiZGVzY3JpYmVcIjpcbiAgICAgIHJldHVybiBgVGhpcyBjb2xsZWN0aW9uIGNvbnRhaW5zICR7XG4gICAgICAgIHNhZmVEYXRhLnRvdGFsX2ltYWdlcyB8fCAwXG4gICAgICB9IGltYWdlcyBmcm9tICR7XG4gICAgICAgIHNhZmVEYXRhLnVuaXF1ZV9hcnRpc3RzIHx8IDBcbiAgICAgIH0gdW5pcXVlIGFydGlzdHMuIFNvbWUgZmVhdHVyZWQgYXJ0aXN0cyBpbmNsdWRlOiAke1xuICAgICAgICBzYWZlRGF0YS5zYW1wbGVfYXJ0aXN0cz8uc2xpY2UoMCwgNSkuam9pbihcIiwgXCIpIHx8IFwiTm8gYXJ0aXN0cyBmb3VuZFwiXG4gICAgICB9LmA7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIFwiSSBwcm9jZXNzZWQgeW91ciBxdWVyeSBzdWNjZXNzZnVsbHkgdXNpbmcgcGF0dGVybiBtYXRjaGluZy5cIjtcbiAgfVxuXG4gIHJldHVybiBcIkkgcHJvY2Vzc2VkIHlvdXIgcXVlcnkgc3VjY2Vzc2Z1bGx5LlwiO1xufVxuXG4vLyBOZXcgZGF0YWJhc2UtbGV2ZWwgZnVuY3Rpb25zIGZvciBhcnRpc3RzIGFuZCB0b3RhbCBjb3VudHNcbmFzeW5jIGZ1bmN0aW9uIGNvdW50QXJ0aXN0c0Fjcm9zc0RhdGFiYXNlKCk6IFByb21pc2U8e1xuICBjb3VudDogbnVtYmVyO1xuICBhcnRpc3RzOiBzdHJpbmdbXTtcbn0+IHtcbiAgY29uc3QgY29sbGVjdGlvbnNEYXRhID0gYXdhaXQgbGlzdENvbGxlY3Rpb25zKCk7XG4gIGNvbnN0IGFsbEFydGlzdHMgPSBuZXcgU2V0PHN0cmluZz4oKTtcblxuICAvLyBDb2xsZWN0IGFydGlzdHMgZnJvbSBlYWNoIGNvbGxlY3Rpb25cbiAgZm9yIChjb25zdCBjb2xsZWN0aW9uIG9mIGNvbGxlY3Rpb25zRGF0YS5jb2xsZWN0aW9ucykge1xuICAgIHRyeSB7XG4gICAgICBpZiAoY29sbGVjdGlvbi52ZWN0b3JzX2NvdW50ICYmIGNvbGxlY3Rpb24udmVjdG9yc19jb3VudCA+IDApIHtcbiAgICAgICAgY29uc3QgYXJ0aXN0c0RhdGEgPSBhd2FpdCBjb3VudFVuaXF1ZUFydGlzdHMoY29sbGVjdGlvbi5uYW1lKTtcbiAgICAgICAgYXJ0aXN0c0RhdGEuYXJ0aXN0cy5mb3JFYWNoKChhcnRpc3QpID0+IGFsbEFydGlzdHMuYWRkKGFydGlzdCkpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIGBGYWlsZWQgdG8gZ2V0IGFydGlzdHMgZnJvbSBjb2xsZWN0aW9uICR7Y29sbGVjdGlvbi5uYW1lfTpgLFxuICAgICAgICBlcnJvclxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGNvdW50OiBhbGxBcnRpc3RzLnNpemUsXG4gICAgYXJ0aXN0czogQXJyYXkuZnJvbShhbGxBcnRpc3RzKS5zbGljZSgwLCAyMCksIC8vIFNob3cgZmlyc3QgMjBcbiAgfTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gY291bnRUb3RhbFZlY3RvcnNBY3Jvc3NEYXRhYmFzZSgpOiBQcm9taXNlPHtcbiAgY291bnQ6IG51bWJlcjtcbiAgYnlfY29sbGVjdGlvbjogQXJyYXk8eyBuYW1lOiBzdHJpbmc7IGNvdW50OiBudW1iZXIgfT47XG59PiB7XG4gIGNvbnN0IGNvbGxlY3Rpb25zRGF0YSA9IGF3YWl0IGxpc3RDb2xsZWN0aW9ucygpO1xuICBjb25zdCB0b3RhbFZlY3RvcnMgPSBjb2xsZWN0aW9uc0RhdGEuY29sbGVjdGlvbnMucmVkdWNlKFxuICAgIChzdW0sIGNvbCkgPT4gc3VtICsgKGNvbC52ZWN0b3JzX2NvdW50IHx8IDApLFxuICAgIDBcbiAgKTtcblxuICByZXR1cm4ge1xuICAgIGNvdW50OiB0b3RhbFZlY3RvcnMsXG4gICAgYnlfY29sbGVjdGlvbjogY29sbGVjdGlvbnNEYXRhLmNvbGxlY3Rpb25zLm1hcCgoY29sKSA9PiAoe1xuICAgICAgbmFtZTogY29sLm5hbWUsXG4gICAgICBjb3VudDogY29sLnZlY3RvcnNfY291bnQgfHwgMCxcbiAgICB9KSksXG4gIH07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGxpc3RBcnRpc3RzQWNyb3NzRGF0YWJhc2UobGltaXQ6IG51bWJlcik6IFByb21pc2U8e1xuICBhcnRpc3RzOiBzdHJpbmdbXTtcbiAgYnlfY29sbGVjdGlvbjogQXJyYXk8eyBjb2xsZWN0aW9uOiBzdHJpbmc7IGFydGlzdHM6IHN0cmluZ1tdIH0+O1xufT4ge1xuICBjb25zdCBjb2xsZWN0aW9uc0RhdGEgPSBhd2FpdCBsaXN0Q29sbGVjdGlvbnMoKTtcbiAgY29uc3QgYWxsQXJ0aXN0cyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICBjb25zdCBieUNvbGxlY3Rpb246IEFycmF5PHsgY29sbGVjdGlvbjogc3RyaW5nOyBhcnRpc3RzOiBzdHJpbmdbXSB9PiA9IFtdO1xuXG4gIC8vIENvbGxlY3QgYXJ0aXN0cyBmcm9tIGVhY2ggY29sbGVjdGlvblxuICBmb3IgKGNvbnN0IGNvbGxlY3Rpb24gb2YgY29sbGVjdGlvbnNEYXRhLmNvbGxlY3Rpb25zKSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChjb2xsZWN0aW9uLnZlY3RvcnNfY291bnQgJiYgY29sbGVjdGlvbi52ZWN0b3JzX2NvdW50ID4gMCkge1xuICAgICAgICBjb25zdCBhcnRpc3RzRGF0YSA9IGF3YWl0IGxpc3RVbmlxdWVBcnRpc3RzKFxuICAgICAgICAgIGNvbGxlY3Rpb24ubmFtZSxcbiAgICAgICAgICBNYXRoLm1pbihsaW1pdCwgMjApXG4gICAgICAgICk7XG4gICAgICAgIGFydGlzdHNEYXRhLmFydGlzdHMuZm9yRWFjaCgoYXJ0aXN0KSA9PiBhbGxBcnRpc3RzLmFkZChhcnRpc3QpKTtcbiAgICAgICAgYnlDb2xsZWN0aW9uLnB1c2goe1xuICAgICAgICAgIGNvbGxlY3Rpb246IGNvbGxlY3Rpb24ubmFtZSxcbiAgICAgICAgICBhcnRpc3RzOiBhcnRpc3RzRGF0YS5hcnRpc3RzLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICBgRmFpbGVkIHRvIGdldCBhcnRpc3RzIGZyb20gY29sbGVjdGlvbiAke2NvbGxlY3Rpb24ubmFtZX06YCxcbiAgICAgICAgZXJyb3JcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBhcnRpc3RzOiBBcnJheS5mcm9tKGFsbEFydGlzdHMpLnNsaWNlKDAsIGxpbWl0KSxcbiAgICBieV9jb2xsZWN0aW9uOiBieUNvbGxlY3Rpb24sXG4gIH07XG59XG5cbi8vIE5ldyBmdW5jdGlvbiB0byBjb3VudCBpbWFnZXMgYnkgc3BlY2lmaWMgYXJ0aXN0XG5hc3luYyBmdW5jdGlvbiBjb3VudEltYWdlc0J5QXJ0aXN0KFxuICBjb2xsZWN0aW9uOiBzdHJpbmcsXG4gIGZpbHRlcjogYW55XG4pOiBQcm9taXNlPHsgY291bnQ6IG51bWJlcjsgYXJ0aXN0OiBzdHJpbmc7IHNhbXBsZV9pbWFnZXM6IGFueVtdIH0+IHtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuc2Nyb2xsKGNvbGxlY3Rpb24sIHtcbiAgICBsaW1pdDogMTAwMCxcbiAgICB3aXRoX3BheWxvYWQ6IHRydWUsXG4gICAgd2l0aF92ZWN0b3I6IGZhbHNlLFxuICB9KTtcblxuICBsZXQgZmlsdGVyZWRQb2ludHMgPSByZXNwb25zZS5wb2ludHM7XG4gIGlmIChmaWx0ZXIpIHtcbiAgICBmaWx0ZXJlZFBvaW50cyA9IHJlc3BvbnNlLnBvaW50cy5maWx0ZXIoKHBvaW50OiBhbnkpID0+IHtcbiAgICAgIHJldHVybiBPYmplY3QuZW50cmllcyhmaWx0ZXIpLmV2ZXJ5KChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgcmV0dXJuIHBvaW50LnBheWxvYWQ/LltrZXldID09PSB2YWx1ZTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBjb3VudDogZmlsdGVyZWRQb2ludHMubGVuZ3RoLFxuICAgIGFydGlzdDogZmlsdGVyPy5uYW1lIHx8IFwidW5rbm93blwiLFxuICAgIHNhbXBsZV9pbWFnZXM6IGZpbHRlcmVkUG9pbnRzLnNsaWNlKDAsIDUpLm1hcCgocG9pbnQ6IGFueSkgPT4gKHtcbiAgICAgIGlkOiBwb2ludC5pZCxcbiAgICAgIGZpbGVuYW1lOiBwb2ludC5wYXlsb2FkPy5maWxlX25hbWUsXG4gICAgICB1cmw6IHBvaW50LnBheWxvYWQ/LmltYWdlX3VybCxcbiAgICB9KSksXG4gIH07XG59XG5cbi8vIE5ldyBmdW5jdGlvbiB0byBwcm92aWRlIGRldGFpbGVkIHN1bW1hcnkgb2YgYXJ0aXN0J3Mgd29ya1xuYXN5bmMgZnVuY3Rpb24gc3VtbWFyaXplQXJ0aXN0V29yayhcbiAgY29sbGVjdGlvbjogc3RyaW5nLFxuICBmaWx0ZXI6IGFueSxcbiAgbGltaXQ6IG51bWJlclxuKTogUHJvbWlzZTxhbnk+IHtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuc2Nyb2xsKGNvbGxlY3Rpb24sIHtcbiAgICBsaW1pdDogMTAwMCxcbiAgICB3aXRoX3BheWxvYWQ6IHRydWUsXG4gICAgd2l0aF92ZWN0b3I6IGZhbHNlLFxuICB9KTtcblxuICBsZXQgZmlsdGVyZWRQb2ludHMgPSByZXNwb25zZS5wb2ludHM7XG4gIGlmIChmaWx0ZXIpIHtcbiAgICBmaWx0ZXJlZFBvaW50cyA9IHJlc3BvbnNlLnBvaW50cy5maWx0ZXIoKHBvaW50OiBhbnkpID0+IHtcbiAgICAgIHJldHVybiBPYmplY3QuZW50cmllcyhmaWx0ZXIpLmV2ZXJ5KChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgcmV0dXJuIHBvaW50LnBheWxvYWQ/LltrZXldID09PSB2YWx1ZTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgY29uc3QgbGltaXRlZFBvaW50cyA9IGZpbHRlcmVkUG9pbnRzLnNsaWNlKDAsIGxpbWl0KTtcblxuICAvLyBBbmFseXplIGZpbGUgdHlwZXMgYW5kIHBhdHRlcm5zXG4gIGNvbnN0IGZpbGVFeHRlbnNpb25zID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gIGNvbnN0IGZpbGVOYW1lczogc3RyaW5nW10gPSBbXTtcbiAgY29uc3QgaW1hZ2VVcmxzOiBzdHJpbmdbXSA9IFtdO1xuXG4gIGxpbWl0ZWRQb2ludHMuZm9yRWFjaCgocG9pbnQ6IGFueSkgPT4ge1xuICAgIGlmIChwb2ludC5wYXlsb2FkPy5maWxlX25hbWUpIHtcbiAgICAgIGNvbnN0IGV4dCA9IHBvaW50LnBheWxvYWQuZmlsZV9uYW1lLnNwbGl0KFwiLlwiKS5wb3AoKT8udG9Mb3dlckNhc2UoKTtcbiAgICAgIGlmIChleHQpIGZpbGVFeHRlbnNpb25zLmFkZChleHQpO1xuICAgICAgZmlsZU5hbWVzLnB1c2gocG9pbnQucGF5bG9hZC5maWxlX25hbWUpO1xuICAgIH1cbiAgICBpZiAocG9pbnQucGF5bG9hZD8uaW1hZ2VfdXJsKSB7XG4gICAgICBpbWFnZVVybHMucHVzaChwb2ludC5wYXlsb2FkLmltYWdlX3VybCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4ge1xuICAgIGFydGlzdDogZmlsdGVyPy5uYW1lIHx8IFwidW5rbm93blwiLFxuICAgIHRvdGFsX2ltYWdlczogZmlsdGVyZWRQb2ludHMubGVuZ3RoLFxuICAgIGRpc3BsYXllZF9pbWFnZXM6IGxpbWl0ZWRQb2ludHMubGVuZ3RoLFxuICAgIGZpbGVfdHlwZXM6IEFycmF5LmZyb20oZmlsZUV4dGVuc2lvbnMpLFxuICAgIHNhbXBsZV9maWxlbmFtZXM6IGZpbGVOYW1lcy5zbGljZSgwLCA4KSxcbiAgICBzYW1wbGVfdXJsczogaW1hZ2VVcmxzLnNsaWNlKDAsIDUpLFxuICAgIGltYWdlczogbGltaXRlZFBvaW50cy5tYXAoKHBvaW50OiBhbnkpID0+ICh7XG4gICAgICBpZDogcG9pbnQuaWQsXG4gICAgICBmaWxlbmFtZTogcG9pbnQucGF5bG9hZD8uZmlsZV9uYW1lLFxuICAgICAgaW1hZ2VfdXJsOiBwb2ludC5wYXlsb2FkPy5pbWFnZV91cmwsXG4gICAgICBzdHlsZV91cmw6IHBvaW50LnBheWxvYWQ/LnVybCxcbiAgICB9KSksXG4gIH07XG59XG5cbi8vIE5ldyBmdW5jdGlvbiB0byBhbmFseXplIGFydGlzdCdzIHdvcmsgcGF0dGVybnNcbmFzeW5jIGZ1bmN0aW9uIGFuYWx5emVBcnRpc3RXb3JrKFxuICBjb2xsZWN0aW9uOiBzdHJpbmcsXG4gIGZpbHRlcjogYW55LFxuICBsaW1pdDogbnVtYmVyXG4pOiBQcm9taXNlPGFueT4ge1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNsaWVudC5zY3JvbGwoY29sbGVjdGlvbiwge1xuICAgIGxpbWl0OiAxMDAwLFxuICAgIHdpdGhfcGF5bG9hZDogdHJ1ZSxcbiAgICB3aXRoX3ZlY3RvcjogZmFsc2UsXG4gIH0pO1xuXG4gIGxldCBmaWx0ZXJlZFBvaW50cyA9IHJlc3BvbnNlLnBvaW50cztcbiAgaWYgKGZpbHRlcikge1xuICAgIGZpbHRlcmVkUG9pbnRzID0gcmVzcG9uc2UucG9pbnRzLmZpbHRlcigocG9pbnQ6IGFueSkgPT4ge1xuICAgICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKGZpbHRlcikuZXZlcnkoKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICByZXR1cm4gcG9pbnQucGF5bG9hZD8uW2tleV0gPT09IHZhbHVlO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBBbmFseXplIHBhdHRlcm5zIGluIHRoZSBhcnRpc3QncyB3b3JrXG4gIGNvbnN0IGZpbGVUeXBlcyA9IG5ldyBNYXAoKTtcbiAgY29uc3QgbmFtaW5nUGF0dGVybnMgPSBuZXcgTWFwKCk7XG4gIGNvbnN0IHVybFBhdHRlcm5zID0gbmV3IE1hcCgpO1xuXG4gIGZpbHRlcmVkUG9pbnRzLmZvckVhY2goKHBvaW50OiBhbnkpID0+IHtcbiAgICAvLyBGaWxlIHR5cGUgYW5hbHlzaXNcbiAgICBpZiAocG9pbnQucGF5bG9hZD8uZmlsZV9uYW1lKSB7XG4gICAgICBjb25zdCBleHQgPSBwb2ludC5wYXlsb2FkLmZpbGVfbmFtZS5zcGxpdChcIi5cIikucG9wKCk/LnRvTG93ZXJDYXNlKCk7XG4gICAgICBpZiAoZXh0KSB7XG4gICAgICAgIGZpbGVUeXBlcy5zZXQoZXh0LCAoZmlsZVR5cGVzLmdldChleHQpIHx8IDApICsgMSk7XG4gICAgICB9XG5cbiAgICAgIC8vIE5hbWluZyBwYXR0ZXJuIGFuYWx5c2lzXG4gICAgICBjb25zdCBuYW1lUGF0dGVybiA9IHBvaW50LnBheWxvYWQuZmlsZV9uYW1lXG4gICAgICAgIC5yZXBsYWNlKC9cXGQrL2csIFwiI1wiKVxuICAgICAgICAucmVwbGFjZSgvXFwuKGpwZ3xqcGVnfHBuZ3xnaWZ8d2VicCkkL2ksIFwiXCIpO1xuICAgICAgbmFtaW5nUGF0dGVybnMuc2V0KFxuICAgICAgICBuYW1lUGF0dGVybixcbiAgICAgICAgKG5hbWluZ1BhdHRlcm5zLmdldChuYW1lUGF0dGVybikgfHwgMCkgKyAxXG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIFVSTCBwYXR0ZXJuIGFuYWx5c2lzXG4gICAgaWYgKHBvaW50LnBheWxvYWQ/LnVybCkge1xuICAgICAgY29uc3QgZG9tYWluID0gcG9pbnQucGF5bG9hZC51cmwuc3BsaXQoXCIvXCIpWzJdO1xuICAgICAgaWYgKGRvbWFpbikge1xuICAgICAgICB1cmxQYXR0ZXJucy5zZXQoZG9tYWluLCAodXJsUGF0dGVybnMuZ2V0KGRvbWFpbikgfHwgMCkgKyAxKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgYXJ0aXN0OiBmaWx0ZXI/Lm5hbWUgfHwgXCJ1bmtub3duXCIsXG4gICAgdG90YWxfaW1hZ2VzOiBmaWx0ZXJlZFBvaW50cy5sZW5ndGgsXG4gICAgZmlsZV90eXBlX2Rpc3RyaWJ1dGlvbjogT2JqZWN0LmZyb21FbnRyaWVzKGZpbGVUeXBlcyksXG4gICAgY29tbW9uX25hbWluZ19wYXR0ZXJuczogT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgICAgQXJyYXkuZnJvbShuYW1pbmdQYXR0ZXJucy5lbnRyaWVzKCkpXG4gICAgICAgIC5maWx0ZXIoKFtfLCBjb3VudF0pID0+IGNvdW50ID4gMSlcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IGJbMV0gLSBhWzFdKVxuICAgICAgICAuc2xpY2UoMCwgNSlcbiAgICApLFxuICAgIHNvdXJjZV9kb21haW5zOiBPYmplY3QuZnJvbUVudHJpZXModXJsUGF0dGVybnMpLFxuICAgIHNhbXBsZV9pbWFnZXM6IGZpbHRlcmVkUG9pbnRzLnNsaWNlKDAsIDEwKS5tYXAoKHBvaW50OiBhbnkpID0+ICh7XG4gICAgICBpZDogcG9pbnQuaWQsXG4gICAgICBmaWxlbmFtZTogcG9pbnQucGF5bG9hZD8uZmlsZV9uYW1lLFxuICAgICAgaW1hZ2VfdXJsOiBwb2ludC5wYXlsb2FkPy5pbWFnZV91cmwsXG4gICAgfSkpLFxuICB9O1xufVxuXG4vLyBOZXcgZnVuY3Rpb24gdG8gY291bnQgc3BlY2lmaWMgYXJ0aXN0IGltYWdlcyBhY3Jvc3MgYWxsIGNvbGxlY3Rpb25zXG5hc3luYyBmdW5jdGlvbiBjb3VudEltYWdlc0J5QXJ0aXN0QWNyb3NzRGF0YWJhc2UoZmlsdGVyOiBhbnkpOiBQcm9taXNlPHtcbiAgY291bnQ6IG51bWJlcjtcbiAgYXJ0aXN0OiBzdHJpbmc7XG4gIGJ5X2NvbGxlY3Rpb246IEFycmF5PHsgY29sbGVjdGlvbjogc3RyaW5nOyBjb3VudDogbnVtYmVyIH0+O1xufT4ge1xuICBjb25zdCBjb2xsZWN0aW9uc0RhdGEgPSBhd2FpdCBsaXN0Q29sbGVjdGlvbnMoKTtcbiAgY29uc3QgcmVzdWx0c0J5Q29sbGVjdGlvbjogQXJyYXk8eyBjb2xsZWN0aW9uOiBzdHJpbmc7IGNvdW50OiBudW1iZXIgfT4gPSBbXTtcbiAgbGV0IHRvdGFsQ291bnQgPSAwO1xuXG4gIGZvciAoY29uc3QgY29sbGVjdGlvbiBvZiBjb2xsZWN0aW9uc0RhdGEuY29sbGVjdGlvbnMpIHtcbiAgICB0cnkge1xuICAgICAgaWYgKGNvbGxlY3Rpb24udmVjdG9yc19jb3VudCAmJiBjb2xsZWN0aW9uLnZlY3RvcnNfY291bnQgPiAwKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvdW50SW1hZ2VzQnlBcnRpc3QoY29sbGVjdGlvbi5uYW1lLCBmaWx0ZXIpO1xuICAgICAgICBpZiAocmVzdWx0LmNvdW50ID4gMCkge1xuICAgICAgICAgIHJlc3VsdHNCeUNvbGxlY3Rpb24ucHVzaCh7XG4gICAgICAgICAgICBjb2xsZWN0aW9uOiBjb2xsZWN0aW9uLm5hbWUsXG4gICAgICAgICAgICBjb3VudDogcmVzdWx0LmNvdW50LFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRvdGFsQ291bnQgKz0gcmVzdWx0LmNvdW50O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgYEZhaWxlZCB0byBjb3VudCBpbWFnZXMgaW4gY29sbGVjdGlvbiAke2NvbGxlY3Rpb24ubmFtZX06YCxcbiAgICAgICAgZXJyb3JcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBjb3VudDogdG90YWxDb3VudCxcbiAgICBhcnRpc3Q6IGZpbHRlcj8ubmFtZSB8fCBcInVua25vd25cIixcbiAgICBieV9jb2xsZWN0aW9uOiByZXN1bHRzQnlDb2xsZWN0aW9uLFxuICB9O1xufVxuXG4vLyBOZXcgZnVuY3Rpb24gdG8gc3VtbWFyaXplIGFydGlzdCB3b3JrIGFjcm9zcyBhbGwgY29sbGVjdGlvbnNcbmFzeW5jIGZ1bmN0aW9uIHN1bW1hcml6ZUFydGlzdEFjcm9zc0RhdGFiYXNlKFxuICBmaWx0ZXI6IGFueSxcbiAgbGltaXQ6IG51bWJlclxuKTogUHJvbWlzZTxhbnk+IHtcbiAgY29uc3QgY29sbGVjdGlvbnNEYXRhID0gYXdhaXQgbGlzdENvbGxlY3Rpb25zKCk7XG4gIGNvbnN0IGFsbEltYWdlczogYW55W10gPSBbXTtcbiAgY29uc3QgY29sbGVjdGlvblN1bW1hcmllczogYW55W10gPSBbXTtcbiAgY29uc3QgZmlsZVR5cGVzID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cbiAgZm9yIChjb25zdCBjb2xsZWN0aW9uIG9mIGNvbGxlY3Rpb25zRGF0YS5jb2xsZWN0aW9ucykge1xuICAgIHRyeSB7XG4gICAgICBpZiAoY29sbGVjdGlvbi52ZWN0b3JzX2NvdW50ICYmIGNvbGxlY3Rpb24udmVjdG9yc19jb3VudCA+IDApIHtcbiAgICAgICAgY29uc3Qgc3VtbWFyeSA9IGF3YWl0IHN1bW1hcml6ZUFydGlzdFdvcmsoY29sbGVjdGlvbi5uYW1lLCBmaWx0ZXIsIDUwKTtcbiAgICAgICAgaWYgKHN1bW1hcnkudG90YWxfaW1hZ2VzID4gMCkge1xuICAgICAgICAgIGNvbGxlY3Rpb25TdW1tYXJpZXMucHVzaCh7XG4gICAgICAgICAgICBjb2xsZWN0aW9uOiBjb2xsZWN0aW9uLm5hbWUsXG4gICAgICAgICAgICAuLi5zdW1tYXJ5LFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGFsbEltYWdlcy5wdXNoKC4uLnN1bW1hcnkuaW1hZ2VzKTtcbiAgICAgICAgICBzdW1tYXJ5LmZpbGVfdHlwZXM/LmZvckVhY2goKHR5cGU6IHN0cmluZykgPT4gZmlsZVR5cGVzLmFkZCh0eXBlKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICBgRmFpbGVkIHRvIHN1bW1hcml6ZSBhcnRpc3Qgd29yayBpbiBjb2xsZWN0aW9uICR7Y29sbGVjdGlvbi5uYW1lfTpgLFxuICAgICAgICBlcnJvclxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCB0b3RhbEltYWdlcyA9IGFsbEltYWdlcy5sZW5ndGg7XG4gIGNvbnN0IGRpc3BsYXllZEltYWdlcyA9IGFsbEltYWdlcy5zbGljZSgwLCBsaW1pdCk7XG5cbiAgcmV0dXJuIHtcbiAgICBhcnRpc3Q6IGZpbHRlcj8ubmFtZSB8fCBcInVua25vd25cIixcbiAgICB0b3RhbF9pbWFnZXM6IHRvdGFsSW1hZ2VzLFxuICAgIGRpc3BsYXllZF9pbWFnZXM6IGRpc3BsYXllZEltYWdlcy5sZW5ndGgsXG4gICAgY29sbGVjdGlvbnNfZm91bmQ6IGNvbGxlY3Rpb25TdW1tYXJpZXMubGVuZ3RoLFxuICAgIGZpbGVfdHlwZXM6IEFycmF5LmZyb20oZmlsZVR5cGVzKSxcbiAgICBieV9jb2xsZWN0aW9uOiBjb2xsZWN0aW9uU3VtbWFyaWVzLm1hcCgoc3VtbWFyeSkgPT4gKHtcbiAgICAgIGNvbGxlY3Rpb246IHN1bW1hcnkuY29sbGVjdGlvbixcbiAgICAgIGltYWdlX2NvdW50OiBzdW1tYXJ5LnRvdGFsX2ltYWdlcyxcbiAgICAgIHNhbXBsZV9maWxlbmFtZXM6IHN1bW1hcnkuc2FtcGxlX2ZpbGVuYW1lcz8uc2xpY2UoMCwgMyksXG4gICAgfSkpLFxuICAgIHNhbXBsZV9pbWFnZXM6IGRpc3BsYXllZEltYWdlcy5tYXAoKGltYWdlOiBhbnkpID0+ICh7XG4gICAgICBpZDogaW1hZ2UuaWQsXG4gICAgICBmaWxlbmFtZTogaW1hZ2UuZmlsZW5hbWUsXG4gICAgICBpbWFnZV91cmw6IGltYWdlLmltYWdlX3VybCxcbiAgICAgIGNvbGxlY3Rpb246IGNvbGxlY3Rpb25TdW1tYXJpZXMuZmluZCgoYykgPT5cbiAgICAgICAgYy5pbWFnZXM/LnNvbWUoKGltZzogYW55KSA9PiBpbWcuaWQgPT09IGltYWdlLmlkKVxuICAgICAgKT8uY29sbGVjdGlvbixcbiAgICB9KSksXG4gIH07XG59XG4iXSwibmFtZXMiOlsiT3BlbkFJIiwiR29vZ2xlR2VuZXJhdGl2ZUFJIiwiY2xpZW50Iiwib3BlbmFpIiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIk9QRU5BSV9BUElfS0VZIiwiZ2VuQUkiLCJHRU1JTklfQVBJX0tFWSIsInByb2Nlc3NOYXR1cmFsUXVlcnkiLCJjb2xsZWN0aW9uIiwicXVlc3Rpb24iLCJwcm92aWRlciIsIm1vZGVsIiwiY29udGV4dCIsInN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJlbnJpY2hlZFF1ZXN0aW9uIiwicmVzb2x2ZWRDb2xsZWN0aW9uIiwidXBkYXRlZENvbnRleHQiLCJyZXNvbHZlQ29udGV4dCIsImludGVudCIsInBhcnNlUXVlcnlJbnRlbnQiLCJmaW5hbENvbGxlY3Rpb24iLCJleHRyYWN0ZWRDb2xsZWN0aW9uIiwicmVzdWx0IiwiZXhlY3V0ZVF1ZXJ5IiwiYW5zd2VyIiwiZ2VuZXJhdGVSZXNwb25zZSIsImZpbmFsQ29udGV4dCIsInVwZGF0ZUNvbnZlcnNhdGlvbkNvbnRleHQiLCJleGVjdXRpb25fdGltZV9tcyIsInF1ZXJ5X3R5cGUiLCJ0eXBlIiwiZGF0YSIsImVycm9yIiwiY29uc29sZSIsImZhbGxiYWNrQW5zd2VyIiwiZ2VuZXJhdGVGYWxsYmFja1Jlc3BvbnNlIiwiaW5mZXJJbnRlbnRGcm9tUXVlc3Rpb24iLCJjb3VudCIsImNvbnZlcnNhdGlvbkhpc3RvcnkiLCJjdXJyZW50Q29udGV4dCIsImxvZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJsb3dlcmNhc2VRdWVzdGlvbiIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJsYXN0RW50aXR5IiwicmVwbGFjZSIsImxhc3RDb2xsZWN0aW9uIiwibGFzdFF1ZXJ5VHlwZSIsImxhc3RUYXJnZXQiLCJlbnRpdHlNYXRjaCIsIm1hdGNoIiwibmV3RW50aXR5IiwidHVybiIsImlkIiwidG9TdHJpbmciLCJ0YXJnZXQiLCJmaWx0ZXIiLCJzY29wZSIsInRpbWVzdGFtcCIsInNsaWNlIiwibmFtZSIsImN1cnJlbnRUb3BpYyIsImZhbGxiYWNrSW50ZW50Iiwic3lzdGVtUHJvbXB0IiwibGVuZ3RoIiwicmVjZW50VHVybnMiLCJmb3JFYWNoIiwiaW5kZXgiLCJyZXNwb25zZSIsImdlbWluaU1vZGVsIiwiZ2V0R2VuZXJhdGl2ZU1vZGVsIiwiZ2VuZXJhdGVDb250ZW50IiwidGV4dCIsImNvbXBsZXRpb24iLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtZXNzYWdlcyIsInJvbGUiLCJjb250ZW50IiwidGVtcGVyYXR1cmUiLCJjaG9pY2VzIiwibWVzc2FnZSIsIm9wZW5haUVycm9yIiwid2FybiIsIkVycm9yIiwianNvbk1hdGNoIiwianNvblN0ciIsInBhcnNlIiwiZSIsInEiLCJleHRyYWN0Q29sbGVjdGlvbkZyb21RdWVzdGlvbiIsInByb2Nlc3NlZFF1ZXN0aW9uIiwiZW50aXR5TmFtZSIsInRyaW0iLCJsaW1pdCIsImZhbGxiYWNrRW50aXR5TWF0Y2giLCJwYXR0ZXJucyIsInBhdHRlcm4iLCJtYXRjaGVzIiwibWF0Y2hBbGwiLCJjYW5kaWRhdGUiLCJjb21tb25Db2xsZWN0aW9uTmFtZXMiLCJ1bmRlZmluZWQiLCJleGVjdXRlRGF0YWJhc2VRdWVyeSIsImV4ZWN1dGVDb2xsZWN0aW9uUXVlcnkiLCJjb3VudENvbGxlY3Rpb25zIiwiY291bnRBcnRpc3RzQWNyb3NzRGF0YWJhc2UiLCJjb3VudEltYWdlc0J5QXJ0aXN0QWNyb3NzRGF0YWJhc2UiLCJjb3VudFRvdGFsVmVjdG9yc0Fjcm9zc0RhdGFiYXNlIiwibGlzdENvbGxlY3Rpb25zIiwiZGVzY3JpYmVEYXRhYmFzZUluZm8iLCJzZWFyY2hBY3Jvc3NDb2xsZWN0aW9ucyIsInN1bW1hcml6ZUFydGlzdEFjcm9zc0RhdGFiYXNlIiwibGlzdEFydGlzdHNBY3Jvc3NEYXRhYmFzZSIsImNvdW50VW5pcXVlQXJ0aXN0cyIsImNvdW50SW1hZ2VzQnlBcnRpc3QiLCJjb3VudFRvdGFsIiwic2VhcmNoSW1hZ2VzIiwic3VtbWFyaXplQXJ0aXN0V29yayIsImFuYWx5emVBcnRpc3RXb3JrIiwibGlzdFVuaXF1ZUFydGlzdHMiLCJsaXN0SW1hZ2VzIiwiZmlsdGVySW1hZ2VzIiwiZGVzY3JpYmVDb2xsZWN0aW9uIiwiY29sbGVjdGlvbnNJbmZvIiwiZ2V0Q29sbGVjdGlvbnMiLCJjb2xsZWN0aW9ucyIsIm1hcCIsImMiLCJkZXRhaWxlZENvbGxlY3Rpb25zIiwiUHJvbWlzZSIsImFsbCIsImNvdW50UmVzdWx0IiwidmVjdG9yc19jb3VudCIsImNvbGxlY3Rpb25zRGF0YSIsInRvdGFsVmVjdG9ycyIsInJlZHVjZSIsInN1bSIsImNvbCIsInRvdGFsX2NvbGxlY3Rpb25zIiwidG90YWxfdmVjdG9ycyIsImFsbFJlc3VsdHMiLCJyZXN1bHRzIiwiaW1hZ2VzIiwicHVzaCIsInRvdGFsQ291bnQiLCJ0b3RhbF9jb3VudCIsImNvbGxlY3Rpb25zX3NlYXJjaGVkIiwicmVzdWx0c19ieV9jb2xsZWN0aW9uIiwic2Nyb2xsIiwid2l0aF9wYXlsb2FkIiwid2l0aF92ZWN0b3IiLCJhcnRpc3RzIiwiU2V0IiwicG9pbnRzIiwicG9pbnQiLCJwYXlsb2FkIiwiQm9vbGVhbiIsInNpemUiLCJBcnJheSIsImZyb20iLCJmaWx0ZXJlZFBvaW50cyIsIk9iamVjdCIsImVudHJpZXMiLCJldmVyeSIsImtleSIsInZhbHVlIiwibGltaXRlZFBvaW50cyIsImFydGlzdCIsImZpbGVuYW1lIiwiZmlsZV9uYW1lIiwiYXJ0aXN0c0RhdGEiLCJzYW1wbGVJbWFnZXMiLCJ0b3RhbF9pbWFnZXMiLCJ1bmlxdWVfYXJ0aXN0cyIsInNhbXBsZV9hcnRpc3RzIiwic2FtcGxlX2ltYWdlcyIsImZhbGxiYWNrUmVzcG9uc2UiLCJtYXhfdG9rZW5zIiwic2FmZURhdGEiLCJqb2luIiwiYnlfY29sbGVjdGlvbiIsImNvbGxlY3Rpb25zX2ZvdW5kIiwiZmlsZV90eXBlcyIsImltYWdlX2NvdW50IiwiaW1nIiwic2FtcGxlX2ZpbGVuYW1lcyIsImkiLCJmaWxlX3R5cGVfZGlzdHJpYnV0aW9uIiwiY29tbW9uX25hbWluZ19wYXR0ZXJucyIsImtleXMiLCJzb3VyY2VfZG9tYWlucyIsImFsbEFydGlzdHMiLCJhZGQiLCJieUNvbGxlY3Rpb24iLCJNYXRoIiwibWluIiwidXJsIiwiaW1hZ2VfdXJsIiwiZmlsZUV4dGVuc2lvbnMiLCJmaWxlTmFtZXMiLCJpbWFnZVVybHMiLCJleHQiLCJzcGxpdCIsInBvcCIsImRpc3BsYXllZF9pbWFnZXMiLCJzYW1wbGVfdXJscyIsInN0eWxlX3VybCIsImZpbGVUeXBlcyIsIk1hcCIsIm5hbWluZ1BhdHRlcm5zIiwidXJsUGF0dGVybnMiLCJzZXQiLCJnZXQiLCJuYW1lUGF0dGVybiIsImRvbWFpbiIsImZyb21FbnRyaWVzIiwiXyIsInNvcnQiLCJhIiwiYiIsInJlc3VsdHNCeUNvbGxlY3Rpb24iLCJhbGxJbWFnZXMiLCJjb2xsZWN0aW9uU3VtbWFyaWVzIiwic3VtbWFyeSIsInRvdGFsSW1hZ2VzIiwiZGlzcGxheWVkSW1hZ2VzIiwiaW1hZ2UiLCJmaW5kIiwic29tZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/qdrant/nlp-query.ts\n");

/***/ }),

/***/ "(api)/./lib/types.ts":
/*!**********************!*\
  !*** ./lib/types.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"AVAILABLE_MODELS\": () => (/* binding */ AVAILABLE_MODELS)\n/* harmony export */ });\n// Available models\nconst AVAILABLE_MODELS = {\n    // OpenAI models (using correct model names)\n    \"gpt-4o\": {\n        provider: \"openai\",\n        name: \"GPT-4o\"\n    },\n    \"gpt-4o-mini\": {\n        provider: \"openai\",\n        name: \"GPT-4o Mini\"\n    },\n    \"gpt-4-turbo\": {\n        provider: \"openai\",\n        name: \"GPT-4 Turbo\"\n    },\n    \"gpt-3.5-turbo\": {\n        provider: \"openai\",\n        name: \"GPT-3.5 Turbo\"\n    },\n    // Gemini models (using correct model names)\n    \"gemini-2.0-flash\": {\n        provider: \"gemini\",\n        name: \"Gemini 2.0 Flash\"\n    },\n    \"gemini-1.5-pro\": {\n        provider: \"gemini\",\n        name: \"Gemini 1.5 Pro\"\n    },\n    \"gemini-1.5-flash\": {\n        provider: \"gemini\",\n        name: \"Gemini 1.5 Flash\"\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvdHlwZXMudHMuanMiLCJtYXBwaW5ncyI6Ijs7OztBQWlEQSxtQkFBbUI7QUFDWixNQUFNQSxnQkFBZ0IsR0FBRztJQUM5Qiw0Q0FBNEM7SUFDNUMsUUFBUSxFQUFFO1FBQUVDLFFBQVEsRUFBRSxRQUFRO1FBQUVDLElBQUksRUFBRSxRQUFRO0tBQUU7SUFDaEQsYUFBYSxFQUFFO1FBQUVELFFBQVEsRUFBRSxRQUFRO1FBQUVDLElBQUksRUFBRSxhQUFhO0tBQUU7SUFDMUQsYUFBYSxFQUFFO1FBQUVELFFBQVEsRUFBRSxRQUFRO1FBQUVDLElBQUksRUFBRSxhQUFhO0tBQUU7SUFDMUQsZUFBZSxFQUFFO1FBQUVELFFBQVEsRUFBRSxRQUFRO1FBQUVDLElBQUksRUFBRSxlQUFlO0tBQUU7SUFFOUQsNENBQTRDO0lBQzVDLGtCQUFrQixFQUFFO1FBQUVELFFBQVEsRUFBRSxRQUFRO1FBQUVDLElBQUksRUFBRSxrQkFBa0I7S0FBRTtJQUNwRSxnQkFBZ0IsRUFBRTtRQUFFRCxRQUFRLEVBQUUsUUFBUTtRQUFFQyxJQUFJLEVBQUUsZ0JBQWdCO0tBQUU7SUFDaEUsa0JBQWtCLEVBQUU7UUFBRUQsUUFBUSxFQUFFLFFBQVE7UUFBRUMsSUFBSSxFQUFFLGtCQUFrQjtLQUFFO0NBQ3JFLENBQVUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly95ZWFybi8uL2xpYi90eXBlcy50cz8yYTU1Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBpbnRlcmZhY2UgTmF0dXJhbFF1ZXJ5UmVxdWVzdCB7XG4gIGNvbGxlY3Rpb24/OiBzdHJpbmc7XG4gIHF1ZXN0aW9uOiBzdHJpbmc7XG4gIG1vZGVsPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE5hdHVyYWxRdWVyeVJlc3BvbnNlIHtcbiAgcXVlc3Rpb246IHN0cmluZztcbiAgYW5zd2VyOiBzdHJpbmc7XG4gIHF1ZXJ5X3R5cGU6IHN0cmluZztcbiAgZGF0YT86IGFueTtcbiAgZXhlY3V0aW9uX3RpbWVfbXM6IG51bWJlcjtcbiAgY29udGV4dD86IENvbnZlcnNhdGlvbkNvbnRleHQ7IC8vIEFkZCBjb252ZXJzYXRpb24gY29udGV4dCB0byByZXNwb25zZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbnZlcnNhdGlvbkNvbnRleHQge1xuICBsYXN0RW50aXR5Pzogc3RyaW5nOyAvLyBMYXN0IG1lbnRpb25lZCBlbnRpdHkgKHBlcnNvbiwgY3JlYXRvciwgZXRjLilcbiAgbGFzdENvbGxlY3Rpb24/OiBzdHJpbmc7IC8vIExhc3QgbWVudGlvbmVkIG9yIHVzZWQgY29sbGVjdGlvblxuICBsYXN0UXVlcnlUeXBlPzogc3RyaW5nOyAvLyBMYXN0IHF1ZXJ5IHR5cGUgKHNlYXJjaCwgc3VtbWFyaXplLCBjb3VudCwgZXRjLilcbiAgbGFzdFRhcmdldD86IHN0cmluZzsgLy8gTGFzdCB0YXJnZXQgKGl0ZW1zLCBlbnRpdGllcywgZXRjLilcbiAgY29udmVyc2F0aW9uSGlzdG9yeTogQ29udmVyc2F0aW9uVHVybltdO1xuICBjdXJyZW50VG9waWM/OiBzdHJpbmc7IC8vIEN1cnJlbnQgdG9waWMgYmVpbmcgZGlzY3Vzc2VkXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29udmVyc2F0aW9uVHVybiB7XG4gIGlkOiBzdHJpbmc7XG4gIHF1ZXN0aW9uOiBzdHJpbmc7XG4gIGludGVudDoge1xuICAgIHR5cGU6IHN0cmluZztcbiAgICB0YXJnZXQ6IHN0cmluZztcbiAgICBmaWx0ZXI/OiBhbnk7XG4gICAgc2NvcGU6IHN0cmluZztcbiAgICBleHRyYWN0ZWRDb2xsZWN0aW9uPzogc3RyaW5nO1xuICB9O1xuICByZXN1bHQ6IGFueTtcbiAgdGltZXN0YW1wOiBEYXRlO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENoYXRNZXNzYWdlIHtcbiAgaWQ6IHN0cmluZztcbiAgdHlwZTogXCJ1c2VyXCIgfCBcImFzc2lzdGFudFwiO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogRGF0ZTtcbiAgcXVlcnlUeXBlPzogc3RyaW5nO1xuICBleGVjdXRpb25UaW1lPzogbnVtYmVyO1xuICBkYXRhPzogYW55O1xuICBjb250ZXh0PzogQ29udmVyc2F0aW9uQ29udGV4dDsgLy8gQWRkIGNvbnRleHQgdG8gbWVzc2FnZXNcbn1cblxuLy8gQXZhaWxhYmxlIG1vZGVsc1xuZXhwb3J0IGNvbnN0IEFWQUlMQUJMRV9NT0RFTFMgPSB7XG4gIC8vIE9wZW5BSSBtb2RlbHMgKHVzaW5nIGNvcnJlY3QgbW9kZWwgbmFtZXMpXG4gIFwiZ3B0LTRvXCI6IHsgcHJvdmlkZXI6IFwib3BlbmFpXCIsIG5hbWU6IFwiR1BULTRvXCIgfSxcbiAgXCJncHQtNG8tbWluaVwiOiB7IHByb3ZpZGVyOiBcIm9wZW5haVwiLCBuYW1lOiBcIkdQVC00byBNaW5pXCIgfSxcbiAgXCJncHQtNC10dXJib1wiOiB7IHByb3ZpZGVyOiBcIm9wZW5haVwiLCBuYW1lOiBcIkdQVC00IFR1cmJvXCIgfSxcbiAgXCJncHQtMy41LXR1cmJvXCI6IHsgcHJvdmlkZXI6IFwib3BlbmFpXCIsIG5hbWU6IFwiR1BULTMuNSBUdXJib1wiIH0sXG5cbiAgLy8gR2VtaW5pIG1vZGVscyAodXNpbmcgY29ycmVjdCBtb2RlbCBuYW1lcylcbiAgXCJnZW1pbmktMi4wLWZsYXNoXCI6IHsgcHJvdmlkZXI6IFwiZ2VtaW5pXCIsIG5hbWU6IFwiR2VtaW5pIDIuMCBGbGFzaFwiIH0sXG4gIFwiZ2VtaW5pLTEuNS1wcm9cIjogeyBwcm92aWRlcjogXCJnZW1pbmlcIiwgbmFtZTogXCJHZW1pbmkgMS41IFByb1wiIH0sXG4gIFwiZ2VtaW5pLTEuNS1mbGFzaFwiOiB7IHByb3ZpZGVyOiBcImdlbWluaVwiLCBuYW1lOiBcIkdlbWluaSAxLjUgRmxhc2hcIiB9LFxufSBhcyBjb25zdDtcblxuZXhwb3J0IHR5cGUgTW9kZWxLZXkgPSBrZXlvZiB0eXBlb2YgQVZBSUxBQkxFX01PREVMUztcbmV4cG9ydCB0eXBlIEVtYmVkZGluZ1Byb3ZpZGVyID0gXCJvcGVuYWlcIiB8IFwiZ2VtaW5pXCI7XG4iXSwibmFtZXMiOlsiQVZBSUxBQkxFX01PREVMUyIsInByb3ZpZGVyIiwibmFtZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/types.ts\n");

/***/ }),

/***/ "(api)/./pages/api/ask.ts":
/*!**************************!*\
  !*** ./pages/api/ask.ts ***!
  \**************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_qdrant_nlp_query__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/qdrant/nlp-query */ \"(api)/./lib/qdrant/nlp-query.ts\");\n/* harmony import */ var _lib_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../lib/types */ \"(api)/./lib/types.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_qdrant_nlp_query__WEBPACK_IMPORTED_MODULE_0__]);\n_lib_qdrant_nlp_query__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\nasync function handler(req, res) {\n    // Enable CORS\n    res.setHeader(\"Access-Control-Allow-Origin\", \"*\");\n    res.setHeader(\"Access-Control-Allow-Methods\", \"GET, POST, OPTIONS\");\n    res.setHeader(\"Access-Control-Allow-Headers\", \"Content-Type\");\n    if (req.method === \"OPTIONS\") {\n        res.status(200).end();\n        return;\n    }\n    if (req.method !== \"POST\") {\n        res.setHeader(\"Allow\", [\n            \"POST\"\n        ]);\n        res.status(405).json({\n            error: `Method ${req.method} Not Allowed`\n        });\n        return;\n    }\n    try {\n        const { question , collection , provider =\"openai\" , model , context  } = req.body;\n        if (!question) {\n            res.status(400).json({\n                error: \"Missing required field: question\"\n            });\n            return;\n        }\n        // Determine provider from model, default to gemini-2.0-flash\n        const selectedModel = model || \"gemini-2.0-flash\";\n        const modelInfo = _lib_types__WEBPACK_IMPORTED_MODULE_1__.AVAILABLE_MODELS[selectedModel];\n        const providerInfo = modelInfo?.provider || \"gemini\";\n        console.log(`Processing natural language query: \"${question}\" for collection: ${collection || \"database-level\"} using model: ${selectedModel}`);\n        const result = await (0,_lib_qdrant_nlp_query__WEBPACK_IMPORTED_MODULE_0__.processNaturalQuery)(collection || null, question, providerInfo, selectedModel, context // Pass context to processing function\n        );\n        // Transform the result to match NaturalQueryResponse interface\n        const response = {\n            question,\n            answer: result.answer,\n            query_type: result.query_type,\n            data: result.data,\n            execution_time_ms: result.execution_time_ms,\n            context: result.context\n        };\n        res.status(200).json(response);\n    } catch (error) {\n        console.error(\"Error processing natural language query:\", error);\n        res.status(500).json({\n            error: error instanceof Error ? error.message : \"Internal server error\"\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixLQUFLLEdBQUdsQixLQUFLLENBQUNtQixPQUFPLEdBQUcsdUJBQXVCO1NBQ3hFLENBQUMsQ0FBQztJQUNMLENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8veWVhcm4vLi9wYWdlcy9hcGkvYXNrLnRzPzY2NDMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSBcIm5leHRcIjtcbmltcG9ydCB7IHByb2Nlc3NOYXR1cmFsUXVlcnkgfSBmcm9tIFwiLi4vLi4vbGliL3FkcmFudC9ubHAtcXVlcnlcIjtcbmltcG9ydCB7XG4gIE5hdHVyYWxRdWVyeVJlcXVlc3QsXG4gIE5hdHVyYWxRdWVyeVJlc3BvbnNlLFxuICBBVkFJTEFCTEVfTU9ERUxTLFxuICBDb252ZXJzYXRpb25Db250ZXh0LFxufSBmcm9tIFwiLi4vLi4vbGliL3R5cGVzXCI7XG5pbXBvcnQgeyBFbWJlZGRpbmdQcm92aWRlciB9IGZyb20gXCIuLi8uLi9saWIvc2NoZW1hc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKFxuICByZXE6IE5leHRBcGlSZXF1ZXN0LFxuICByZXM6IE5leHRBcGlSZXNwb25zZTxOYXR1cmFsUXVlcnlSZXNwb25zZSB8IHsgZXJyb3I6IHN0cmluZyB9PlxuKSB7XG4gIC8vIEVuYWJsZSBDT1JTXG4gIHJlcy5zZXRIZWFkZXIoXCJBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW5cIiwgXCIqXCIpO1xuICByZXMuc2V0SGVhZGVyKFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctTWV0aG9kc1wiLCBcIkdFVCwgUE9TVCwgT1BUSU9OU1wiKTtcbiAgcmVzLnNldEhlYWRlcihcIkFjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnNcIiwgXCJDb250ZW50LVR5cGVcIik7XG5cbiAgaWYgKHJlcS5tZXRob2QgPT09IFwiT1BUSU9OU1wiKSB7XG4gICAgcmVzLnN0YXR1cygyMDApLmVuZCgpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChyZXEubWV0aG9kICE9PSBcIlBPU1RcIikge1xuICAgIHJlcy5zZXRIZWFkZXIoXCJBbGxvd1wiLCBbXCJQT1NUXCJdKTtcbiAgICByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiBgTWV0aG9kICR7cmVxLm1ldGhvZH0gTm90IEFsbG93ZWRgIH0pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3Qge1xuICAgICAgcXVlc3Rpb24sXG4gICAgICBjb2xsZWN0aW9uLFxuICAgICAgcHJvdmlkZXIgPSBcIm9wZW5haVwiLFxuICAgICAgbW9kZWwsXG4gICAgICBjb250ZXh0LCAvLyBBZGQgY29udmVyc2F0aW9uIGNvbnRleHQgcGFyYW1ldGVyXG4gICAgfToge1xuICAgICAgcXVlc3Rpb246IHN0cmluZztcbiAgICAgIGNvbGxlY3Rpb24/OiBzdHJpbmc7XG4gICAgICBwcm92aWRlcj86IEVtYmVkZGluZ1Byb3ZpZGVyO1xuICAgICAgbW9kZWw/OiBzdHJpbmc7XG4gICAgICBjb250ZXh0PzogQ29udmVyc2F0aW9uQ29udGV4dDsgLy8gQWRkIGNvbnRleHQgdHlwZVxuICAgIH0gPSByZXEuYm9keSBhcyBOYXR1cmFsUXVlcnlSZXF1ZXN0O1xuXG4gICAgaWYgKCFxdWVzdGlvbikge1xuICAgICAgcmVzLnN0YXR1cyg0MDApLmpzb24oe1xuICAgICAgICBlcnJvcjogXCJNaXNzaW5nIHJlcXVpcmVkIGZpZWxkOiBxdWVzdGlvblwiLFxuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gRGV0ZXJtaW5lIHByb3ZpZGVyIGZyb20gbW9kZWwsIGRlZmF1bHQgdG8gZ2VtaW5pLTIuMC1mbGFzaFxuICAgIGNvbnN0IHNlbGVjdGVkTW9kZWwgPSBtb2RlbCB8fCBcImdlbWluaS0yLjAtZmxhc2hcIjtcbiAgICBjb25zdCBtb2RlbEluZm8gPVxuICAgICAgQVZBSUxBQkxFX01PREVMU1tzZWxlY3RlZE1vZGVsIGFzIGtleW9mIHR5cGVvZiBBVkFJTEFCTEVfTU9ERUxTXTtcbiAgICBjb25zdCBwcm92aWRlckluZm8gPSBtb2RlbEluZm8/LnByb3ZpZGVyIHx8IFwiZ2VtaW5pXCI7XG5cbiAgICBjb25zb2xlLmxvZyhcbiAgICAgIGBQcm9jZXNzaW5nIG5hdHVyYWwgbGFuZ3VhZ2UgcXVlcnk6IFwiJHtxdWVzdGlvbn1cIiBmb3IgY29sbGVjdGlvbjogJHtcbiAgICAgICAgY29sbGVjdGlvbiB8fCBcImRhdGFiYXNlLWxldmVsXCJcbiAgICAgIH0gdXNpbmcgbW9kZWw6ICR7c2VsZWN0ZWRNb2RlbH1gXG4gICAgKTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHByb2Nlc3NOYXR1cmFsUXVlcnkoXG4gICAgICBjb2xsZWN0aW9uIHx8IG51bGwsXG4gICAgICBxdWVzdGlvbixcbiAgICAgIHByb3ZpZGVySW5mbyxcbiAgICAgIHNlbGVjdGVkTW9kZWwsXG4gICAgICBjb250ZXh0IC8vIFBhc3MgY29udGV4dCB0byBwcm9jZXNzaW5nIGZ1bmN0aW9uXG4gICAgKTtcblxuICAgIC8vIFRyYW5zZm9ybSB0aGUgcmVzdWx0IHRvIG1hdGNoIE5hdHVyYWxRdWVyeVJlc3BvbnNlIGludGVyZmFjZVxuICAgIGNvbnN0IHJlc3BvbnNlOiBOYXR1cmFsUXVlcnlSZXNwb25zZSA9IHtcbiAgICAgIHF1ZXN0aW9uLFxuICAgICAgYW5zd2VyOiByZXN1bHQuYW5zd2VyLFxuICAgICAgcXVlcnlfdHlwZTogcmVzdWx0LnF1ZXJ5X3R5cGUsXG4gICAgICBkYXRhOiByZXN1bHQuZGF0YSxcbiAgICAgIGV4ZWN1dGlvbl90aW1lX21zOiByZXN1bHQuZXhlY3V0aW9uX3RpbWVfbXMsXG4gICAgICBjb250ZXh0OiByZXN1bHQuY29udGV4dCwgLy8gUmV0dXJuIHVwZGF0ZWQgY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICB9O1xuXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24ocmVzcG9uc2UpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBwcm9jZXNzaW5nIG5hdHVyYWwgbGFuZ3VhZ2UgcXVlcnk6XCIsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIkludGVybmFsIHNlcnZlciBlcnJvclwiLFxuICAgIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsicHJvY2Vzc05hdHVyYWxRdWVyeSIsIkFWQUlMQUJMRV9NT0RFTFMiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwic2V0SGVhZGVyIiwibWV0aG9kIiwic3RhdHVzIiwiZW5kIiwianNvbiIsImVycm9yIiwicXVlc3Rpb24iLCJjb2xsZWN0aW9uIiwicHJvdmlkZXIiLCJtb2RlbCIsImNvbnRleHQiLCJib2R5Iiwic2VsZWN0ZWRNb2RlbCIsIm1vZGVsSW5mbyIsInByb3ZpZGVySW5mbyIsImNvbnNvbGUiLCJsb2ciLCJyZXN1bHQiLCJyZXNwb25zZSIsImFuc3dlciIsInF1ZXJ5X3R5cGUiLCJkYXRhIiwiZXhlY3V0aW9uX3RpbWVfbXMiLCJFcnJvciIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/ask.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/ask.ts"));
module.exports = __webpack_exports__;

})();